(function(){/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
'use strict';var g,ba="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};function ca(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("a");}var da=ca(this);
function ea(a,b){if(b)a:{var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ba(c,a,{configurable:!0,writable:!0,value:b})}}function fa(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,e){function f(h){h.done?d(h.value):Promise.resolve(h.value).then(b,c).then(f,e)}f(a.next())})}
ea("Promise.prototype.finally",function(a){return a?a:function(b){return this.then(function(c){return Promise.resolve(b()).then(function(){return c})},function(c){return Promise.resolve(b()).then(function(){throw c;})})}});ea("Array.prototype.includes",function(a){return a?a:function(b,c){var d=this;d instanceof String&&(d=String(d));var e=d.length;c=c||0;for(0>c&&(c=Math.max(c+e,0));c<e;c++){var f=d[c];if(f===b||Object.is(f,b))return!0}return!1}});
function ha(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e}ea("Array.prototype.values",function(a){return a?a:function(){return ha(this,function(b,c){return c})}});var ia=ia||{},l=this||self;function ja(){}function ka(a){a.Zb=void 0;a.$=function(){return a.Zb?a.Zb:a.Zb=new a}}
function la(a){var b=typeof a;return"object"!=b?b:a?Array.isArray(a)?"array":b:"null"}function ma(a){var b=la(a);return"array"==b||"object"==b&&"number"==typeof a.length}function na(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function oa(a,b,c){return a.call.apply(a.bind,arguments)}
function pa(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function qa(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?qa=oa:qa=pa;return qa.apply(null,arguments)}
function ra(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}}function sa(a,b){a=a.split(".");var c=l;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b}
function ta(a,b){function c(){}c.prototype=b.prototype;a.hb=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Nc=function(d,e,f){for(var h=Array(arguments.length-2),k=2;k<arguments.length;k++)h[k-2]=arguments[k];return b.prototype[e].apply(d,h)}}function ua(a){return a};function m(a,b){var c=void 0;return new (c||(c=Promise))(function(d,e){function f(q){try{k(b.next(q))}catch(n){e(n)}}function h(q){try{k(b["throw"](q))}catch(n){e(n)}}function k(q){q.done?d(q.value):(new c(function(n){n(q.value)})).then(f,h)}k((b=b.apply(a,void 0)).next())})};var va=class{u(){return!0}};var wa=class extends va{constructor(){super();this.O=this.o=this.i=1}g(a,b){return Math.sqrt((this.i-a)*(this.i-a)+(this.o-b)*(this.o-b))<=this.O}};var xa=class extends va{g(){return!1}};var ya;function p(a,b,c){return a+c*(b-a)};function za(a,b){this.x=void 0!==a?a:0;this.y=void 0!==b?b:0}za.prototype.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};za.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};za.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};za.prototype.scale=function(a,b){this.x*=a;this.y*="number"===typeof b?b:a;return this};const Aa=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"===typeof a)return"string"!==typeof b||1!=b.length?-1:a.indexOf(b,0);for(let c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ba=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){const d=a.length,e="string"===typeof a?a.split(""):a;for(let f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};
function Ca(a){a:{var b=Da;const c=a.length,d="string"===typeof a?a.split(""):a;for(let e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:"string"===typeof a?a.charAt(b):a[b]}function Ea(a,b){b=Aa(a,b);let c;(c=0<=b)&&Array.prototype.splice.call(a,b,1);return c}function Fa(a){return Array.prototype.concat.apply([],arguments)};function Ga(a,b,c){for(const d in a)b.call(c,a[d],d,a)}const Ha="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ia(a,b){let c,d;for(let e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(let f=0;f<Ha.length;f++)c=Ha[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Ja;function Ka(){if(void 0===Ja){var a=null,b=l.trustedTypes;if(b&&b.createPolicy){try{a=b.createPolicy("goog#html",{createHTML:ua,createScript:ua,createScriptURL:ua})}catch(c){l.console&&l.console.error(c.message)}Ja=a}else Ja=a}return Ja};function La(a,b){this.g=a===Ma&&b||"";this.i=Na}La.prototype.$a=!0;La.prototype.Za=function(){return this.g};var Na={},Ma={};const Oa={};class Pa{constructor(a,b){this.g=b===Oa?a:"";this.$a=!0}Za(){return this.g.toString()}}Pa.prototype.toString=function(){return this.g.toString()};var Qa=/[A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02b8\u0300-\u0590\u0900-\u1fff\u200e\u2c00-\ud801\ud804-\ud839\ud83c-\udbff\uf900-\ufb1c\ufe00-\ufe6f\ufefd-\uffff]/,Ra=/^[^A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02b8\u0300-\u0590\u0900-\u1fff\u200e\u2c00-\ud801\ud804-\ud839\ud83c-\udbff\uf900-\ufb1c\ufe00-\ufe6f\ufefd-\uffff]*[\u0591-\u06ef\u06fa-\u08ff\u200f\ud802-\ud803\ud83a-\ud83b\ufb1d-\ufdff\ufe70-\ufefc]/,Sa=/^http:\/\/.*/,Ta=/\s+/,Ua=/[\d\u06f0-\u06f9]/;var Wa=class{constructor(a,b){this.g=b===Va?a:""}};g=Wa.prototype;g.$a=!0;g.Za=function(){return this.g.toString()};g.Yb=!0;g.ob=function(){return 1};g.toString=function(){return this.g+""};var Va={};var Xa=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]},Ya=/&/g,Za=/</g,$a=/>/g,ab=/"/g,bb=/'/g,cb=/\x00/g,db=/[\x00&<>"']/;function t(a,b){return-1!=a.indexOf(b)}function eb(a,b){return a<b?-1:a>b?1:0};var gb=class{constructor(a,b){this.g=b===fb?a:""}};g=gb.prototype;g.$a=!0;g.Za=function(){return this.g.toString()};g.Yb=!0;g.ob=function(){return 1};g.toString=function(){return this.g.toString()};function hb(a){if(a instanceof gb&&a.constructor===gb)return a.g;la(a);return"type_error:SafeUrl"}var ib=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i,fb={};var u;a:{var jb=l.navigator;if(jb){var kb=jb.userAgent;if(kb){u=kb;break a}}u=""};var mb=class{constructor(a,b,c){this.g=c===lb?a:"";this.i=b}};g=mb.prototype;g.Yb=!0;g.ob=function(){return this.i};g.$a=!0;g.Za=function(){return this.g.toString()};g.toString=function(){return this.g.toString()};function nb(a){if(a instanceof mb&&a.constructor===mb)return a.g;la(a);return"type_error:SafeHtml"}
function ob(a){if(a instanceof mb)return a;var b="object"==typeof a,c=null;b&&a.Yb&&(c=a.ob());a=b&&a.$a?a.Za():String(a);db.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(Ya,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(Za,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace($a,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(ab,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(bb,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(cb,"&#0;")));return pb(a,c)}
function qb(a){function b(f){Array.isArray(f)?Ba(f,b):(f=ob(f),e.push(nb(f).toString()),f=f.ob(),0==d?d=f:0!=f&&d!=f&&(d=null))}var c=ob(rb),d=c.ob(),e=[];Ba(a,b);return pb(e.join(nb(c).toString()),d)}function sb(a){return qb(Array.prototype.slice.call(arguments))}var lb={};function pb(a,b){const c=Ka();a=c?c.createHTML(a):a;return new mb(a,b,lb)}var rb=new mb(l.trustedTypes&&l.trustedTypes.emptyHTML||"",0,lb),tb=pb("<br>",0);var ub=function(a){let b=!1,c;return function(){b||(c=a(),b=!0);return c}}(function(){var a=document.createElement("div"),b=document.createElement("div");b.appendChild(document.createElement("div"));a.appendChild(b);b=a.firstChild.firstChild;a.innerHTML=nb(rb);return!b.parentElement});function vb(a,b){if(ub())for(;a.lastChild;)a.removeChild(a.lastChild);a.innerHTML=nb(b)}
function wb(a){a instanceof gb||a instanceof gb||(a="object"==typeof a&&a.$a?a.Za():String(a),ib.test(a)||(a="about:invalid#zClosurez"),a=new gb(a,fb));l.open(hb(a),"")};class xb{constructor(a,b){this.g=a[l.Symbol.iterator]();this.i=b;this.o=0}[Symbol.iterator](){return this}next(){const a=this.g.next();return{value:a.done?void 0:this.i.call(void 0,a.value,this.o++),done:a.done}}}function yb(a,b){return new xb(a,b)};var zb="StopIteration"in l?l.StopIteration:{message:"StopIteration",stack:""};function Ab(){}Ab.prototype.next=function(){throw zb;};Ab.prototype.Ya=function(){return this};function Bb(a){if(a instanceof Cb||a instanceof Db||a instanceof Eb)return a;if("function"==typeof a.next)return new Cb(()=>Fb(a));if("function"==typeof a[Symbol.iterator])return new Cb(()=>a[Symbol.iterator]());if("function"==typeof a.Ya)return new Cb(()=>Fb(a.Ya()));throw Error("b");}const Fb=a=>{if(!(a instanceof Ab))return a;let b=!1;return{next(){let c;for(;!b;)try{c=a.next();break}catch(d){if(d!==zb)throw d;b=!0}return{value:c,done:b}}}};
class Cb{constructor(a){this.g=a}Ya(){return new Db(this.g())}[Symbol.iterator](){return new Eb(this.g())}i(){return new Eb(this.g())}}class Db extends Ab{constructor(a){super();this.g=a}next(){const a=this.g.next();if(a.done)throw zb;return a.value}[Symbol.iterator](){return new Eb(this.g)}i(){return new Eb(this.g)}}class Eb extends Cb{constructor(a){super(()=>a);this.o=a}next(){return this.o.next()}};function Gb(a,b){this.i={};this.g=[];this.o=this.size=0;var c=arguments.length;if(1<c){if(c%2)throw Error("c");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a)if(a instanceof Gb)for(c=a.Qa(),d=0;d<c.length;d++)this.set(c[d],a.get(c[d]));else for(d in a)this.set(d,a[d])}g=Gb.prototype;g.Pa=function(){Hb(this);for(var a=[],b=0;b<this.g.length;b++)a.push(this.i[this.g[b]]);return a};g.Qa=function(){Hb(this);return this.g.concat()};g.has=function(a){return Ib(this.i,a)};
g.clear=function(){this.i={};this.o=this.size=this.g.length=0};g.remove=function(a){Ib(this.i,a)?(delete this.i[a],--this.size,this.o++,this.g.length>2*this.size&&Hb(this),a=!0):a=!1;return a};function Hb(a){if(a.size!=a.g.length){for(var b=0,c=0;b<a.g.length;){var d=a.g[b];Ib(a.i,d)&&(a.g[c++]=d);b++}a.g.length=c}if(a.size!=a.g.length){var e={};for(c=b=0;b<a.g.length;)d=a.g[b],Ib(e,d)||(a.g[c++]=d,e[d]=1),b++;a.g.length=c}}g.get=function(a,b){return Ib(this.i,a)?this.i[a]:b};
g.set=function(a,b){Ib(this.i,a)||(this.size+=1,this.g.push(a),this.o++);this.i[a]=b};g.forEach=function(a,b){for(var c=this.Qa(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};g.transpose=function(){for(var a=new Gb,b=0;b<this.g.length;b++){var c=this.g[b];a.set(this.i[c],c)}return a};g.keys=function(){return Bb(this.Ya(!0)).i()};g.values=function(){return Bb(this.Ya(!1)).i()};g.entries=function(){const a=this;return yb(this.keys(),function(b){return[b,a.get(b)]})};
g.Ya=function(a){Hb(this);var b=0,c=this.o,d=this,e=new Ab;e.next=function(){if(c!=d.o)throw Error("d");if(b>=d.g.length)throw zb;var f=d.g[b++];return a?f:d.i[f]};return e};function Ib(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Jb(a){if(a.Pa&&"function"==typeof a.Pa)return a.Pa();if("string"===typeof a)return a.split("");if(ma(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}b=[];c=0;for(d in a)b[c++]=a[d];return b}
function Kb(a,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,void 0);else if(ma(a)||"string"===typeof a)Ba(a,b,void 0);else{if(a.Qa&&"function"==typeof a.Qa)var c=a.Qa();else if(a.Pa&&"function"==typeof a.Pa)c=void 0;else if(ma(a)||"string"===typeof a){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else for(e in c=[],d=0,a)c[d++]=e;d=Jb(a);e=d.length;for(var f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}};var Lb=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Mb(a,b){if(a){a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].indexOf("="),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}};function Nb(a){this.O=this.V=this.u="";this.U=null;this.s=this.o="";this.i=!1;if(a instanceof Nb){this.i=a.i;Ob(this,a.u);this.V=a.V;this.O=a.O;Pb(this,a.U);this.o=a.o;var b=a.g;var c=new Qb;c.o=b.o;b.g&&(c.g=new Gb(b.g),c.i=b.i);Rb(this,c);this.s=a.s}else a&&(b=String(a).match(Lb))?(this.i=!1,Ob(this,b[1]||"",!0),this.V=Sb(b[2]||""),this.O=Sb(b[3]||"",!0),Pb(this,b[4]),this.o=Sb(b[5]||"",!0),Rb(this,b[6]||"",!0),this.s=Sb(b[7]||"")):(this.i=!1,this.g=new Qb(null,this.i))}
Nb.prototype.toString=function(){var a=[],b=this.u;b&&a.push(Tb(b,Ub,!0),":");var c=this.O;if(c||"file"==b)a.push("//"),(b=this.V)&&a.push(Tb(b,Ub,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.U,null!=c&&a.push(":",String(c));if(c=this.o)this.O&&"/"!=c.charAt(0)&&a.push("/"),a.push(Tb(c,"/"==c.charAt(0)?Vb:Wb,!0));(c=this.g.toString())&&a.push("?",c);(c=this.s)&&a.push("#",Tb(c,Xb));return a.join("")};
function Ob(a,b,c){a.u=c?Sb(b,!0):b;a.u&&(a.u=a.u.replace(/:$/,""))}function Pb(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("e`"+b);a.U=b}else a.U=null}function Rb(a,b,c){b instanceof Qb?(a.g=b,Yb(a.g,a.i)):(c||(b=Tb(b,Zb)),a.g=new Qb(b,a.i))}function Sb(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Tb(a,b,c){return"string"===typeof a?(a=encodeURI(a).replace(b,$b),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}
function $b(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Ub=/[#\/\?@]/g,Wb=/[#\?:]/g,Vb=/[#\?]/g,Zb=/[#\?@]/g,Xb=/#/g;function Qb(a,b){this.i=this.g=null;this.o=a||null;this.u=!!b}function ac(a){a.g||(a.g=new Gb,a.i=0,a.o&&Mb(a.o,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)}))}g=Qb.prototype;g.add=function(a,b){ac(this);this.o=null;a=bc(this,a);var c=this.g.get(a);c||this.g.set(a,c=[]);c.push(b);this.i+=1;return this};
g.remove=function(a){ac(this);a=bc(this,a);return this.g.has(a)?(this.o=null,this.i-=this.g.get(a).length,this.g.remove(a)):!1};g.clear=function(){this.g=this.o=null;this.i=0};function cc(a,b){ac(a);b=bc(a,b);return a.g.has(b)}g.forEach=function(a,b){ac(this);this.g.forEach(function(c,d){Ba(c,function(e){a.call(b,e,d,this)},this)},this)};g.Qa=function(){ac(this);for(var a=this.g.Pa(),b=this.g.Qa(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};
g.Pa=function(a){ac(this);var b=[];if("string"===typeof a)cc(this,a)&&(b=Fa(b,this.g.get(bc(this,a))));else{a=this.g.Pa();for(var c=0;c<a.length;c++)b=Fa(b,a[c])}return b};g.set=function(a,b){ac(this);this.o=null;a=bc(this,a);cc(this,a)&&(this.i-=this.g.get(a).length);this.g.set(a,[b]);this.i+=1;return this};g.get=function(a,b){if(!a)return b;a=this.Pa(a);return 0<a.length?String(a[0]):b};
g.toString=function(){if(this.o)return this.o;if(!this.g)return"";for(var a=[],b=this.g.Qa(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.Pa(d);for(var f=0;f<d.length;f++){var h=e;""!==d[f]&&(h+="="+encodeURIComponent(String(d[f])));a.push(h)}}return this.o=a.join("&")};function bc(a,b){b=String(b);a.u&&(b=b.toLowerCase());return b}
function Yb(a,b){b&&!a.u&&(ac(a),a.o=null,a.g.forEach(function(c,d){var e=d.toLowerCase();if(d!=e&&(this.remove(d),this.remove(e),0<c.length)){this.o=null;d=this.g;var f=d.set;e=bc(this,e);var h=c.length;if(0<h){const k=Array(h);for(let q=0;q<h;q++)k[q]=c[q];h=k}else h=[];f.call(d,e,h);this.i+=c.length}},a));a.u=b};function dc(a){const b=new XMLHttpRequest;b.open("GET",a);return new Promise((c,d)=>{b.send();b.onreadystatechange=()=>{if(4==b.readyState)if(200==b.status&&b.responseText)a:{var e=b.responseText;e.startsWith(")]}'\n")&&(e=e.substring(5));let f={};try{f=JSON.parse(e)}catch(h){d(e);break a}f.hasOwnProperty("ddllog")&&(f=f.ddllog);f.hasOwnProperty("__err__")?d(f.__err__):c(f)}else d(b)}})}
function ec(a,b,c=()=>{},d=!1){d=d?"//www.google.com":"";d=new Nb("ddllog".startsWith("/")?`${d}${"ddllog"}`:`${d}/async/${"ddllog"}`);Rb(d,b);d=d.toString();a.g++;c(a.g);return dc(d).catch(e=>1>a.g?a.i(2E3*Math.pow(2,a.g-1)).then(()=>ec(a,b,c)):Promise.reject(e)).finally(()=>a.g=0)}class fc{constructor(a){this.g=0;this.i=a}};class gc extends fc{constructor(){super(a=>new Promise(b=>setTimeout(b,a)))}};function hc(a){if(!a.i){a.i=!0;for(const b of a.o)b()}}class ic{constructor(a){this.g=a;this.i=!1;this.o=[]}u(){}};function jc(a){jc[" "](a);return a}jc[" "]=ja;function kc(a){var b=lc;return Object.prototype.hasOwnProperty.call(b,9)?b[9]:b[9]=a(9)};var mc=t(u,"Opera"),nc=t(u,"Trident")||t(u,"MSIE"),oc=t(u,"Edge"),pc=t(u,"Gecko")&&!(t(u.toLowerCase(),"webkit")&&!t(u,"Edge"))&&!(t(u,"Trident")||t(u,"MSIE"))&&!t(u,"Edge"),qc=t(u.toLowerCase(),"webkit")&&!t(u,"Edge"),rc;
a:{var sc="",tc=function(){var a=u;if(pc)return/rv:([^\);]+)(\)|;)/.exec(a);if(oc)return/Edge\/([\d\.]+)/.exec(a);if(nc)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(qc)return/WebKit\/(\S+)/.exec(a);if(mc)return/(?:Version)[ \/]?(\S+)/.exec(a)}();tc&&(sc=tc?tc[1]:"");if(nc){var uc,vc=l.document;uc=vc?vc.documentMode:void 0;if(null!=uc&&uc>parseFloat(sc)){rc=String(uc);break a}}rc=sc}var wc=rc,lc={};
function xc(){return kc(function(){let a=0;const b=Xa(String(wc)).split("."),c=Xa("9").split("."),d=Math.max(b.length,c.length);for(let h=0;0==a&&h<d;h++){var e=b[h]||"",f=c[h]||"";do{e=/(\d*)(\D*)(.*)/.exec(e)||["","","",""];f=/(\d*)(\D*)(.*)/.exec(f)||["","","",""];if(0==e[0].length&&0==f[0].length)break;a=eb(0==e[1].length?0:parseInt(e[1],10),0==f[1].length?0:parseInt(f[1],10))||eb(0==e[2].length,0==f[2].length)||eb(e[2],f[2]);e=e[3];f=f[3]}while(0==a)}return 0<=a})};var yc=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{l.addEventListener("test",ja,b),l.removeEventListener("test",ja,b)}catch(c){}return a}();function zc(a){a&&"function"==typeof a.dispose&&a.dispose()};function v(){this.s=this.s;this.O=this.O}v.prototype.s=!1;v.prototype.dispose=function(){this.s||(this.s=!0,this.Ea())};function Ac(a,b){a.s?b():(a.O||(a.O=[]),a.O.push(b))}v.prototype.Ea=function(){if(this.O)for(;this.O.length;)this.O.shift()()};function Bc(a,b){this.type=a;this.i=this.target=b;this.defaultPrevented=this.o=!1}Bc.prototype.stopPropagation=function(){this.o=!0};Bc.prototype.preventDefault=function(){this.defaultPrevented=!0};var Cc;Cc=qc?"webkitAnimationEnd":mc?"oanimationend":"animationend";function Dc(a,b){Bc.call(this,a?a.type:"");this.relatedTarget=this.i=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.keyCode=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType="";this.g=null;if(a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.i=b;if(b=a.relatedTarget){if(pc){a:{try{jc(b.nodeName);var e=!0;
break a}catch(f){}e=!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.keyCode=a.keyCode||0;this.key=a.key||"";this.ctrlKey=
a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType="string"===typeof a.pointerType?a.pointerType:Ec[a.pointerType]||"";this.state=a.state;this.g=a;a.defaultPrevented&&Dc.hb.preventDefault.call(this)}}ta(Dc,Bc);var Ec={2:"touch",3:"pen",4:"mouse"};Dc.prototype.stopPropagation=function(){Dc.hb.stopPropagation.call(this);this.g.stopPropagation?this.g.stopPropagation():this.g.cancelBubble=!0};
Dc.prototype.preventDefault=function(){Dc.hb.preventDefault.call(this);var a=this.g;a.preventDefault?a.preventDefault():a.returnValue=!1};var Fc="closure_listenable_"+(1E6*Math.random()|0);var Gc=0;function Hc(a,b,c,d,e){this.listener=a;this.g=null;this.src=b;this.type=c;this.capture=!!d;this.Mb=e;this.key=++Gc;this.Ab=this.Kb=!1}function Ic(a){a.Ab=!0;a.listener=null;a.g=null;a.src=null;a.Mb=null};function Jc(a){this.src=a;this.g={};this.i=0}Jc.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.g[f];a||(a=this.g[f]=[],this.i++);var h=Kc(a,b,d,e);-1<h?(b=a[h],c||(b.Kb=!1)):(b=new Hc(b,this.src,f,!!d,e),b.Kb=c,a.push(b));return b};Jc.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.g))return!1;var e=this.g[a];b=Kc(e,b,c,d);return-1<b?(Ic(e[b]),Array.prototype.splice.call(e,b,1),0==e.length&&(delete this.g[a],this.i--),!0):!1};
function Lc(a,b){var c=b.type;c in a.g&&Ea(a.g[c],b)&&(Ic(b),0==a.g[c].length&&(delete a.g[c],a.i--))}Jc.prototype.getListener=function(a,b,c,d){a=this.g[a.toString()];var e=-1;a&&(e=Kc(a,b,c,d));return-1<e?a[e]:null};function Kc(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.Ab&&f.listener==b&&f.capture==!!c&&f.Mb==d)return e}return-1};var Mc="closure_lm_"+(1E6*Math.random()|0),Nc={},Oc=0;function x(a,b,c,d,e){if(d&&d.once)return y(a,b,c,d,e);if(Array.isArray(b)){for(var f=0;f<b.length;f++)x(a,b[f],c,d,e);return null}c=Pc(c);return a&&a[Fc]?Qc(a,b,c,na(d)?!!d.capture:!!d,e):Rc(a,b,c,!1,d,e)}
function Rc(a,b,c,d,e,f){if(!b)throw Error("g");var h=na(e)?!!e.capture:!!e,k=Sc(a);k||(a[Mc]=k=new Jc(a));c=k.add(b,c,d,h,f);if(c.g)return c;d=Tc();c.g=d;d.src=a;d.listener=c;if(a.addEventListener)yc||(e=h),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(Uc(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("h");Oc++;return c}function Tc(){function a(c){return b.call(a.src,a.listener,c)}var b=Vc;return a}
function y(a,b,c,d,e){if(Array.isArray(b)){for(var f=0;f<b.length;f++)y(a,b[f],c,d,e);return null}c=Pc(c);return a&&a[Fc]?a.i.add(String(b),c,!0,na(d)?!!d.capture:!!d,e):Rc(a,b,c,!0,d,e)}function Wc(a,b,c,d,e){if(Array.isArray(b))for(var f=0;f<b.length;f++)Wc(a,b[f],c,d,e);else d=na(d)?!!d.capture:!!d,c=Pc(c),a&&a[Fc]?a.i.remove(String(b),c,d,e):a&&(a=Sc(a))&&(b=a.getListener(b,c,d,e))&&Xc(b)}
function Xc(a){if("number"!==typeof a&&a&&!a.Ab){var b=a.src;if(b&&b[Fc])Lc(b.i,a);else{var c=a.type,d=a.g;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(Uc(c),d):b.addListener&&b.removeListener&&b.removeListener(d);Oc--;(c=Sc(b))?(Lc(c,a),0==c.i&&(c.src=null,b[Mc]=null)):Ic(a)}}}function Uc(a){return a in Nc?Nc[a]:Nc[a]="on"+a}function Vc(a,b){if(a.Ab)a=!0;else{b=new Dc(b,this);var c=a.listener,d=a.Mb||a.src;a.Kb&&Xc(a);a=c.call(d,b)}return a}
function Sc(a){a=a[Mc];return a instanceof Jc?a:null}var Yc="__closure_events_fn_"+(1E9*Math.random()>>>0);function Pc(a){if("function"===typeof a)return a;a[Yc]||(a[Yc]=function(b){return a.handleEvent(b)});return a[Yc]};function Zc(){v.call(this);this.i=new Jc(this);this.Wa=this;this.W=null}ta(Zc,v);Zc.prototype[Fc]=!0;Zc.prototype.addEventListener=function(a,b,c,d){x(this,a,b,c,d)};Zc.prototype.removeEventListener=function(a,b,c,d){Wc(this,a,b,c,d)};
function $c(a,b){var c,d=a.W;if(d)for(c=[];d;d=d.W)c.push(d);a=a.Wa;d=b.type||b;if("string"===typeof b)b=new Bc(b,a);else if(b instanceof Bc)b.target=b.target||a;else{var e=b;b=new Bc(d,a);Ia(b,e)}e=!0;if(c)for(var f=c.length-1;!b.o&&0<=f;f--){var h=b.i=c[f];e=ad(h,d,!0,b)&&e}b.o||(h=b.i=a,e=ad(h,d,!0,b)&&e,b.o||(e=ad(h,d,!1,b)&&e));if(c)for(f=0;!b.o&&f<c.length;f++)h=b.i=c[f],e=ad(h,d,!1,b)&&e}
Zc.prototype.Ea=function(){Zc.hb.Ea.call(this);if(this.i){var a=this.i,b=0,c;for(c in a.g){for(var d=a.g[c],e=0;e<d.length;e++)++b,Ic(d[e]);delete a.g[c];a.i--}}this.W=null};function Qc(a,b,c,d,e){return a.i.add(String(b),c,!1,d,e)}function ad(a,b,c,d){b=a.i.g[String(b)];if(!b)return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var h=b[f];if(h&&!h.Ab&&h.capture==c){var k=h.listener,q=h.Mb||h.src;h.Kb&&Lc(a.i,h);e=!1!==k.call(q,d)&&e}}return e&&!d.defaultPrevented}
Zc.prototype.getListener=function(a,b,c,d){return this.i.getListener(String(a),b,c,d)};function bd(){}bd.prototype.g=null;bd.prototype.getOptions=function(){var a;(a=this.g)||(a={},cd(this)&&(a[0]=!0,a[1]=!0),a=this.g=a);return a};var dd;function ed(){}ta(ed,bd);function fd(a){return(a=cd(a))?new ActiveXObject(a):new XMLHttpRequest}function cd(a){if(!a.i&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){const b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];for(let c=0;c<b.length;c++){const d=b[c];try{return new ActiveXObject(d),a.i=d}catch(e){}}throw Error("i");}return a.i}dd=new ed;try{(new self.OffscreenCanvas(0,0)).getContext("2d")}catch(a){};function z(a,b){this.width=a;this.height=b}g=z.prototype;g.aspectRatio=function(){return this.width/this.height};g.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};g.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};g.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};g.scale=function(a,b){this.width*=a;this.height*="number"===typeof b?b:a;return this};function gd(a,b){b=String(b);"application/xhtml+xml"===a.contentType&&(b=b.toLowerCase());return a.createElement(b)}function hd(){this.g=l.document||document};function id(a,b,c){if("function"===typeof a)c&&(a=qa(a,c));else if(a&&"function"==typeof a.handleEvent)a=qa(a.handleEvent,a);else throw Error("k");return 2147483647<Number(b)?-1:l.setTimeout(a,b||0)};function jd(a){Zc.call(this);this.headers=new Gb;this.v=a||null;this.o=!1;this.H=this.g=null;this.ta="";this.u=this.T=this.U=this.N=!1;this.Ca=0;this.V=null;this.Aa="";this.Da=this.Na=!1}ta(jd,Zc);var kd=/^https?$/i,ld=["POST","PUT"];g=jd.prototype;
g.send=function(a,b,c,d){if(this.g)throw Error("l`"+this.ta+"`"+a);b=b?b.toUpperCase():"GET";this.ta=a;this.N=!1;this.o=!0;this.g=this.v?fd(this.v):fd(dd);this.H=this.v?this.v.getOptions():dd.getOptions();this.g.onreadystatechange=qa(this.zc,this);try{this.T=!0,this.g.open(b,String(a),!0),this.T=!1}catch(f){md(this);return}a=c||"";const e=new Gb(this.headers);d&&Kb(d,function(f,h){e.set(h,f)});d=Ca(e.Qa());c=l.FormData&&a instanceof l.FormData;!(0<=Aa(ld,b))||d||c||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");
e.forEach(function(f,h){this.g.setRequestHeader(h,f)},this);this.Aa&&(this.g.responseType=this.Aa);"withCredentials"in this.g&&this.g.withCredentials!==this.Na&&(this.g.withCredentials=this.Na);try{nd(this),0<this.Ca&&((this.Da=od(this.g))?(this.g.timeout=this.Ca,this.g.ontimeout=qa(this.hc,this)):this.V=id(this.hc,this.Ca,this)),this.U=!0,this.g.send(a),this.U=!1}catch(f){md(this)}};function od(a){return nc&&xc()&&"number"===typeof a.timeout&&void 0!==a.ontimeout}
function Da(a){return"content-type"==a.toLowerCase()}g.hc=function(){"undefined"!=typeof ia&&this.g&&($c(this,"timeout"),this.abort(8))};function md(a){a.o=!1;a.g&&(a.u=!0,a.g.abort(),a.u=!1);pd(a);qd(a)}function pd(a){a.N||(a.N=!0,$c(a,"complete"),$c(a,"error"))}g.abort=function(){this.g&&this.o&&(this.o=!1,this.u=!0,this.g.abort(),this.u=!1,$c(this,"complete"),$c(this,"abort"),qd(this))};g.Ea=function(){this.g&&(this.o&&(this.o=!1,this.u=!0,this.g.abort(),this.u=!1),qd(this,!0));jd.hb.Ea.call(this)};
g.zc=function(){this.s||(this.T||this.U||this.u?rd(this):this.Hc())};g.Hc=function(){rd(this)};
function rd(a){if(a.o&&"undefined"!=typeof ia&&(!a.H[1]||4!=(a.g?a.g.readyState:0)||2!=sd(a)))if(a.U&&4==(a.g?a.g.readyState:0))id(a.zc,0,a);else if($c(a,"readystatechange"),4==(a.g?a.g.readyState:0)){a.o=!1;try{const h=sd(a);a:switch(h){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break a;default:b=!1}var c;if(!(c=b)){var d;if(d=0===h){var e=String(a.ta).match(Lb)[1]||null;if(!e&&l.self&&l.self.location){var f=l.self.location.protocol;e=f.substr(0,f.length-1)}d=!kd.test(e?
e.toLowerCase():"")}c=d}c?($c(a,"complete"),$c(a,"success")):pd(a)}finally{qd(a)}}}function qd(a,b){if(a.g){nd(a);const c=a.g,d=a.H[0]?ja:null;a.g=null;a.H=null;b||$c(a,"ready");try{c.onreadystatechange=d}catch(e){}}}function nd(a){a.g&&a.Da&&(a.g.ontimeout=null);a.V&&(l.clearTimeout(a.V),a.V=null)}function sd(a){try{return 2<(a.g?a.g.readyState:0)?a.g.status:-1}catch(b){return-1}};function td(a){if("running"==a.g.state&&!a.U){a.U=!0;for(let b=0;b<a.H.length;b++)a.H[b]()}}function ud(a){a.g&&(null==a.i?vd(a):void 0===a.i.playbackState?vd(a):a.i.playbackState!==a.i.PLAYING_STATE&&a.i.playbackState!==a.i.FINISHED_STATE&&vd(a))}
function wd(a,b){if(xd&&!a.g){a.g=new (window.AudioContext||window.webkitAudioContext);a.o=a.g.createGain();a.o.connect(a.g.destination);for(let c in a.O)a.O[c].s=a.g;for(let c in a.u)yd(a.u[c],a.g,a.o);a.g.onstatechange=()=>{td(a)};td(a);ud(a);y(b,["click","pointerup","mouseup","touchend"],()=>{a.g.resume();ud(a)},!0)}}function vd(a){a.i=a.g.createBufferSource();const b=a.g.createBuffer(1,1,22050);a.i.buffer=b;a.i.connect(a.g.destination);a.i.start(0);for(const c of a.V)c()}
class zd{constructor(){var a=A;this.O=Ad;this.u=a;this.g=null;this.V=[];this.o=null;this.U=this.s=!1;this.H=[];this.i=null}getContext(){return this.g}destroy(){this.g.close();this.g=null}reset(){for(let a in this.O)this.O[a].o=[];for(let a in this.u)this.u[a].stop()}isMuted(){return this.s&&!!this.o&&0==this.o.gain.value}}var xd=!(!window.AudioContext&&!window.webkitAudioContext)&&!!window.GainNode;function yd(a,b,c){a.g=b;a.O=c}
function Bd(a){if(a.g)for(const c in a.o){var b=a.o[c];!b.Gc&&1E3*a.g.currentTime>b.Ac+a.s&&delete a.o[c]}}function Cd(a){!a.i&&a.g.createGain&&(a.i=a.g.createGain())}
function Dd(a){if(a.g&&a.O){Bd(a);var b=void 0===b?a.g.currentTime:b;if(!c){var c=a.g.createBufferSource();c.playbackRate.setValueAtTime(1,a.g.currentTime)}Cd(a);a.u&&c.connect(a.u);a.i?(a.u?a.u.connect(a.i):c.connect(a.i),a.i.connect(a.O)):a.u?a.u.connect(a.O):c.connect(a.O);a.u=null;c.loop=!1;try{c.buffer=a.H.buffer}catch(e){return}c.start(b,a.U/1E3,a.s/1E3/c.playbackRate.value);var d=a.V++;a.o[d]={node:c,Ac:1E3*b,Gc:!1}}}
var Ed=class{constructor(a,b){this.H=Ad.kc;this.U=a;this.s=b;this.o={};this.u=this.O=this.g=this.i=null;this.V=0}getContext(){return this.g}stop(a){Bd(this);if(void 0!==a){if(this.o[a]){try{this.o[a].node.stop(0)}catch(c){}var b=(1E3*this.g.currentTime-this.o[a].Ac)%this.s;delete this.o[a];return[b]}return[]}a=[];for(b in this.o)a=a.concat(this.stop(b));return a}};const Fd=document.createElement("audio");
var Gd="function"===typeof Fd.canPlayType&&""!=Fd.canPlayType("audio/mpeg")?".mp3":".ogg",Hd=class extends ic{constructor(){super("/logos/2021/doodles/savoy/main"+Gd);this.s=this.buffer=null;this.O=0}u(){const a=new Promise(c=>{this.i?c():this.o.push(c)});if(0!=this.O)return Promise.resolve();if(!this.s)return Promise.reject("Must call Audio.init before preloading audio.");const b=new XMLHttpRequest;b.open("GET",this.g,!0);b.responseType="arraybuffer";b.onload=()=>{this.s.decodeAudioData(b.response,c=>
{c&&(this.buffer=c,this.O=3,hc(this))});this.O=2};b.send();this.O=1;return a}};var Kd=a=>{let b=new Image;b.onerror=b.onload=b.onabort=()=>{delete Id[Jd]};Id[Jd]=b;b.src=`${""}/gen_204?atyp=i&ct=${"doodle"}&cad=${a}&zx=${Date.now()}`;Jd++};let Id=[],Jd=0;var B=navigator.userAgent,C=new Nb(location.href),Ld="sdoodles"===document.documentElement.id,Md=()=>"MacIntel"===navigator.platform&&1<navigator.maxTouchPoints,D=()=>B.includes("iPad")||B.includes("iPhone")||B.includes("iPod")||Md();const Nd=()=>B.toLowerCase().includes("gsa")||B.includes("GoogleApp");var F=()=>D()||B.includes("Android")||B.includes("Mobile")||B.includes("Silk")||B.includes("UCBrowser")||B.includes("UCWEB");B.includes("GT-I9300")&&B.includes("Chrome");
var Od=()=>C.o.includes("/logos/")&&C.o.includes(".html"),G=()=>{const a=C.g.get("ntp");return"1"===a||"2"===a},Pd=()=>"1"===C.g.get("fpdoodle")&&!!document.getElementById("fpdoodle"),Qd=()=>!!document.querySelector("body#iframedoodle"),Rd=()=>!F()&&!Ld&&!(document.getElementById("fkbx")||G())&&!Pd()&&!Od(),Sd=Md()&&!Ld&&!(document.getElementById("fkbx")||G())&&!Pd()&&!Od();var Td={};function Ud(){var a="undefined"!==typeof window?window.trustedTypes:void 0;return null!==a&&void 0!==a?a:null}let Vd;function Wd(){var a,b;void 0===Vd&&(Vd=null!==(b=null===(a=Ud())||void 0===a?void 0:a.createPolicy("google#safe",{createHTML:c=>c,createScript:c=>c,createScriptURL:c=>c}))&&void 0!==b?b:null);return Vd};var Xd=class{};class Yd extends Xd{constructor(a){super();if(Td!==Td)throw Error("m");this.i=a}toString(){return this.i.toString()}};var Zd=class{};class $d extends Zd{constructor(a){super();if(Td!==Td)throw Error("m");this.g=a}toString(){return this.g}}var ae=new $d("about:invalid#zTSz");function be(a){if(a instanceof Zd)if(a instanceof $d)a=a.g;else throw Error("n");else a=hb(a);return a};function ce(a){var b,c=(a.ownerDocument&&a.ownerDocument.defaultView||window).document;(b=(c=null===(b=c.querySelector)||void 0===b?void 0:b.call(c,"script[nonce]"))?c.nonce||c.getAttribute("nonce")||"":"")&&a.setAttribute("nonce",b)}
function de(a){var b=new La(Ma,("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js");b=b instanceof La&&b.constructor===La&&b.i===Na?b.g:"type_error:Const";const c=Ka();b=c?c.createScriptURL(b):b;b=new Wa(b,Va);b instanceof Wa&&b.constructor===Wa?b=b.g:(la(b),b="type_error:TrustedResourceUrl");a.src=b;ce(a)};function ee(a){if(!Array.isArray(a)||!Array.isArray(a.raw)||1!==a.length)throw new TypeError("safeScript is a template literal tag function that only accepts template literals without expressions. For example, safeScript`foo`;");var b;a=a[0];var c=null===(b=Wd())||void 0===b?void 0:b.createScript(a);return new Yd(null!==c&&void 0!==c?c:a)};class fe{constructor(a){this.Fc=a}}function ge(a){return new fe(b=>b.substr(0,a.length+1).toLowerCase()===a+":")}const he=[ge("data"),ge("http"),ge("https"),ge("mailto"),ge("ftp"),new fe(a=>/^[^:]*([/?#]|$)/.test(a))];function ie(a,b=he){for(let c=0;c<b.length;++c){const d=b[c];if(d instanceof fe&&d.Fc(a))return new $d(a)}};var H=(a,...b)=>{if(a)for(let c=0;c<b.length;c+=2){const d=b[c],e=b[c+1],f=a.style;f&&d in f?f[d]=e:d in a&&(a[d]=e)}},je=Date.now,ke=()=>self.performance.now(),le=["Moz","ms","O","webkit"],me=(a,b,c)=>{if(a){for(const d of le)a.style[d+b]=c;a.style[b.charAt(0).toLowerCase()+b.substr(1)]=c}},ne=["","moz","ms","o","webkit"],oe=(a,b)=>{if(!a)return null;for(const d of ne){var c=b;0<d.length&&(c=b.charAt(0).toUpperCase()+b.substr(1));c=d+c;if("undefined"!=typeof a[c])return c}return null},pe=(a,b)=>
{(b=(b=b&&!(Nd()&&D()))||G())?wb(a):(b=window.top.location,a=ie(a,he)||ae,b.assign(be(a)))},qe=(a,b)=>{var c;return(c=window.google&&void 0!==window.google.doodle?window.google.doodle:null)&&void 0!=c[a]?c[a]:b};function re(a){return 0==a.indexOf("//")?"https:"+a:a}function se(){return re(qe("shortlink",null)||"//www.google.com/?doodle=174786811")}
var te=()=>{const a=qe("doodle_args",{}).is_dogfood;return null!=a?a:!1},ue=qe("alt",""),ve=qe("hl","en"),we=qe("gl",""),ye=(a,b,c)=>{const d=Math.max(0,c-230)+(document.querySelector("div.og-pdp")?36:12);H(a,"width",`${b}px`,"height",`${c}px`);xe(d)};
const xe=a=>{a=`${a}px`;var b=document.getElementById("lga");b&&H(b,"marginBottom",a);document.getElementById("fkbx")||G()||((b=document.getElementById("searchform"))&&H(b,"transform","translateY("+a+")"),a=new UIEvent("resize",{bubbles:!1,Oc:!1,view:window,detail:0}),window.dispatchEvent(a))};let ze=null,Ae=null,Be=null;
var Ce=()=>{Be||(window.google&&window.google.kEI&&window.google.kEI.length?Be=window.google.kEI:Qd()&&cc(C.g,"ei")&&(Be=C.g.get("ei")));return Be},De=()=>{if(!ze){const a=document.getElementById("hplogoved");a?ze=a.getAttribute("data-ved"):Qd()&&cc(C.g,"ved")&&(ze=C.g.get("ved"))}return ze};var He=a=>{var b=void 0===b?!0:b;return fa(function*(){const c="string"===typeof a?a:a.value;var d;if(!(d=yield Ee(c)))if(document.execCommand){"string"===typeof a?(Fe||(Fe=document.createElement("input"),Fe.readOnly=!0,H(Fe,"position","absolute","opacity",0,"left",0,"top",0,"pointerEvents","none"),document.body.appendChild(Fe)),Fe.value=a,d=Fe):d=a;d!==document.activeElement&&d.focus();const f=d.contentEditable,h=d.readOnly;d.contentEditable=!0;d.readOnly=!1;const k=document.createRange();k.selectNodeContents(d);
const q=window.getSelection();q.removeAllRanges();q.addRange(k);try{d.select(),d.setSelectionRange(0,d.value.length)}catch(n){}d.contentEditable=f;d.readOnly=h;try{var e=document.execCommand("copy")}catch(n){e=!1}window.getSelection().removeAllRanges();d.blur();Fe&&Fe.remove();d=e}else d=!1;return d||b&&(yield Ge())&&(yield Ee(c))?Promise.resolve():Promise.reject()}())};
const Ee=a=>fa(function*(){return navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(a).then(()=>!0,()=>!1):!1}()),Ie=a=>fa(function*(){switch(a.state){case "granted":return!0;case "denied":return!1}return new Promise(b=>{a.onchange=()=>b(Ie(a))})}()),Ge=()=>fa(function*(){return navigator.permissions&&navigator.permissions.query?Ie(yield navigator.permissions.query({name:"clipboard-write"})):!1}());let Fe=null;var Je=class{constructor(a,b){var c=52*(window.devicePixelRatio||1);const d=document.createElement("canvas");d.width=c;d.height=c;const e=d.getContext("2d");e.fillStyle="rgba(0,0,0,.3)";e.arc(c/2,c/2,c/2,0,2*Math.PI);e.fill();e.strokeStyle="#fff";e.lineWidth=c/52*3.5;const f=c/52*2;e.beginPath();e.moveTo(c/4+f,c/4+f);e.lineTo(3*c/4-f,3*c/4-f);e.stroke();e.beginPath();e.moveTo(3*c/4-f,c/4+f);e.lineTo(c/4+f,3*c/4-f);e.stroke();this.ya=d;this.ya.style.top="10px";this.ya.style.right="10px";this.ya.style.width=
"52px";this.ya.style.height="52px";this.ya.style.cursor="pointer";this.ya.style.position="absolute";this.ya.style.pointerEvents="all";this.ya.style.background="transparent";this.ya.style.display="none";this.ya.setAttribute("role","button");this.ya.setAttribute("aria-label","Close");this.ya.tabIndex=0;x(this.ya,"click",b);a.appendChild(this.ya)}};function Ke(a,b,c){this.x=void 0!==a?a:0;this.y=void 0!==b?b:0;this.z=void 0!==c?c:0}Ke.prototype.toArray=function(){return[this.x,this.y,this.z]};function I(a,b,c){this.x=a;this.y=b;this.z=c}ta(I,Ke);I.prototype.scale=function(a){this.x*=a;this.y*=a;this.z*=a;return this};I.prototype.normalize=function(){return this.scale(1/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z))};I.prototype.add=function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this};function Le(a,b){return new I(a.x-b.x,a.y-b.y,a.z-b.z)}function J(a,b,c){return new I(p(a.x,b.x,c),p(a.y,b.y,c),p(a.z,b.z,c))};function Me(a,b){a.Tb=!0;for(let c of a.Na)Me(c,b)}function Ne(a,b){a.Ub=!0;for(let c of a.Na)Ne(c,b)}function K(a,b){Me(a,!0);Ne(a,!0);a.O&&Ea(a.O.Na,a);(a.O=b)&&a.O.Na.push(a)}function Oe(a,b){for(let c of b)K(c,a)}function L(a,b){Ne(a,!0);Me(a,!0);a.Vb=b}function Pe(a){a.Tb&&(a.Wa.x=a.U.x,a.Wa.y=a.U.y,a.Wa.z=a.U.z,a.O&&a.Wa.scale(Qe(a.O)).add(Pe(a.O)),a.mc=a.Wa,a.Tb=!1);return a.mc}function Qe(a){if(a.Ub){var b=a.O?a.Vb*Qe(a.O):a.Vb;a.lc=b;a.Ub=!1}return a.lc}
function Re(a,b){if(!a.u)return!1;const c=b(a);if(c)return c;for(const d of a.Na)if(a=Re(d,b))return a;return!1}function Se(a){return a.O?a.ta+Se(a.O):a.ta}
var M=class{constructor(a=0,b=0,c=0){this.Na=[];this.O=null;this.U=a instanceof I?a:new I(a,b,c);this.Wa=new I(0,0,0);this.mc=new I(0,0,0);this.lc=this.Vb=1;this.Ub=this.Tb=this.u=!0;this.Ob=new Te;this.ta=0}Eb(a,b,c){Me(this,!0);a instanceof I?(this.U.x=a.x,this.U.y=a.y,this.U.z=a.z):(this.U.x=void 0===a?this.U.x:a,this.U.y=void 0===b?this.U.y:b,this.U.z=void 0===c?this.U.z:c)}Aa(){return new z(0,0)}g(){}};class Te{constructor(){this.g=0}};var Ue=class extends M{constructor(){super();this.T=!1}g(a){this.T||(this.T=!0,this.W());this.H(a);this.i()&&this.$b()}H(){}W(){}$b(){}i(){return!1}},Ve=class extends Ue{constructor(a,b=()=>{},c=()=>{}){super();this.o=0;this.v=a;b&&(this.H=b);this.$b=c}i(){return this.o>=this.v}g(a){this.o+=a;super.g(a)}},We=class extends Ue{constructor(a){super();this.o=a}g(a){for(let b of this.o)b.i()||b.g(a);super.g(a)}i(){for(let a of this.o)if(!a.i())return!1;return!0}};function Xe(a,b){Array.isArray(b)?a.i.push(new We(b)):a.i.push(b)}var Ye=class extends M{constructor(){super();this.i=[];this.o=[]}g(a){if(0<this.i.length&&0<a){var b=this.i[0];b.g(a);b.i()&&this.i.length&&this.i[0]===b&&this.i.shift()}for(b=0;b<this.o.length;b++)this.o[b].g(a),this.o[b].i()&&this.o.splice(b--,1)}schedule(a,b=()=>{},c=()=>{}){Xe(this,new Ve(a,c,b))}};function Ze(a,b,c,d,e,f){if(6==arguments.length)$e(this,a,b,c,d,e,f);else{if(0!=arguments.length)throw Error("o");this.g=this.u=1;this.o=this.i=this.O=this.s=0}}function $e(a,b,c,d,e,f,h){if("number"!==typeof b||"number"!==typeof c||"number"!==typeof d||"number"!==typeof e||"number"!==typeof f||"number"!==typeof h)throw Error("p");a.g=b;a.o=c;a.i=d;a.u=e;a.O=f;a.s=h;return a}Ze.prototype.scale=function(a,b){this.g*=a;this.o*=a;this.i*=b;this.u*=b;return this};
Ze.prototype.toString=function(){return"matrix("+[this.g,this.o,this.i,this.u,this.O,this.s].join()+")"};Ze.prototype.transform=function(a,b,c,d,e){let f=b;for(b+=2*e;f<b;){e=a[f++];const h=a[f++];c[d++]=e*this.g+h*this.i+this.O;c[d++]=e*this.o+h*this.u+this.s}};function af(){this.height=this.width=this.top=this.left=0}af.prototype.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};af.prototype.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
af.prototype.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};af.prototype.scale=function(a,b){b="number"===typeof b?b:a;this.left*=a;this.width*=a;this.top*=b;this.height*=b;return this};var bf=1/76,cf=new I(0,0,0);let df=cf;Object.isFrozen&&!Object.isFrozen(cf)&&(df=Object.create(cf),Object.freeze(df));function ef(a){if(a.o&&ff(a)){var b=a.o,c=-ff(a);a=new Ze;var d=Math.cos(c);c=Math.sin(c);a=$e(a,d,c,-c,d,-(0*d)+0*c,-(0*c)-0*d);d=b.g;c=b.i;b.g=a.g*d+a.o*c;b.i=a.i*d+a.u*c;b.O+=a.O*d+a.s*c;d=b.o;c=b.u;b.o=a.g*d+a.o*c;b.u=a.i*d+a.u*c;b.s+=a.O*d+a.s*c}}function ff(a){return a.O&&a.O instanceof gf?ff(a.O):0}function hf(a,b,c,d,e){a.Da.left=b;a.Da.top=c;a.Da.width=d;a.Da.height=e;a=a.Da;0>a.width&&(a.width*=-1,a.left-=a.width);0>a.height&&(a.height*=-1,a.top-=a.height)}
function jf(a){const b=a.Qb(),c=a.Aa().width,d=a.Aa().height,e=-a.Ib.x*c,f=-a.Ib.y*d;let h=[];b.transform([e,f,e+c,f,e+c,f+d,e,f+d],0,h,0,4);const [k,q]=[h[0],h[2],h[4],h[6]].reduce((r,E)=>[Math.min(r[0],E),Math.max(r[1],E)],[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER]),[n,w]=[h[1],h[3],h[5],h[7]].reduce((r,E)=>[Math.min(r[0],E),Math.max(r[1],E)],[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER]);hf(a,k,n,q-k,w-n)}function kf(a,b){if(!a.uc(b))return!1;jf(a);return a.isVisible(b)}
var gf=class extends M{constructor(a=0,b=0,c=0){super(a,b,c);this.o=new Ze;this.Da=new af;this.Jb=new z(0,0);this.Sb=1;this.Ib=new za(.5,.5);this.Ec="source-over"}isVisible(a){a=a.V;var b=this.Da;return a.left<=b.left+b.width&&b.left<=a.left+a.width&&a.top<=b.top+b.height&&b.top<=a.top+a.height}Qb(){return this.o}Pb(){return Pe(this).z}Aa(){return this.Jb}setSize(a,b){a instanceof z?this.Jb=new z(a.width,a.height):(this.Jb.width=a,this.Jb.height=void 0===b?a:b)}i(a){this.Sb=Math.min(Math.max(a,0),
1)}uc(a){var b=Pe(this);a=new za(b.x+a.V.width/2,b.y+a.V.height/2);this.o?$e(this.o,Qe(this),0,0,Qe(this),a.x,a.y):this.o=new Ze(Qe(this),0,0,Qe(this),a.x,a.y);this.o=this.o;ef(this);return!0}Ca(){}};var lf=class extends M{constructor(a){super();this.o=a;this.i=new wa}g(){var a=this.o.Da;const b=this.i,c=new za(a.left+a.width/2,a.top+a.height/2);var d=c.y;b.i=c.x;b.o=d;a=new z(a.width,a.height);b.O=Math.max(a.width,a.height)/2;a=b.o;b.i=b.i;b.o=a}};var mf=()=>{if(Qd())throw"";return Rd()||!!document.getElementById("fkbx")||G()},nf=()=>{if(Qd())throw"";return Pd()||Od()||F()&&!Md()},of=()=>Qd()?"1"==C.g.get("ccta"):Pd()&&!(document.getElementById("fkbx")||G())||Od()&&F()&&!Rd(),pf=()=>{const a=!F()&&Rd()&&600>=window.innerHeight;return Rd()||a};class qf extends ic{constructor(a){super(a);this.image=new Image}u(){if(this.image.src)return Promise.resolve(this.image);let a;const b=new Promise(d=>a=d),c=()=>{hc(this);a(this.image)};this.image.crossOrigin="Anonymous";this.image.decode?(this.image.src=this.g,this.image.decode().then(c,()=>{this.image.removeAttribute("crossOrigin");this.image.src=this.g;this.image.decode().then(c,d=>{console.error(d);c()})})):(this.image.onload=c,this.image.onerror=()=>{this.image.removeAttribute("crossOrigin");
this.image.removeAttribute("onerror");this.image.src=this.image.src},this.image.src=this.g);(this.image.complete||"complete"==this.image.readyState)&&c();return b}};function rf(a){return"number"===typeof a?a:a[0]}function sf(a,b){const c=a.g[rf(b)];return(new Promise(d=>{c.i?d():c.o.push(d);c.u()})).then(()=>{})}function tf(a,b,c=0,d=0,e=1){a=b[5]||1;return-(e*b[1]/a+c)+"px "+-(e*b[2]/a+d)+"px"}function uf(a,b,c=1){const d=b[5]||1;a=a.i[rf(b)];return c*a[0]/d+"px "+c*a[1]/d+"px"}function vf(a,b,c=0,d=0,e=1){return`url(${a.g[rf(b)].g}) ${tf(0,b,c,d,e)}/${uf(a,b,e)} no-repeat`}function wf(a,b,c){return vf(a,b,0,0,c/Math.max(b[3],b[4]))}
class xf{constructor(){var a=yf;this.g=[];this.i=[];for(const c of a){a=new qf("/logos/2021/doodles/savoy/"+c.filename);var b=c.size;this.g.push(a);this.i.push(b)}}};var zf=class{g(){}},Af=null;var Bf=class extends gf{constructor(a=0,b=0,c=0){super(a,b,c);this.oc=0}Pb(){return this.oc}uc(a){this.oc=a.Rb(Pe(this)).z;this.o=a=a.Qb(Pe(this),Qe(this));ef(this);return!!a}Ca(){}};var Cf=class extends Bf{constructor(){super(void 0);this.s=this.v=null;this.T=0*Math.PI/180;this.N=360*Math.PI/180;this.H=.01;this.setSize(1.44)}Ca(a){super.Ca(a);a.beginPath();a.arc(0,0,.72,this.T,this.N);this.T%(2*Math.PI)!=this.N%(2*Math.PI)&&a.lineTo(0,0);a.closePath();this.s&&.01<this.H&&(a.strokeStyle=this.s,a.lineWidth=this.H,a.stroke());this.v&&(a.fillStyle=this.v,a.fill())}};var Df="function"===typeof Uint8Array;function Ef(){}let Ff;const Gf=[];function Hf(a,b){if(b<a.O){b+=a.u;var c=a.g[b];return c!==Gf?c:a.g[b]=[]}if(a.i)return c=a.i[b],c===Gf?a.i[b]=[]:c}Ef.prototype.toArray=function(){if(this.o)for(var a in this.o){var b=this.o[a];if(Array.isArray(b))for(var c=0;c<b.length;c++)b[c]&&b[c].toArray();else b&&b.toArray()}return this.g};Ef.prototype.toString=function(){return this.toArray().toString()};class If{constructor(a,b){this.u=b?1E3/b:0;this.g=null;this.o=a;this.O=this.i=0}reset(){this.g=null}call(a,b){0==this.u?b++:(b=0==this.O?Date.now():this.i,null==this.g&&(this.g=b),b=Math.floor((b-this.g)/this.u));b>=a&&(b=0<=this.o?b%(a-this.o)+this.o:a-1);return b}};function Jf(a){a.u.clearRect(0,0,a.o.width,a.o.height)}function Kf(a,b){0==b&&Jf(a);b=a.o.frames[b];for(const c of b){b=c[0];const d=c[1],e=c[2]+a.s.x,f=c[3]+a.s.y,h=c[4],k=c[5];a.u.clearRect(b,d,h,k);a.u.drawImage(a.U,e,f,h,k,b,d,h,k)}}function Lf(a){a.i>a.g&&(a.i=-1);for(a.i==a.g&&Kf(a,a.g);a.i<a.g;)Kf(a,++a.i)}class Mf{constructor(a,b,c,d,e){this.u=a;this.o=b;this.U=c;this.s=d||{x:0,y:0};this.i=-1;this.g=0;this.O=e||new If(-1,void 0)}reset(){Jf(this);this.g=0;this.i=-1;this.O.reset()}};const Nf=1E3/42;
var Of=class extends Bf{constructor(a){super();var b=a.Ia,c=document.createElement("canvas");c.width=b.width;c.height=b.height;this.v=c;b=this.v.getContext("2d");c=Af.g();this.T=1E3/Nf;this.H=new If(0,Nf);this.H.O=1;var d=a.Oa;this.Lb=new Mf(b,a.Ia,c.g[rf(a.Oa)].image,{x:d[1],y:d[2]},this.H);this.setSize(a.Ia.width,a.Ia.height);this.s=!0;this.N=!1}pause(){this.s=!0}g(a){var b=this.H;b.i+=a;this.s?this.N||Lf(this.Lb):(a=this.Lb,Lf(a),a.g=a.O.call(a.o.frames.length,a.i));this.N=!0}Ca(a){var b=this.Aa();
const c=bf*b.height;b=bf*b.width;a.drawImage(this.v,-b/2,-c/2,b,c)}getDuration(){return this.Lb.o.frames.length*this.T}};function Pf(a,b,c){const d=a.g.get(b)||[],e=[...a.i,...d];for(let f=0;f<e.length;f++)(a.i.includes(e[f])||d.includes(e[f]))&&e[f].ac(b,c)}function Qf(a,b){let c=b.indexOf(a);for(;-1!=c;)b.splice(c,1),c=b.indexOf(a)}class Rf{constructor(){this.i=[];this.g=new Map}addListener(a,b){void 0===b?this.i.push(a):(this.g.has(b)||this.g.set(b,[]),this.g.get(b).push(a))}removeListener(a,b){if(void 0!==b)Qf(a,this.g.get(b)||[]);else{Qf(a,this.i);for(const c of this.g.values())Qf(a,c)}}}ka(Rf);function Sf(a,b){const c=new M;c.g=()=>{a.s(b.width,b.height)};c.g(0);K(c,a)}function Tf(a,b,c=1){if(a.N(b))return null;const d=a.v(b.z);return new Ze(d*c,0,0,d*c,d*b.x+a.V.width/2,-1*d*b.y+a.V.height/2)}var Uf=class extends M{constructor(){super(void 0,0,0);this.V=new af;this.N=a=>this.H(a)}s(a,b){this.V.width=a;this.V.height=b}Rb(a){return Le(a,Pe(this))}Qb(a,b=1){a=this.Rb(a);return Tf(this,a,b)}H(){return!1}v(){return 1}};var Vf=class extends Uf{constructor(){super();this.i=new Map;this.o=0;this.o=1.05*this.V.height}s(a,b){super.s(a,b);this.o=1.05*this.V.height}g(){this.o=1.05*this.V.height}Eb(a,b,c){super.Eb(a,b,c);this.i.clear()}Rb(a){let b=this.i.get(173*(Math.round(1E4*a.x)/1E4*103+Math.round(1E4*a.y)/1E4)+Math.round(1E4*a.z)/1E4);b||(b=Le(a,Pe(this)),1E3>this.i.size&&this.i.set(173*(Math.round(1E4*a.x)/1E4*103+Math.round(1E4*a.y)/1E4)+Math.round(1E4*a.z)/1E4,b));return b}H(a){return 2>=a.z||Math.abs(a.x)>=this.V.width/
this.V.height*a.z*10||super.H(a)}v(a){return Math.abs(this.o/a)}};const Wf=[0,0,0,0,0,0];function Xf(a,b,c){a.W.width=b;a.W.height=c;a.Ib.x=-1*b+.5;a.Ib.y=-c+.5}function Yf(a,b){a.H=b;a.s=0;a.v=0;a.Ga&&(a.N=a.Ga[a.s])}function Zf(a){return a.s>=a.Ga.length-1?(a.H=a.H&&a.oa,0):a.s+1}function $f(a,b){a.s=b;a.N=a.Ga[a.s]}
var ag=class extends Bf{constructor(a=Wf,b=0,c=0,d=0){super(b,c,d);this.N=(this.Ga="number"==typeof a[0]?null:a)?this.Ga[0]:a;this.s=this.v=0;this.H=!1;this.oa=!0;this.Ba=new z(1,1);this.W=new z(0,0);this.wa=new z(0,0);Xf(this,0,-.5);a=this.setSize;this.T();b=bf*this.N[3];this.T();a.call(this,b,bf*this.N[4]);this.ka=42}T(){}Aa(){const a=super.Aa();return new z(a.width*this.Ba.width,a.height*this.Ba.height)}pause(){this.H=!1}resume(){this.H=!0}setLoop(a){this.oa=a}getDuration(){return this.Ga?42*this.Ga.length:
0}reset(){this.v=this.s=0;this.N=this.Ga[this.s];this.H=!1}g(a){super.g(a);this.H&&(this.v+=a,this.Ga&&this.v>this.ka&&(this.v-=this.ka,$f(this,Zf(this))))}Ca(a){super.Ca(a);const b=this.Aa();this.va(a,this.wa.width+this.W.width*b.width,-this.wa.height+this.W.height*b.height,b.width,b.height,!1)}va(){}};var bg=class extends ag{T(){return Af.g()}va(a,b,c,d,e,f){f&&a.scale(-1,1);var h=this.T(),k=this.N,q=b-d/2,n=c-e/2,w=k[1],r=k[2];const E=k[3],U=k[4];let P,Q;void 0==d?(c=w,b=r,P=E,Q=U,d=E,e=U):(c=w,b=r,P=E,Q=U);if(c<w){var aa=w-c;c=w;P-=aa;q+=aa;d-=aa}b<r&&(aa=r-b,b=r,Q-=aa,n+=aa,e-=aa);c+P>w+E&&(w=c+P-(w+E),P-=w,d-=w);b+Q>r+U&&(r=b+Q-(r+U),Q-=r,e-=r);h=h.g[rf(k)];if(!h.i)throw Error("q");0<P&&0<Q&&a.drawImage(h.image,c,b,P,Q,q,n,d,e);f&&a.scale(-1,1)}};function cg(a,b){a.o=[];for(const d of a.O)Re(d,e=>{a.o.push(e);e.g(b)});a.i=[];let c=0;Re(a.u,d=>{a.i.push(d);var e=c++;d.Ob.g=e;d.g(b)})}function dg(a,b){a.g=[];for(var c of a.o)c.u&&c instanceof gf&&kf(c,b)&&a.g.push(c);c=[];for(let d of a.i)d.u&&d instanceof gf&&kf(d,b)&&c.push(d);c.sort((d,e)=>{let f=e.Pb()+Se(e)-(d.Pb()+Se(d));return f?f:d.Ob.g-e.Ob.g});c.forEach(()=>{});a.g.push(...c)}
class eg{constructor(){this.O=[];this.u=new M;this.g=[];this.o=[];this.i=[]}reset(){this.O=[];this.u=new M;this.g=[];this.o=[];this.i=[]}}ka(eg);function fg(a,b,c,d){this.g=a;this.o=b;this.i=c;this.u=d}function gg(a,b){if(0==b)return 0;if(1==b)return 1;var c=p(0,a.g,b),d=p(a.g,a.i,b);a=p(a.i,1,b);c=p(c,d,b);d=p(d,a,b);return p(c,d,b)}function hg(a,b){var c=b;if(0>=c)return 0;if(1<=c)return 1;for(var d=0,e=1,f=0,h=0;8>h;h++){f=gg(a,c);var k=(gg(a,c+1E-6)-f)/1E-6;if(1E-6>Math.abs(f-b))return c;if(1E-6>Math.abs(k))break;else f<b?d=c:e=c,c-=(f-b)/k}for(h=0;1E-6<Math.abs(f-b)&&8>h;h++)f<b?(d=c,c=(c+e)/2):(e=c,c=(c+d)/2),f=gg(a,c);return c};const ig=(a,b,c,d)=>{const e=new fg(a,b,c,d);return f=>{f=hg(e,f);if(0==f)f=0;else if(1==f)f=1;else{var h=p(0,e.o,f),k=p(e.o,e.u,f),q=p(e.u,1,f);h=p(h,k,f);k=p(k,q,f);f=p(h,k,f)}return f}};var jg=ig(.25,.1,.25,1),kg=(a,b,c,d=jg)=>b+d(a)*(c-b),lg=a=>a,mg=ig(.4,0,1,1),ng=ig(0,0,.6,1),og=ig(.25,1,.5,1),pg=ig(.6,0,.4,1);var qg=class extends Ve{constructor(a,b,c,d,{Tc:e=p,$b:f=()=>{},Xb:h=lg,Rc:k}={}){super(a,null,f);this.ka=d;this.N=k;this.s=b;if(null===this.s&&void 0===this.N)throw Error("r");this.oa=c;this.Da=e;this.Ca=h}W(){null===this.s&&(this.s=this.N())}H(){this.ka(this.Da(this.s,this.oa,this.Ca(Math.min(Math.max(this.o/this.v,0),1))))}};function rg(a,b){void 0!==b&&(a.O=b);b=a.u.getBoundingClientRect();const c=a.O?b.width:b.height;a.T=a.u.width/(a.O?b.height:b.width);a.V=a.u.height/c}
class sg{constructor(a){this.u=a;this.o=[];this.g=null;this.v=this.H=0;this.N=this.s=!1;this.U=[];this.V=this.T=1;this.ta=[this.u];this.O=!1;x(window,"resize",()=>{rg(this)});rg(this)}handleEvent(a){var b=a.g;var c=void 0;b=(b=b||window.event)?(c=c||b.targetTouches&&b.targetTouches[0]||b.changedTouches&&b.changedTouches[0])&&void 0!==c.pageX?[c.pageX,c.pageY]:void 0!==b.clientX?[b.clientX+("rtl"==document.dir?-1:1)*(document.body.scrollLeft||document.documentElement.scrollLeft||0),b.clientY+(document.body.scrollTop||
document.documentElement.scrollTop||0)]:void 0!==b.pageX?[b.pageX,b.pageY]:[0,0]:[0,0];c=this.u.getBoundingClientRect();if(this.O){var d=c.right-b[0];b[0]=b[1]-c.top;b[1]=d}else b[0]-=c.left,b[1]-=c.top;b[0]*=this.T;b[1]*=this.V;c=b[1];this.H=b[0];this.v=c;a=a.type;if(!this.N||0!=a.indexOf("mouse")){b={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"};a in b&&(this.N=!0,a=b[a]);c=a;a=this.H;b=this.v;if(!this.s&&"mousedown"==c)for(this.s=!0,d=0;d<this.U.length;d++)this.U[d]();if("mousedown"==
c){if(!this.i)for(c=0;c<this.o.length;c++)if(d=this.o[c],d.g.g(a,b)){this.i=d;d.callback("mousedown",a,b);break}}else if("mouseup"==c)this.i?(this.i.callback("mouseup",a,b),this.i=null):this.g&&this.g.callback("mouseup",a,b);else if("mousemove"==c||"areamove"==c){d=null;for(let e=0;e<this.o.length;e++){const f=this.o[e];if(f.g.g(a,b)){d=f;break}}this.g!=d&&(this.g&&this.g.callback("mouseout",a,b),d&&d.callback("mouseover",a,b),this.g=d);if("mousemove"==c)for(this.i&&this.i.callback("mousemove",a,
b),c=0;c<this.o.length;c++)d=this.o[c],d!=this.i&&d.g.g(a,b)&&d.callback("mousemove",a,b)}else"mouseout"==c?(this.g&&this.g.callback("mouseout",a,b),this.g=this.i=null):"contextmenu"==c&&this.g&&this.g.callback("contextmenu",a,b);a=this.g&&this.g.g.u()?"pointer":"default";for(let e=0,f;f=this.ta[e];e++)H(f,"cursor",a)}}}(()=>{const a=new xa;a.g=()=>!0;a.u=()=>!1;return a})();function tg(a,b){a.o.push(b);a.V=!0}function ug(a){const b=(new Date).getTime();30<a.i&&a.u&&(b-a.u>=1.05*a.U?a.g++:a.g>>=1,20<a.g&&(a.U=Math.min(50,1.2*a.U),a.g=0));a.u=b}function vg(a){if(a.v)a.H=!1;else{a.H=!0;ug(a);a.V&&(a.o.sort(function(d,e){return d.g==e.g?e.i-d.i:d.g-e.g}),a.V=!1);var b=0,c;for(let d=0;c=a.o[d];d++)if(c.g<=a.i)wg(c)&&tg(a,c),b++;else break;a.o.splice(0,b);a.i++;requestAnimationFrame(()=>{vg(a)})}}
class xg extends v{constructor(){super();this.v=!0;this.H=!1;this.o=[];this.V=!1;this.g=this.u=this.i=0;this.U=yg}schedule(a,b,c){a=new zg(a,b,c);tg(this,a);return a}start(){this.v=!1;this.H||vg(this)}stop(){this.v=!0;this.u=this.g=0}Ea(){this.reset();super.Ea()}reset(){this.stop();this.o=[];this.i=0;this.V=!1;this.U=yg;this.u=this.g=0}}ka(xg);const yg=1E3/60;function wg(a){const b=a.o(a.O);a.O++;a.g=xg.$().i+a.i/xg.$().U;!b&&a.u&&a.u();return b}
var zg=class{constructor(a,b,c=null){this.i=a;this.o=b;this.g=xg.$().i;this.O=0;this.u=c}cancel(){this.o=function(){return!1}}};function Ag(a){return null===a.g?0:a.o()-a.g}function Bg(a){let b=Math.min(Math.max(Ag(a)/a.duration,0),1);a.i&&(b=1-b);for(let c in a.u)a.O.hasOwnProperty(c)&&(a.s[c]=kg(b,a.u[c],a.O[c],a.U));return a.s}function Cg(a){return Ag(a)>=a.duration}
class Dg{constructor(a,b,c=jg,d=ke){this.u=a;this.O=b;this.s={};this.duration=400;this.U=c;this.o=d;this.g=null;this.i=!1}start(){this.g=this.o();this.i=!1}resume(){if(null!==this.g){if(this.i){const a=Math.min(this.duration,Ag(this));this.g=this.o()-(this.duration-a);this.i=!1}}else this.start()}reset(){this.g=null}};function Eg(a){return 3*a*a-2*a*a*a};function Fg(a,b){fa(function*(){yield Gg(a);const c={cmd:"resizeDoodle",width:"960px",height:"540px",duration:"400ms"};"1"===C.g.get("ntp")?window.parent.postMessage(c,"chrome-search://local-ntp"):window.top.postMessage(c,"chrome://new-tab-page");a.i=!0;let d=!1;const e=()=>{a.U&&a.g.classList.remove("ddl-expanderHide_");d=!0;b()};a.o=setTimeout(e,500);window.addEventListener("message",f=>{"resizeComplete"===f.data.Pc&&(null!==a.o&&(clearTimeout(a.o),a.o=null),d||e())})}())}
function Hg(a,b){var c=!0;b=void 0===b?()=>{}:b;c=void 0===c?!1:c;var d=void 0===d?0:d;var e=void 0===e?!1:e;if(a.g&&mf()&&!a.i){var f=a.g;if(G())Fg(a,b);else{document.getElementById("fkbx")&&H(f.parentElement,"width","100%");var h=f.offsetHeight,k=f.offsetWidth;d=Math.min(960,f.parentElement.clientWidth)-2*d;e=e?540:d/(960/540);var q=xg.$(),n=self.performance.now(),w=new Dg({height:h,width:k},{height:e,width:d},Eg,()=>n);w.start();a.i=!0;a.u=r=>{n=void 0!==r?n+r:self.performance.now();r=Bg(w);ye(f,
Math.round(r.width),Math.round(r.height));a.V();return Cg(w)?(b(),a.g.style.willChange="unset",a.u=()=>!1,!1):!0};c||q.schedule(1E3/60,()=>a.u())}}}function Gg(a){if(!a.U)return Promise.resolve();a.g.classList.add("ddl-expanderHide_");return new Promise(b=>{setTimeout(b,200)})}
class Ig extends v{constructor(a,b){b=void 0===b?()=>{}:b;super();this.i=!1;this.V=b;this.g=a;this.U="1"===C.g.get("ntp");this.u=()=>!1;this.o=null;mf()&&(this.g.style.willChange="width,height")}Ea(){super.Ea();this.reset();this.g=null}reset(){this.i&&(H(this.g,"width","","height",""),xe(0),this.g.style.width="",this.g.style.height="");this.i=!1}};var Kg=()=>{var a=["Quicksand:wght@400;700","Limelight","Sigmar One"];let b,c;const d=new Promise((e,f)=>{b=e;c=f});if(window.WebFontConfig&&a){for(const e of a)Jg(e);return d}sa("WebFontConfig.active",b);sa("WebFontConfig.inactive",c);sa("WebFontConfig.google.families",a);a=gd(document,"SCRIPT");de(a);a.type="text/javascript";a.async=!0;(document.getElementById("xjsc")||document.body).appendChild(a);return d},Jg=a=>{a=a.toLowerCase().replace(/ /g,"");const b=document.documentElement.classList;for(const c of b.values())if(c.search(`wf-${a}-w+-active`))break};function Lg(a){v.call(this);this.i=a;this.g={}}ta(Lg,v);var Ng=[];function Og(a,b,c,d,e){Array.isArray(c)||(c&&(Ng[0]=c.toString()),c=Ng);for(var f=0;f<c.length;f++){var h=x(b,c[f],d||a.handleEvent,e||!1,a.i||a);if(!h)break;a.g[h.key]=h}}function Pg(a){Ga(a.g,function(b,c){this.g.hasOwnProperty(c)&&Xc(b)},a);a.g={}}Lg.prototype.Ea=function(){Lg.hb.Ea.call(this);Pg(this)};Lg.prototype.handleEvent=function(){throw Error("s");};const Qg=D()&&B.includes("OS 12_");function Rg(a){a.u&&(window.screen.lockOrientation&&window.screen.lockOrientation(a.u),window.screen.orientation&&window.screen.orientation.lock&&window.screen.orientation.lock(a.u).catch(ja))}function Sg(a){a.u="landscape-primary";document[Tg]&&Rg(a)}function Ug(a){a.s&&(a.v?(Vg.call(document),a.v=!1):(a.V.call(a.g),Rg(a)))}
function Wg(a,b,c,d=()=>{}){a.g=b;a.o=[];a.N=d;a.U=!0;a.V=b[oe(b,"requestFullscreen")];b=!!(document[oe(document,"fullscreenEnabled")]&&a.V&&Vg);if(Qd())throw"";d=D()?!1:Pd()&&!(Nd()&&D()||Nd()&&!D())||Od()&&F();a.s=d&&b;a.O=nf();a.H=!1;a.i=!0;if(a.s||a.O)H(document.body,"margin","0"),H(a.g,"overflow","visible","width","100%","height","100%"),document.body.scrollLeft=0,c?Og(c,window,"scroll",Xg):x(window,"scroll",Xg,!0)}function Yg(a,b){a.o.push(b);a.i=!0}
function Zg(a,b){const c=document.createElement("div");c.style.pointerEvents="none";c.style.position="absolute";c.style.top="0";c.style.left="0";c.style.width="100%";c.style.height="100%";c.style.direction="ltr";c.dataset.width=a.toString();c.dataset.height=b.toString();return c}
class $g{constructor(){this.ta=this.W=this.N=this.g=this.o=null;this.Aa=!1;this.V=null;this.U=this.H=this.O=this.s=!1;this.i=!0;this.v=this.T=!1;this.u=null}reset(){this.ta=this.W=this.N=this.g=this.o=null;this.Aa=!1;this.V=null;this.U=this.H=this.O=this.s=!1;this.i=!0;this.v=this.T=!1;this.u=null}close(){this.v=!0;Ug(this)}}ka($g);const Tg=oe(document,"fullscreenElement"),Vg=document[oe(document,"exitFullscreen")],Xg=a=>{a.preventDefault();a.stopPropagation();return!1};const ah=[5,6,7,8,9,11,12,16];let bh=0,ch=0,dh=!1,N={},eh=[];
var fh=a=>{var b=Date.now();N.dt=b-ch;ch=b;0==a&&(bh=b);N.e=a;N.t=0==bh?-1:Math.floor(b-bh);N.m=F()?1:0;b=window.document;b="CSS1Compat"==b.compatMode?b.documentElement:b.body;b=new z(b.clientWidth,b.clientHeight);N.w=b.width>b.height?1:0;b=[];for(var c in N)N.hasOwnProperty(c)&&b.push(c+":"+N[c]);c=b.join(",");b=10==a;var d=0<=ah.indexOf(a);(document.getElementById("fkbx")||G())&&(c+="&ntp=1");b?(b=De())&&(c+=`&ved=${b}`):d&&(Ae||((b=document.getElementById("hplogoshareved"))?Ae=b.getAttribute("data-ved"):
Qd()&&cc(C.g,"sved")&&(Ae=C.g.get("sved"))),(b=Ae)&&(c+=`&ved=${b}`));-1==c.search("&ei=")&&(c+="&ei=",(b=Ce())&&(c+=b));for(window.google&&window.google.log?window.google.log("doodle",c):Kd(c);0<eh.length;)delete N[eh.pop()];dh||0!=a||of()||(dh=!0,fh(10))};function gh(a){if(!a.T&&!a.H&&window.agsa_ext&&window.agsa_ext.getPageVisibility)return"hidden"==window.agsa_ext.getPageVisibility();const b=document[a.H];return document[a.T]||"hidden"==b}function hh(a){a.i?ih(a):Nd()&&!D()&&jh(a,()=>{ih(a)})}function kh(a){Og(a.v,document,"mousedown mouseout touchstart mouseup mousemove touchend touchmove contextmenu keypress keydown keyup".split(" "),()=>lh(a),!0)}
function mh(a){a.o&&clearTimeout(a.o);const b=Math.max(100,6E4-nh(a));a.o=setTimeout(()=>{a.o=null;a.U=6E4<=nh(a);a.U||mh(a);oh(a)},b)}function lh(a){a.N=je();a.U=!1;oh(a)}function ih(a){a.g=()=>{a.u=gh(a);a.u?oh(a):lh(a)};const b=window.agsa_ext;a.i?document.addEventListener(a.i,a.g,!1):b&&b.registerPageVisibilityListener&&(google.doodle||(google.doodle={}),google.doodle.pvc=()=>{a.g&&a.g()},b.registerPageVisibilityListener("google.doodle.pvc();"))}
function jh(a,b){window.agsa_ext?b():a.ta=setTimeout(()=>{hh(a)},100)}function nh(a){return je()-a.N}function oh(a){const b=a.u||a.U;a.V&&!b?(a.V=!1,a.Aa(),mh(a)):!a.V&&b&&(a.V=!0,a.W())}
class ph extends v{constructor(a,b){super();this.W=a;this.Aa=b;this.N=je();this.T=oe(document,"hidden");this.i=(this.H=oe(document,"visibilityState"))?this.H.replace(/state$/i,"change").toLowerCase():null;this.u=gh(this);this.U=!1;this.V=this.u;this.v=new Lg;Ac(this,ra(zc,this.v));hh(this);kh(this);mh(this)}Ea(){clearTimeout(this.o);clearTimeout(this.ta);this.g&&(this.i&&document.removeEventListener?document.removeEventListener(this.i,this.g,!1):window.agsa_ext&&window.agsa_ext.registerPageVisibilityListener&&
(this.g=null));super.Ea()}};var qh=class extends Ef{constructor(a){super();this.o=null;Ff&&(a||(a=Ff),Ff=null);var b=this.constructor.Uc,c=this.constructor.Sc;c=b||c;a||(a=c?[b]:[]);this.u=c?0:-1;this.g=a;a:{if(a=this.g.length)if(--a,b=this.g[a],!(null===b||"object"!=typeof b||Array.isArray(b)||Df&&b instanceof Uint8Array)){this.O=a-this.u;this.i=b;break a}this.O=Number.MAX_VALUE}}};var rh=()=>{if(De()&&Ce())return Promise.resolve();let a="_fmt:jspb,doodle:174786811,slot:0,type:3,cta:1";(document.getElementById("fkbx")||G())&&(a+=",ntp:1");De()&&(a+=",impr:0");const b=new Qb;b.add("async",a);return ec(new gc,b,void 0,!1).then(c=>{c=new qh(c);if(!De()&&Hf(c,2)){const d=Hf(c,2);ze=(new Nb(d)).g.get("ved","")}!Ce()&&Hf(c,3)&&(Be=Hf(c,3))}).catch(()=>Promise.resolve())};var sh=a=>{if(D())for(const b of a)x(b,"touchmove",c=>{1!==c.scale&&c.preventDefault()},{passive:!1})},th=a=>{for(const b of a)x(b,"contextmenu",c=>{c.preventDefault()},{passive:!1})};let uh=null;var vh=a=>{if(document.getElementById("fkbx")||G())(document.getElementById("fkbx")||G())&&uh&&(Xc(uh),uh=null),uh=x(window,"resize",()=>{a.o(50)})};const wh=a=>new Promise(b=>setTimeout(b,a));function xh(){return"ddl-lightboxEnabled_"}
function yh(a,b){const c=document.createElement("div");c.classList.add("ddl-lightbox_");th([c]);c.setAttribute("aria-modal","true");const d=document.createElement("div");d.classList.add("ddl-lightboxContainer_");H(d,"maxWidth","960px","maxHeight","540px");c.appendChild(d);b.classList.add("ddl-lightboxContent_");H(b,"width","960px","height","540px","position","relative","left","50%","top","50%");d.appendChild(b);window.addEventListener("resize",()=>zh(a));b=new Je(b,()=>Ah(a));b.ya.style.display="block";
c.appendChild(b.ya);return{ya:b,ab:c,ha:d}}function zh(a){const b=a.s,c=a.o;me(b,"Transform",`scale(${Math.min(c.clientHeight/b.clientHeight,c.clientWidth/b.clientWidth)}) translate(-50%,-50%)`);a.u()}function Ah(a){return fa(function*(){Xc(a.i);me(a.g,"Transition","0ms");a.g.classList.remove(xh());a.O();yield wh(0);document.body.removeChild(a.g)}())}
function Bh(a){return fa(function*(){document.body.appendChild(a.g);yield wh(0);me(a.g,"Transition","500ms");zh(a);a.g.classList.add(xh());a.i=x(document,"keydown",b=>{27==b.keyCode&&Ah(a)});yield wh(500)}())}class Ch{constructor(a,b,c){this.s=a;this.u=void 0===b?()=>{}:b;this.O=void 0===c?()=>{}:c;const {ab:d,ha:e}=yh(this,a);this.g=d;this.o=e;this.i=null}};var Dh={ad:["ca"],ae:["ar","en","fa","hi","ur"],af:["ps","fa"],ag:["en"],ai:["en"],al:["sq","en"],am:["hy","ru"],ao:["pt-PT"],ar:["es-419","es"],as:["en"],at:["de"],au:["en"],az:["az","ru"],ba:["bs","hr","sr"],bd:["bn","en"],be:["nl","de","en","fr"],bf:["fr"],bg:["bg"],bh:["ar","en"],bi:["fr"],bj:["fr"],bn:["ms","en","zh-CN"],bo:["es-419","es"],br:["pt-BR","en"],bs:["en"],bt:["en"],bw:["tn","en"],by:["be","ru"],bz:["en","es","es-419"],ca:["en","fr","fr-CA"],cd:["fr","sw"],cf:["fr"],cg:["fr"],ch:["de",
"en","fr","it"],ci:["fr"],ck:["en"],cl:["es-419","es"],cm:["fr","en"],cn:["zh-CN"],co:["es-419","es"],cr:["es-419","en","es"],cu:["es-419","es"],cv:["pt-PT"],cy:["en","el","tr"],cz:["cs"],de:["de","en","fr"],dj:["fr","ar","so"],dk:["da"],dm:["en"],"do":["es-419","es"],dz:["fr","ar"],ec:["es-419","es"],ee:["et","ru"],eg:["ar","en"],es:["es","ca","en","eu","gl"],et:["am","en","so"],fi:["fi","sv"],fj:["en"],fr:["fr"],ga:["fr"],ge:["ka","en"],gg:["en","fr"],gh:["en"],gi:["en","es","it","pt-PT"],gl:["da",
"en"],gm:["en","wo"],gr:["el"],gt:["es-419","es"],gy:["en"],hk:["zh-TW","en","zh-CN","zh-HK"],hn:["es-419","es"],hr:["hr"],ht:["fr","en","ht"],hu:["hu"],id:["id","en","nl"],ie:["en-GB","ga"],il:["iw","ar","en"],im:["en"],"in":"en bn gu hi kn ml mr ne or pa ta te".split(" "),iq:["ar","en"],is:["is","en"],it:["it","en"],je:["en","fr"],jm:["en"],jo:["ar","en"],jp:["ja"],ke:["sw","en"],kg:["ky","ru"],kh:["km","en"],ki:["en"],kr:["ko"],kw:["ar","en"],kz:["kk","ru"],la:["lo","en"],lb:["ar","en","fr","hy"],
lk:["en","si","ta"],ls:["st","en","zu"],lt:["lt"],lu:["de","fr"],lv:["lv","lt","ru"],ly:["ar","en","it"],ma:["fr","ar"],md:["ro","ro-MD","ru"],me:["sr-ME","bs","sr"],mg:["mg","fr"],mk:["mk"],ml:["fr"],mm:["my","en"],mn:["mn"],mt:["mt","en"],mu:["en","fr"],mv:["en"],mw:["ny","en"],mx:["es-419","es"],my:["en","ms"],mz:["pt-PT","ny","sn","sw"],na:["en","af","de"],ne:["fr"],ng:["en"],ni:["es-419","en","es"],nl:["nl","en"],no:["no","nn"],np:["ne","en"],nr:["en"],nu:["en"],nz:["en-GB"],om:["ar","en"],pa:["es-419",
"en","es"],pe:["es-419","es"],pg:["en"],ph:["en"],pk:["en","pa","ur"],pl:["pl"],pn:["en"],pr:["es-419","en","es"],ps:["ar","en"],pt:["pt-PT"],py:["es-419","es"],qa:["ar","en"],ro:["ro","de","hu"],rs:["sr","sr-Latn"],ru:["ru"],rw:["en","fr","sw"],sa:["ar","en"],sb:["en"],sc:["crs","en","fr"],se:["sv"],sg:["en","ms","ta","zh-CN"],si:["sl"],sk:["sk","hu"],sl:["en"],sm:["it"],sn:["fr","wo"],so:["so","ar","en"],sr:["nl","en"],st:["pt-PT"],sv:["es-419","es"],td:["fr","ar"],tg:["fr"],th:["th","en"],tj:["tg",
"ru"],tl:["pt-PT","en","id"],tm:["tk","ru","uz"],tn:["ar","fr"],to:["en"],tr:["tr"],tt:"en es es-419 fr hi zh-TW".split(" "),tw:["zh-TW","en"],tz:["sw","en"],ua:["uk","ru"],ug:["en"],uk:["en-GB"],us:["en","es","es-419","zh-CN"],uy:["es-419","es"],uz:["uz","ru"],vc:["en"],ve:["es-419","es"],vi:["en"],vn:["vi","en","fr","zh-TW"],vu:["en","fr"],ws:["en"],za:["en","af","st","tn","zu"],zm:["en","ny","sn"],zw:["en","ny","sn","tn","zu"]};function Eh(a,b,c,d){const e=`${b}-${c}`;if(d.includes(e))return a.g=b,e;if(b&&d.includes(b))return a.g=b;if(c&&Dh[c])for(const f of Dh[c])if(d.includes(f))return a.g=f,a.g;return d.includes("en")?(a.g="en",a.g):a.g=null}
function O(a,b){if(null==a.i)throw Error("t");a=void 0===a.i[b]?"":a.i[b];let c=b=0,d=!1;const e=a.split(Ta);for(let f=0;f<e.length;f++){const h=e[f];Ra.test(h)?(b++,c++):Sa.test(h)?d=!0:Qa.test(h)?c++:Ua.test(h)&&(d=!0)}b=0==c?d?1:0:.4<b/c?-1:1;return 1==b?"\u202a"+a+"\u202c":-1==b?"\u202b"+a+"\u202c":a}
class Fh{constructor(){this.g=this.i=null}load(a,b,c,d){a=Eh(this,a,b,c);if(null==a)return Promise.resolve();const e=`${d}messages.${a}.nocache.json`,f=new jd;f.Aa="text";return new Promise((h,k)=>{Qc(f,"success",()=>{try{var q=f.g?f.g.responseText:""}catch(n){q=""}this.i=JSON.parse(q.substring(5));h()});Qc(f,"error",k);f.send(e)})}}ka(Fh);function Gh(a){a.i?a.i=!1:(requestAnimationFrame(()=>Gh(a)),Hh(a))}function Hh(a){var b=Date.now(),c=b-a.U;0>c||(c=Math.min(c,50),a.U=b,a.o(c))}var Ih=class extends v{constructor(a){super();this.o=a;this.U=0;this.u=this.i=this.g=!1;this.o=a}start(){this.U=Date.now();const a=!this.i&&!this.g;this.i=!1;this.g=!0;this.u=!1;a&&Gh(this)}pause(){this.g&&(this.u=!0,this.g=!1,this.i=!0)}resume(){this.u&&this.start()}Ea(){this.g&&(this.i=!0,this.g=!1);super.Ea()}};var Jh=a=>0==a.indexOf("//")?"https:"+a:a,Kh=()=>null!=window.agsa_ext&&null!=window.agsa_ext.share;const Lh=(a,b)=>{const c=new Qb;for(let d in b)c.add(d,b[d]);a=new Nb(a);Rb(a,c);return a.toString()};var Mh=a=>{fa(function*(){if(te())return Promise.reject();fh(16);return He(a)}())};class Nh extends zd{}var Ad={};Ad.kc=new Hd;var A={};A.Cc=new Ed(0,6445.7138671875);A.bc=new Ed(7445.7138671875,346.37200927734375);A.Ic=new Ed(8792.0859375,1442.404052734375);A.Jc=new Ed(11234.490234375,365.3970031738281);A.nc=new Ed(12599.88671875,442.697998046875);A.Kc=new Ed(14042.5849609375,436.44000244140625);A.Lc=new Ed(15479.025390625,354.8529968261719);A.Mc=new Ed(16833.87890625,437.73199462890625);ka(Nh);var Oh="af am ar az be bg bn bs ca cs da de el en en-GB es es-419 et eu fa fi fil fr fr-ca gl gu hi hr hu hy id is it iw ja ka kk km kn ko ky lo lt lv mk ml mn mr ms my ne nl no pa pl pt-BR pt-PT ro ru si sk sl sq sr sv sw ta te th tr uk ur uz vi zh-CN zh-HK zh-TW zu".split(" ");class R extends xf{}ka(R);
var yf=[{filename:"rings-sprite.png",size:[2780,503]},{filename:"bg-sprite.jpg",size:[1923,1626]},{filename:"ui-sprite.png",size:[931,537]},{filename:"tiny-dancer-sprite.png",size:[327,73]},{filename:"modeselect-sprite.png",size:[960,780]},{filename:"tutorial-sprite.png",size:[707,791]},{filename:"tutorial-mobile-sprite.png",size:[2517,441]},{filename:"tutorial-desktop-sprite.png",size:[2517,441]},{filename:"level-sprite.png",size:[1565,257]},{filename:"level-one-sprite.png",size:[2264,672]},{filename:"level-two-sprite.png",
size:[2264,672]},{filename:"level-three-sprite.png",size:[2264,672]},{filename:"level-bonus-sprite.png",size:[2264,672]},{filename:"dancer-male-left-begin-sprite.png",size:[742,223]},{filename:"dancer-male-left-win-sprite.png",size:[1110,245]},{filename:"dancer-male-left-lose-sprite.png",size:[209,165]},{filename:"dancer-male-left-trick-sprite.png",size:[2046,651]},{filename:"dancer-male-left-idle-sprite.png",size:[2033,641]},{filename:"dancer-male-right-begin-sprite.png",size:[776,220]},{filename:"dancer-male-right-win-sprite.png",
size:[958,242]},{filename:"dancer-male-right-lose-sprite.png",size:[160,191]},{filename:"dancer-male-right-trick-sprite.png",size:[2043,863]},{filename:"dancer-male-right-idle-sprite.png",size:[1972,623]},{filename:"dancer-female-right-win-sprite.png",size:[892,236]},{filename:"dancer-female-right-lose-sprite.png",size:[211,161]},{filename:"dancer-female-right-trick-sprite.png",size:[2034,913]},{filename:"dancer-female-right-begin-sprite.png",size:[679,217]},{filename:"dancer-female-right-idle-sprite.png",
size:[2024,729]},{filename:"dancer-female-left-win-sprite.png",size:[780,234]},{filename:"dancer-female-left-lose-sprite.png",size:[199,160]},{filename:"dancer-female-left-trick-sprite.png",size:[2038,647]},{filename:"dancer-female-left-begin-sprite.png",size:[675,213]},{filename:"dancer-female-left-idle-sprite.png",size:[2043,618]}],Ph=[1,0,0,960,540],Qh=[12,963,0,960,26],Rh=[12,2207,90,27,540],Sh=[12,2172,0,87,87],Th=[12,861,96,87,87],Uh=[12,2237,90,27,540],Vh=[12,1838,29,67,66],Wh=[12,861,186,
65,66],Xh=[12,0,0,960,93],Yh=[2,383,118,224,49],Zh=[7,1080,0,357,219],$h=[7,1440,0,357,219],ai=[7,1800,0,357,219],bi=[7,2160,0,357,219],ci=[7,0,222,357,219],di=[7,360,222,357,219],ei=[7,720,222,357,219],fi=[7,1080,222,357,219],gi=[7,1440,222,357,219],hi=[7,1800,222,357,219],ii=[6,1080,0,357,219],ji=[6,1440,0,357,219],ki=[6,1800,0,357,219],li=[6,2160,0,357,219],mi=[6,0,222,357,219],ni=[2,865,0,66,67],oi=[2,865,70,66,67],pi=[1,963,0,960,540],qi=[4,0,258,396,411],ri=[4,768,578,115,55],si=[4,768,636,
115,55],ti=[4,868,282,79,108],ui=[4,868,393,79,108],vi=[4,0,0,960,161],wi=[4,524,578,121,81],xi=[4,648,578,117,94],yi=[4,399,578,122,93],zi=[4,524,662,98,81],Ai=[4,0,164,464,91],Bi=[4,467,164,398,411],Ci=[4,868,164,87,56],Di=[4,868,223,87,56],Ei=[4,0,672,78,108],Fi=[4,81,672,78,108],Gi=[8,1440,130,57,56],Hi=[8,1500,130,57,56],Ii=[1,0,543,960,540],Ji=[8,672,130,125,127],Ki=[8,800,130,125,127],Li=[8,928,130,125,127],Mi=[8,0,152,51,56],Ni=[8,54,152,51,56],Oi=[7,360,0,357,219],Pi=[6,360,0,357,219],Qi=
[1,963,543,960,540],Ri=[5,624,529,83,83],Si=[5,624,615,83,83],Ti=[6,360,222,357,219],Ui=[6,720,222,357,219],Vi=[6,1080,222,357,219],Wi=[6,1440,222,357,219],Xi=[6,1800,222,357,219],Yi=[5,426,529,195,126],Zi=[5,426,658,195,124],$i=[9,963,0,960,26],aj=[9,2207,90,27,540],bj=[9,2172,0,87,87],cj=[9,861,96,87,87],dj=[9,2237,90,27,540],ej=[9,1838,29,67,66],fj=[9,861,186,65,66],gj=[9,0,0,960,93],hj=[10,963,0,960,26],ij=[10,2207,90,27,540],jj=[10,2172,0,87,87],kj=[10,861,96,87,87],lj=[10,2237,90,27,540],mj=
[10,1838,29,67,66],nj=[10,861,186,65,66],oj=[10,0,0,960,93],pj=[11,963,0,960,26],qj=[11,2207,90,27,540],rj=[11,2172,0,87,87],sj=[11,861,96,87,87],tj=[11,2237,90,27,540],uj=[11,1838,29,67,66],vj=[11,861,186,65,66],wj=[11,0,0,960,93],xj=[2,830,140,66,67],yj=[2,843,369,66,67],zj=[2,759,369,81,139],Aj=[2,672,332,84,140],Bj=[2,569,332,100,135],Cj=[2,383,0,369,115],Dj=[1,0,1086,960,540],Ej=[9,963,29,380,520],Fj=[10,963,29,380,520],Gj=[11,963,29,380,520],Hj=[12,963,29,380,520],Ij=[2,610,118,217,96],Jj=[2,
383,170,217,96],Kj=[2,603,217,183,112],Lj=[2,383,269,183,112],Mj=[2,383,384,66,67],Nj=[2,452,384,66,67],Oj=[2,843,439,66,67],Pj=[2,383,454,66,67],Qj=[2,755,0,107,73],Rj=[2,789,217,107,73],Sj=[2,789,293,107,73],Tj=[2,452,454,66,67],Uj=[2,521,470,66,67],Vj=[[0,0,0,250,250],[0,253,0,250,250],[0,506,0,250,250],[0,759,0,250,250],[0,1012,0,250,250],[0,1265,0,250,250],[0,1518,0,250,250],[0,1771,0,250,250],[0,2024,0,250,250],[0,2277,0,250,250],[0,2530,0,250,250],[0,0,253,250,250],[0,253,253,250,250],[0,506,
253,250,250],[0,759,253,250,250],[0,1012,253,250,250],[0,1265,253,250,250],[0,1518,253,250,250],[0,1771,253,250,250],[0,2024,253,250,250],[0,2277,253,250,250],[0,2530,253,250,250]];var Wj="true"===(new Nb(document.location.href)).g.get("debug"),Xj=new Map([[0,new I(0,0,0)],[7,new I(0,-8,0)],[8,new I(0,9,0)],[1,F()?new I(-5.5,2.5,0):new I(-3.5,2,0)],[2,F()?new I(-5.5,0,0):new I(-5,0,0)],[3,F()?new I(-5.5,-2.5,0):new I(-6.5,-2,0)],[4,F()?new I(5.5,2.5,0):new I(3.5,2,0)],[5,F()?new I(5.5,0,0):new I(5,0,0)],[6,F()?new I(5.5,-2.5,0):new I(6.5,-2,0)]]),Yj=new Map([[0,new I(0,0,0)],[7,new I(0,-8,0)],[8,new I(0,9,0)],[1,F()?new I(-5.5,1.6,0):new I(-4,1.6,0)],[2,(F(),new I(-5.5,-1.6,
0))],[4,F()?new I(5.5,1.6,0):new I(4,1.6,0)],[5,(F(),new I(5.5,-1.6,0))]]),Zj=new Map([[1,70],[2,68],[3,83],[4,74],[5,75],[6,76]]),ak=new Map([["C2",()=>0],["D2",()=>1],["E2",()=>2],["F2",()=>3],["B2",()=>4],["C3",()=>5],["D3",()=>6],["G2",()=>7],["A2",()=>8]]),bk=new Map([["C2",()=>0],["C#2",()=>1],["D2",()=>2]]),ck=new Map([[1,[8,544,0,125,127]],[2,[8,160,0,125,127]],[3,[8,1056,130,125,127]],[4,[8,928,0,125,127]],[5,[8,1312,0,125,127]],[6,[8,288,130,125,127]]]),dk=new Map([[1,[8,672,0,125,127]],
[2,[8,288,0,125,127]],[3,[8,1184,130,125,127]],[4,[8,1056,0,125,127]],[5,[8,1440,0,125,127]],[6,[8,416,130,125,127]]]),ek=new Map([[1,[8,800,0,125,127]],[2,[8,416,0,125,127]],[3,[8,1312,130,125,127]],[4,[8,1184,0,125,127]],[5,[8,160,130,125,127]],[6,[8,544,130,125,127]]]),fk=new Map([[0,{rb:[17,0,0,2033,641],ub:17,tb:{width:420,height:420,frames:[[[96,198,649,235,159,209,0]],[],[[39,198,897,0,216,209,0]],[[33,184,239,0,219,222,0]],[],[[33,179,897,210,188,227,0]],[],[[32,173,1086,210,180,232,0]],[],
[[32,173,679,0,217,234,0]],[[40,198,1114,0,215,209,0]],[],[],[[88,196,1267,211,167,211,0]],[],[[113,196,202,223,159,210,0]],[],[],[[117,289,1957,0,5,4,0],[145,200,157,434,130,207,0]],[],[[145,200,1595,424,130,208,0]],[],[],[[153,200,505,416,141,208,0]],[],[[177,200,362,416,142,205,0]],[],[],[[172,191,1595,210,147,213,0]],[],[[164,191,1435,211,159,216,0]],[],[[164,198,1541,0,207,209,0]],[[166,203,459,0,219,203,0]],[],[[197,207,1749,0,207,199,0]],[],[[206,206,0,204,201,199,0]],[],[[169,204,0,0,238,
203,0]],[[164,198,1749,200,205,209,0]],[],[],[[164,196,459,204,189,211,0]],[],[[143,196,1330,0,210,210,0]],[],[],[[141,200,0,404,156,207,0]],[],[[141,200,1409,428,130,208,0]],[],[],[[121,200,1891,410,142,208,0]],[],[[97,200,1267,423,141,205,0]],[],[],[[97,191,1743,410,147,213,0]],[]]},kb:[13,0,0,742,223],nb:13,mb:{width:420,height:420,frames:[[[17,241,694,0,10,9,0],[13,255,705,0,10,9,0],[29,231,727,0,7,11,0],[47,191,200,0,170,223,0]],[],[],[[17,241,716,0,10,9,0],[13,255,716,0,10,9,0],[29,231,735,
0,7,11,0],[47,191,371,0,170,223,0]],[],[],[[64,191,542,0,151,223,0]],[],[],[],[[16,191,0,0,199,223,0]],[],[],[]]},Fb:[14,0,0,1110,245],Hb:14,Gb:{width:420,height:420,frames:[[[86,171,732,0,141,245,0]],[],[],[[86,166,874,0,141,151,0]],[],[],[[93,162,1016,0,76,91,0],[209,289,1093,0,17,26,0]],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[[84,162,588,0,143,155,0]],[],[],[],[],[],[[80,189,0,0,146,128,0]],[],[],[[80,206,294,0,146,111,0]],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
[],[[80,206,441,0,146,111,0]],[],[],[[80,189,147,0,146,128,0]],[]]},vb:[15,0,0,209,165],yb:15,wb:{width:420,height:420,frames:[[[105,208,105,0,34,35,0],[102,245,0,0,104,165,0]],[],[],[[105,208,140,0,34,35,0]],[],[],[[103,210,175,0,34,32,0]],[],[],[]]},Bb:[16,0,0,2046,651],Db:16,Cb:{width:420,height:420,frames:[[[96,198,1483,232,159,209,0]],[[39,198,220,0,216,209,0]],[[33,190,0,0,219,216,0]],[],[[33,182,413,219,188,224,0]],[],[],[[33,182,220,210,192,223,0]],[],[[36,198,0,217,189,209,0]],[],[[54,201,
652,0,213,206,0]],[],[[55,190,437,0,214,218,0]],[],[[87,190,1688,0,198,220,0]],[],[],[[139,211,150,434,149,198,0]],[],[[139,201,0,427,149,209,0]],[[125,194,1875,221,167,213,0]],[],[[125,189,1688,221,186,221,0]],[[114,184,652,207,197,226,0]],[],[],[],[],[[109,180,866,0,205,230,0]],[],[],[],[],[],[],[],[],[[109,180,1072,0,205,230,0]],[],[],[],[[110,180,1483,0,204,231,0]],[],[[110,180,1278,0,204,233,0]],[],[],[[130,202,850,231,174,213,0]],[],[[130,205,1887,0,159,210,0]],[],[],[[131,194,1199,234,158,
220,0]],[],[[108,194,1025,231,173,220,0]],[],[[108,195,602,434,143,217,0]],[],[[112,195,1358,234,113,217,0]],[]]}}],[1,{rb:[32,0,0,2043,618],ub:32,tb:{width:420,height:420,frames:[[[109,213,0,206,138,201,0]],[],[[41,211,1083,0,206,203,0]],[[31,190,440,0,214,225,0]],[],[],[[24,189,1497,0,198,226,0]],[],[],[[24,189,870,0,212,224,0]],[[28,209,0,0,219,205,0]],[],[],[[96,207,1290,203,151,207,0]],[],[[125,207,794,225,136,207,0]],[],[],[[125,204,1837,210,136,212,0]],[],[[145,204,1565,227,121,213,0]],[],
[],[[145,214,1083,204,140,203,0]],[],[[179,214,1442,227,122,200,0]],[],[],[[183,206,261,407,121,208,0]],[],[[179,206,655,205,138,208,0]],[],[[179,211,1696,0,193,203,0]],[[181,211,655,0,214,204,0]],[],[],[[208,211,220,202,191,204,0]],[],[],[[193,211,1290,0,206,202,0]],[[179,213,220,0,219,201,0]],[],[],[[179,205,1890,0,153,209,0]],[],[[167,205,931,225,128,209,0]],[],[],[[167,211,535,226,113,205,0]],[],[[163,214,0,408,121,203,0]],[],[],[[144,214,1696,204,140,203,0]],[],[[127,212,412,226,122,202,0]],
[],[],[[125,203,139,407,121,211,0]],[]]},kb:[31,0,0,675,213],nb:31,mb:{width:420,height:420,frames:[[[26,205,370,0,181,212,0]],[],[],[[26,205,0,0,186,213,0]],[],[],[[89,205,552,0,123,213,0]],[],[],[],[[30,205,187,0,182,213,0]],[],[],[]]},Fb:[28,0,0,780,234],Hb:28,Gb:{width:420,height:420,frames:[[[107,186,0,0,109,234,0],[248,235,771,0,4,4,0]],[],[],[[107,184,620,0,69,72,0],[204,301,758,0,12,15,0],[248,235,776,0,4,4,0]],[],[],[[109,180,690,0,67,77,0]],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
[],[],[],[],[],[[108,180,524,0,95,111,0]],[],[],[],[],[],[[105,203,326,0,98,133,0]],[],[],[[105,216,110,0,107,120,0]],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[[105,216,218,0,107,120,0]],[],[],[[105,203,425,0,98,133,0]],[]]},vb:[29,0,0,199,160],yb:29,wb:{width:420,height:420,frames:[[[106,211,111,0,29,31,0],[102,259,0,0,110,160,0]],[],[],[[106,211,141,0,29,31,0]],[],[],[[106,210,171,0,28,32,0]],[],[],[]]},Bb:[30,0,0,2038,647],Db:30,Cb:{width:420,height:420,frames:[[[109,213,1697,236,138,
201,0]],[[41,211,646,0,206,203,0]],[[31,195,217,0,214,220,0]],[],[[24,193,1054,0,198,222,0]],[],[],[[24,193,853,0,200,220,0]],[],[[42,208,840,221,182,204,0]],[],[[59,208,0,0,216,204,0]],[],[[62,199,432,0,213,212,0]],[],[[88,199,1205,233,179,218,0]],[],[],[[151,224,500,428,119,193,0]],[],[[146,199,840,426,126,218,0]],[[132,193,1547,236,149,221,0]],[],[[119,193,0,205,190,223,0]],[[116,187,646,204,193,232,0]],[],[],[],[],[[116,184,1649,0,194,235,0]],[],[],[],[],[],[],[],[],[[116,184,1844,0,194,235,0]],
[],[],[],[[116,187,1253,0,197,232,0]],[],[[116,188,1451,0,197,232,0]],[],[],[[123,206,432,213,182,214,0]],[],[[122,211,191,221,182,209,0]],[],[],[[122,186,1023,223,181,233,0]],[],[[120,186,1385,233,161,233,0]],[],[[120,192,1836,236,130,227,0]],[],[[101,200,374,428,125,219,0]],[]]}}],[2,{rb:[27,0,0,2024,729],ub:27,tb:{width:420,height:420,frames:[[[177,197,365,246,175,223,0]],[],[[177,190,838,0,203,230,0]],[[183,161,1441,0,197,259,0]],[],[[183,148,1042,0,199,272,0]],[],[[184,144,1242,0,198,276,0]],
[],[[184,144,1639,0,193,276,0]],[[177,188,630,228,191,232,0]],[],[],[[177,187,334,470,164,233,0]],[],[[168,187,1441,260,173,233,0]],[],[],[[145,193,1354,494,155,227,0]],[],[[137,194,1510,503,155,226,0]],[],[],[[109,201,168,465,165,219,0]],[],[[85,194,1786,474,164,226,0]],[],[],[[84,194,1183,277,170,226,0]],[],[[68,194,822,231,186,226,0]],[],[[60,197,0,233,183,223,0]],[[30,193,630,0,207,227,0]],[],[[27,188,0,0,210,232,0]],[],[[27,183,211,0,209,237,0]],[],[[28,175,421,0,208,245,0]],[[52,175,1833,0,
191,245,0]],[],[],[[70,187,1009,273,173,233,0]],[],[[70,187,0,457,167,233,0]],[],[],[[86,193,1833,246,174,227,0]],[],[[88,194,184,238,180,226,0]],[],[],[[131,196,822,458,165,224,0]],[],[[155,200,541,461,165,220,0]],[],[],[[151,195,1615,277,170,225,0]],[]]},kb:[26,0,0,679,217],nb:26,mb:{width:420,height:420,frames:[[[13,257,670,0,4,5,0],[211,203,339,0,157,217,0],[369,238,652,0,8,9,0],[377,253,628,0,11,8,0]],[],[],[[13,257,675,0,4,5,0],[207,203,177,0,161,217,0],[369,238,661,0,8,9,0],[377,253,640,0,
11,8,0]],[],[],[[207,203,497,0,130,217,0]],[],[],[],[[209,203,0,0,176,217,0]],[],[],[]]},Fb:[23,0,0,892,236],Hb:23,Gb:{width:420,height:420,frames:[[[207,184,0,0,117,236,0]],[],[],[[206,288,845,0,21,30,0],[246,181,669,0,78,82,0]],[],[],[[206,288,822,0,22,29,0],[247,178,748,0,73,84,0]],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[[189,406,881,0,5,5,0],[216,178,563,0,105,139,0]],[],[],[],[],[],[[189,406,887,0,5,5,0],[214,199,118,0,111,136,0]],[],[],[[214,214,230,0,111,121,0]],[],
[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[[188,406,867,0,6,8,0],[215,214,342,0,110,121,0]],[],[],[[188,406,874,0,6,8,0],[216,199,453,0,109,136,0]],[]]},vb:[24,0,0,211,161],yb:24,wb:{width:420,height:420,frames:[[[297,217,181,0,30,37,0],[214,258,0,0,112,161,0]],[],[],[[296,217,149,0,31,37,0]],[],[],[[295,217,113,0,35,36,0]],[],[],[]]},Bb:[25,0,0,2034,913],Db:25,Cb:{width:420,height:420,frames:[[[192,212,726,548,145,203,0]],[[192,205,981,271,173,210,0]],[[198,176,394,419,167,244,0]],[],[[198,
166,1155,271,163,254,0]],[],[],[[199,166,206,440,162,254,0]],[],[[159,196,1593,224,201,223,0]],[],[[154,196,1795,363,170,223,0]],[],[[154,201,0,449,153,217,0]],[],[[163,206,872,548,103,212,0]],[],[],[[147,220,1905,0,129,198,0]],[],[[147,190,1672,587,129,229,0]],[[160,157,1281,608,97,262,0]],[],[[162,97,1912,587,102,302,0]],[[158,46,1802,587,109,326,0]],[[133,45,1509,448,162,239,0]],[],[[73,40,554,162,235,256,0]],[],[[73,28,0,0,278,187,0],[105,234,790,182,216,77,0]],[],[],[[81,16,1102,0,270,178,0],
[103,225,1373,174,219,89,0]],[],[],[[81,8,1373,0,270,173,0],[101,225,279,173,221,93,0]],[],[],[[78,8,279,0,274,172,0],[101,231,1102,179,217,91,0]],[],[[78,22,554,0,274,161,0],[112,243,1795,224,201,79,0]],[],[[79,22,829,0,272,181,0],[115,257,1795,304,173,58,0]],[],[[84,35,1644,0,260,223,0],[257,274,501,173,25,25,0]],[],[[93,58,0,188,205,260,0]],[[110,77,1320,264,188,343,0]],[],[[105,133,790,260,190,287,0]],[],[],[[105,247,206,267,187,172,0]],[],[[151,226,1131,526,149,192,0]],[],[[151,207,981,482,149,
209,0]],[],[[151,206,562,419,163,210,0]],[]]}}],[3,{rb:[22,0,0,1972,623],ub:22,tb:{width:420,height:420,frames:[[[199,208,1077,404,145,198,0]],[],[[199,184,1629,0,159,222,0]],[[205,159,772,195,153,248,0]],[],[],[[205,158,544,219,149,249,0]],[],[],[[207,158,1789,0,156,249,0]],[[199,179,1300,0,164,227,0]],[],[],[[197,206,1768,250,145,200,0]],[],[[169,206,1134,201,153,202,0]],[],[],[[139,214,772,0,183,194,0]],[],[[135,209,1465,0,163,199,0]],[],[],[[113,207,392,213,151,202,0]],[],[[99,207,1436,412,143,
204,0]],[],[],[[86,199,926,218,150,212,0]],[],[[85,199,1288,228,147,207,0]],[],[[28,196,0,0,197,210,0]],[[27,195,392,0,190,212,0]],[],[],[[27,189,198,0,193,218,0]],[],[],[[32,189,583,0,188,218,0]],[[48,189,956,0,177,217,0]],[],[],[[75,202,153,219,150,204,0]],[],[[94,202,0,211,152,206,0]],[],[],[[111,208,1134,0,165,200,0]],[],[[140,206,0,418,140,202,0]],[],[],[[154,206,1619,223,148,203,0]],[],[[173,204,304,416,142,207,0]],[],[],[[178,201,1465,200,153,211,0]],[[305,298,1946,0,26,25,0]]]},kb:[18,0,0,
776,220],nb:18,mb:{width:420,height:420,frames:[[[204,192,209,0,167,220,0],[377,224,699,0,38,47,0]],[],[],[[204,192,377,0,167,220,0],[377,224,738,0,38,47,0]],[],[],[[204,192,545,0,153,220,0]],[],[],[],[[204,192,0,0,208,220,0]],[],[],[]]},Fb:[19,0,0,958,242],Hb:19,Gb:{width:420,height:420,frames:[[[202,173,284,0,138,242,0]],[],[],[[258,167,799,0,82,87,0]],[],[],[[258,164,882,0,76,90,0]],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[[219,164,423,0,125,126,0]],[],[],[],[],[],[[208,
191,0,0,141,120,0]],[],[],[[225,207,549,0,124,110,0]],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[[225,207,674,0,124,110,0]],[],[],[[208,191,142,0,141,120,0]],[]]},vb:[20,0,0,160,191],yb:20,wb:{width:420,height:420,frames:[[[229,218,0,0,95,191,0]],[],[],[[292,218,129,0,31,33,0]],[],[],[[296,218,96,0,32,33,0]],[],[],[]]},Bb:[21,0,0,2043,863],Db:21,Cb:{width:420,height:420,frames:[[[199,208,1731,419,137,198,0]],[[199,208,1226,214,189,198,0]],[[205,166,478,254,183,241,0]],[],[[205,166,988,413,
152,241,0]],[],[],[[202,166,188,407,155,241,0]],[],[[164,198,696,186,190,208,0]],[],[[161,198,662,395,169,209,0]],[],[[161,205,1141,413,148,205,0]],[],[[151,207,1290,413,123,203,0]],[],[],[[150,222,0,546,127,188,0]],[],[[150,185,478,496,127,225,0]],[[160,158,832,598,95,252,0]],[],[[160,103,1869,577,105,286,0]],[[149,35,344,407,133,266,0]],[[130,35,1416,405,165,244,0]],[],[[90,41,259,151,218,255,0]],[],[[90,28,774,0,249,185,0],[105,234,0,165,216,77,0]],[],[],[[96,16,1024,0,243,169,0],[103,225,1746,
94,219,89,0]],[],[],[[96,8,1507,0,238,164,0],[101,225,1746,0,221,93,0]],[],[],[[89,8,518,0,255,161,0],[101,231,478,162,217,91,0]],[],[[86,27,259,0,258,150,0],[112,243,1024,170,201,79,0]],[],[[86,32,0,0,258,164,0],[115,257,1709,360,173,58,0]],[],[[94,36,1268,0,238,213,0],[257,274,1968,0,25,25,0]],[],[[102,70,1507,165,201,239,0]],[[121,110,0,243,187,302,0]],[],[[116,237,1709,184,192,175,0]],[],[],[[116,249,887,250,186,162,0]],[],[[150,225,832,413,155,184,0]],[],[[158,207,1582,419,148,200,0]],[],[[158,
190,1883,360,160,216,0]],[]]}}]]),gk=[101,103,105,107];function hk(a){const b=document.createElement("script");if(a instanceof Xd){var c;if(null===(c=Ud())||void 0===c||!c.isScript(a))if(a instanceof Yd)a=a.i;else throw Error("n");}else a instanceof Pa&&a.constructor===Pa?a=a.g:(la(a),a="type_error:SafeScript");b.textContent=a;ce(b);document.head.appendChild(b)};const ik=['/**\n * @license\n * MIT License\n *\n * Copyright (c) 2014-2020 Yotam Mann\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Tone=e():t.Tone=e()}("undefined"!=typeof self?self:this,(function(){return function(t){var e={};function s(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=9)}([function(t,e,s){!function(t,e,s,n){"use strict";function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=i(e),r=i(s),a=i(n),c=function(t,e,s){return{endTime:e,insertTime:s,type:"exponentialRampToValue",value:t}},h=function(t,e,s){return{endTime:e,insertTime:s,type:"linearRampToValue",value:t}},u=function(t,e){return{startTime:e,type:"setValue",value:t}},l=function(t,e,s){return{duration:s,startTime:e,type:"setValueCurve",values:t}},p=function(t,e,s){var n=s.startTime,i=s.target,o=s.timeConstant;return i+(e-i)*Math.exp((n-t)/o)},d=function(t){return"exponentialRampToValue"===t.type},f=function(t){return"linearRampToValue"===t.type},_=function(t){return d(t)||f(t)},m=function(t){return"setValue"===t.type},g=function(t){return"setValueCurve"===t.type},v=function t(e,s,n,i){var o=e[s];return void 0===o?i:_(o)||m(o)?o.value:g(o)?o.values[o.values.length-1]:p(n,t(e,s-1,o.startTime,i),o)},y=function(t,e,s,n,i){return void 0===s?[n.insertTime,i]:_(s)?[s.endTime,s.value]:m(s)?[s.startTime,s.value]:g(s)?[s.startTime+s.duration,s.values[s.values.length-1]]:[s.startTime,v(t,e-1,s.startTime,i)]},x=function(t){return"cancelAndHold"===t.type},w=function(t){return"cancelScheduledValues"===t.type},b=function(t){return x(t)||w(t)?t.cancelTime:d(t)||f(t)?t.endTime:t.startTime},T=function(t,e,s,n){var i=n.endTime,o=n.value;return s===o?o:0<s&&0<o||s<0&&o<0?s*Math.pow(o/s,(t-e)/(i-e)):0},S=function(t,e,s,n){return s+(t-e)/(n.endTime-e)*(n.value-s)},k=function(t,e){var s=e.duration,n=e.startTime,i=e.values;return function(t,e){var s=Math.floor(e),n=Math.ceil(e);return s===n?t[s]:(1-(e-s))*t[s]+(1-(n-e))*t[n]}(i,(t-n)/s*(i.length-1))},C=function(t){return"setTarget"===t.type},A=function(){function t(e){r.default(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return a.default(t,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=b(t);if(x(t)||w(t)){var s=this._automationEvents.findIndex((function(s){return w(t)&&g(s)?s.startTime+s.duration>=e:b(s)>=e})),n=this._automationEvents[s];if(-1!==s&&(this._automationEvents=this._automationEvents.slice(0,s)),x(t)){var i=this._automationEvents[this._automationEvents.length-1];if(void 0!==n&&_(n)){if(C(i))throw new Error("The internal list is malformed.");var o=g(i)?i.startTime+i.duration:b(i),r=g(i)?i.values[i.values.length-1]:i.value,a=d(n)?T(e,o,r,n):S(e,o,r,n),p=d(n)?c(a,e,this._currenTime):h(a,e,this._currenTime);this._automationEvents.push(p)}void 0!==i&&C(i)&&this._automationEvents.push(u(this.getValue(e),e)),void 0!==i&&g(i)&&i.startTime+i.duration>e&&(this._automationEvents[this._automationEvents.length-1]=l(new Float32Array([6,7]),i.startTime,e-i.startTime))}}else{var m=this._automationEvents.findIndex((function(t){return b(t)>e})),v=-1===m?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[m-1];if(void 0!==v&&g(v)&&b(v)+v.duration>e)return!1;var y=d(t)?c(t.value,t.endTime,this._currenTime):f(t)?h(t.value,e,this._currenTime):t;if(-1===m)this._automationEvents.push(y);else{if(g(t)&&e+t.duration>b(this._automationEvents[m]))return!1;this._automationEvents.splice(m,0,y)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return b(e)>t}));if(e>1){var s=this._automationEvents.slice(e-1),n=s[0];C(n)&&s.unshift(u(v(this._automationEvents,e-2,n.startTime,this._defaultValue),n.startTime)),this._automationEvents=s}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents[this._automationEvents.length-1],s=this._automationEvents.findIndex((function(e){return b(e)>t})),n=this._automationEvents[s],i=b(e)<=t?e:this._automationEvents[s-1];if(void 0!==i&&C(i)&&(void 0===n||!_(n)||n.insertTime>t))return p(t,v(this._automationEvents,s-2,i.startTime,this._defaultValue),i);if(void 0!==i&&m(i)&&(void 0===n||!_(n)))return i.value;if(void 0!==i&&g(i)&&(void 0===n||!_(n)||i.startTime+i.duration>t))return t<i.startTime+i.duration?k(t,i):i.values[i.values.length-1];if(void 0!==i&&_(i)&&(void 0===n||!_(n)))return i.value;if(void 0!==n&&d(n)){var r=y(this._automationEvents,s-1,i,n,this._defaultValue),a=o.default(r,2),c=a[0],h=a[1];return T(t,c,h,n)}if(void 0!==n&&f(n)){var u=y(this._automationEvents,s-1,i,n,this._defaultValue),l=o.default(u,2),x=l[0],w=l[1];return S(t,x,w,n)}return this._defaultValue}}]),t}();t.AutomationEventList=A,t.createCancelAndHoldAutomationEvent=function(t){return{cancelTime:t,type:"cancelAndHold"}},t.createCancelScheduledValuesAutomationEvent=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},t.createExponentialRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},t.createLinearRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},t.createSetTargetAutomationEvent=function(t,e,s){return{startTime:e,target:t,timeConstant:s,type:"setTarget"}},t.createSetValueAutomationEvent=u,t.createSetValueCurveAutomationEvent=l,Object.defineProperty(t,"__esModule",{value:!0})}(e,s(1),s(7),s(8))},function(t,e,s){var n=s(2),i=s(3),o=s(4),r=s(6);t.exports=function(t,e){return n(t)||i(t,e)||o(t,e)||r()}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var s=[],n=!0,i=!1,o=void 0;try{for(var r,a=t[Symbol.iterator]();!(n=(r=a.next()).done)&&(s.push(r.value),!e||s.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return s}}},function(t,e,s){var n=s(5);t.exports=function(t,e){if(t){if("string"==typeof t)return n(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?n(t,e):void 0}}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,n=new Array(e);s<e;s++)n[s]=t[s];return n}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function s(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}},function(t,e,s){"use strict";s.r(e),s.d(e,"getContext",(function(){return Qi})),s.d(e,"setContext",(function(){return Zi})),s.d(e,"Clock",(function(){return Ao})),s.d(e,"Context",(function(){return Pi})),s.d(e,"BaseContext",(function(){return Ni})),s.d(e,"Delay",(function(){return Do})),s.d(e,"Gain",(function(){return yo})),s.d(e,"Offline",(function(){return Oo})),s.d(e,"OfflineContext",(function(){return Wi})),s.d(e,"Param",(function(){return fo})),s.d(e,"ToneAudioBuffer",(function(){return Bi})),s.d(e,"ToneAudioBuffers",(function(){return Mo})),s.d(e,"ToneAudioNode",(function(){return _o})),s.d(e,"connectSeries",(function(){return mo})),s.d(e,"connect",(function(){return go})),s.d(e,"disconnect",(function(){return vo})),s.d(e,"FrequencyClass",(function(){return oo})),s.d(e,"Frequency",(function(){return co})),s.d(e,"MidiClass",(function(){return Eo})),s.d(e,"Midi",(function(){return Ro})),s.d(e,"TimeClass",(function(){return no})),s.d(e,"Time",(function(){return io})),s.d(e,"TicksClass",(function(){return qo})),s.d(e,"Ticks",(function(){return Fo})),s.d(e,"TransportTimeClass",(function(){return ho})),s.d(e,"TransportTime",(function(){return uo})),s.d(e,"Emitter",(function(){return Vi})),s.d(e,"IntervalTimeline",(function(){return Vo})),s.d(e,"StateTimeline",(function(){return po})),s.d(e,"Timeline",(function(){return Ei})),s.d(e,"isUndef",(function(){return ei})),s.d(e,"isDefined",(function(){return si})),s.d(e,"isFunction",(function(){return ni})),s.d(e,"isNumber",(function(){return ii})),s.d(e,"isObject",(function(){return oi})),s.d(e,"isBoolean",(function(){return ri})),s.d(e,"isArray",(function(){return ai})),s.d(e,"isString",(function(){return ci})),s.d(e,"isNote",(function(){return hi})),s.d(e,"dbToGain",(function(){return Yi})),s.d(e,"gainToDb",(function(){return Hi})),s.d(e,"intervalToFrequencyRatio",(function(){return $i})),s.d(e,"ftom",(function(){return Ki})),s.d(e,"mtof",(function(){return eo})),s.d(e,"optionsFromArguments",(function(){return bi})),s.d(e,"defaultArg",(function(){return Ti})),s.d(e,"Unit",(function(){return i})),s.d(e,"debug",(function(){return n})),s.d(e,"Noise",(function(){return Qo})),s.d(e,"UserMedia",(function(){return Yo})),s.d(e,"Oscillator",(function(){return Jo})),s.d(e,"AMOscillator",(function(){return nr})),s.d(e,"FMOscillator",(function(){return ir})),s.d(e,"PulseOscillator",(function(){return or})),s.d(e,"FatOscillator",(function(){return rr})),s.d(e,"PWMOscillator",(function(){return ar})),s.d(e,"OmniOscillator",(function(){return hr})),s.d(e,"ToneOscillatorNode",(function(){return $o})),s.d(e,"LFO",(function(){return dr})),s.d(e,"ToneBufferSource",(function(){return Go})),s.d(e,"Player",(function(){return mr})),s.d(e,"Players",(function(){return gr})),s.d(e,"GrainPlayer",(function(){return vr})),s.d(e,"Add",(function(){return ur})),s.d(e,"Abs",(function(){return yr})),s.d(e,"AudioToGain",(function(){return er})),s.d(e,"GainToAudio",(function(){return xr})),s.d(e,"GreaterThan",(function(){return Sr})),s.d(e,"GreaterThanZero",(function(){return Tr})),s.d(e,"Multiply",(function(){return sr})),s.d(e,"Negate",(function(){return wr})),s.d(e,"Pow",(function(){return kr})),s.d(e,"Signal",(function(){return bo})),s.d(e,"connectSignal",(function(){return To})),s.d(e,"Scale",(function(){return lr})),s.d(e,"ScaleExp",(function(){return Cr})),s.d(e,"Subtract",(function(){return br})),s.d(e,"SyncedSignal",(function(){return Ar})),s.d(e,"WaveShaper",(function(){return tr})),s.d(e,"Zero",(function(){return pr})),s.d(e,"AMSynth",(function(){return Ir})),s.d(e,"DuoSynth",(function(){return Lr})),s.d(e,"FMSynth",(function(){return zr})),s.d(e,"MetalSynth",(function(){return Wr})),s.d(e,"MembraneSynth",(function(){return Ur})),s.d(e,"MonoSynth",(function(){return jr})),s.d(e,"NoiseSynth",(function(){return Gr})),s.d(e,"PluckSynth",(function(){return Kr})),s.d(e,"PolySynth",(function(){return ta})),s.d(e,"Sampler",(function(){return ea})),s.d(e,"Synth",(function(){return qr})),s.d(e,"Loop",(function(){return na})),s.d(e,"Part",(function(){return ia})),s.d(e,"Pattern",(function(){return fa})),s.d(e,"Sequence",(function(){return _a})),s.d(e,"ToneEvent",(function(){return sa})),s.d(e,"AutoFilter",(function(){return ya})),s.d(e,"AutoPanner",(function(){return wa})),s.d(e,"AutoWah",(function(){return Ta})),s.d(e,"BitCrusher",(function(){return Sa})),s.d(e,"Chebyshev",(function(){return Ca})),s.d(e,"Chorus",(function(){return Ea})),s.d(e,"Distortion",(function(){return Ra})),s.d(e,"FeedbackDelay",(function(){return Fa})),s.d(e,"FrequencyShifter",(function(){return Va})),s.d(e,"Freeverb",(function(){return ja})),s.d(e,"JCReverb",(function(){return Wa})),s.d(e,"PingPongDelay",(function(){return Ga})),s.d(e,"PitchShift",(function(){return Qa})),s.d(e,"Phaser",(function(){return Za})),s.d(e,"Reverb",(function(){return Xa})),s.d(e,"StereoWidener",(function(){return Ja})),s.d(e,"Tremolo",(function(){return Ka})),s.d(e,"Vibrato",(function(){return tc})),s.d(e,"Analyser",(function(){return ec})),s.d(e,"Meter",(function(){return nc})),s.d(e,"FFT",(function(){return ic})),s.d(e,"DCMeter",(function(){return oc})),s.d(e,"Waveform",(function(){return rc})),s.d(e,"Follower",(function(){return ba})),s.d(e,"Channel",(function(){return hc})),s.d(e,"CrossFade",(function(){return ma})),s.d(e,"Merge",(function(){return Da})),s.d(e,"MidSideMerge",(function(){return Ha})),s.d(e,"MidSideSplit",(function(){return Ya})),s.d(e,"MultibandSplit",(function(){return uc})),s.d(e,"Panner",(function(){return xa})),s.d(e,"Panner3D",(function(){return pc})),s.d(e,"PanVol",(function(){return cc})),s.d(e,"Recorder",(function(){return dc})),s.d(e,"Solo",(function(){return ac})),s.d(e,"Split",(function(){return Aa})),s.d(e,"Volume",(function(){return Po})),s.d(e,"Compressor",(function(){return fc})),s.d(e,"Gate",(function(){return _c})),s.d(e,"Limiter",(function(){return mc})),s.d(e,"MidSideCompressor",(function(){return gc})),s.d(e,"MultibandCompressor",(function(){return vc})),s.d(e,"AmplitudeEnvelope",(function(){return Rr})),s.d(e,"Envelope",(function(){return Dr})),s.d(e,"FrequencyEnvelope",(function(){return Pr})),s.d(e,"EQ3",(function(){return yc})),s.d(e,"Filter",(function(){return Nr})),s.d(e,"OnePoleFilter",(function(){return $r})),s.d(e,"FeedbackCombFilter",(function(){return Hr})),s.d(e,"LowpassCombFilter",(function(){return Jr})),s.d(e,"Convolver",(function(){return xc})),s.d(e,"BiquadFilter",(function(){return Vr})),s.d(e,"version",(function(){return o})),s.d(e,"start",(function(){return Xi})),s.d(e,"supported",(function(){return Zn})),s.d(e,"now",(function(){return wc})),s.d(e,"immediate",(function(){return bc})),s.d(e,"Transport",(function(){return Tc})),s.d(e,"getTransport",(function(){return Sc})),s.d(e,"Destination",(function(){return kc})),s.d(e,"Master",(function(){return Cc})),s.d(e,"getDestination",(function(){return Ac})),s.d(e,"Listener",(function(){return Dc})),s.d(e,"getListener",(function(){return Oc})),s.d(e,"Draw",(function(){return Mc})),s.d(e,"getDraw",(function(){return Ec})),s.d(e,"context",(function(){return Rc})),s.d(e,"loaded",(function(){return qc})),s.d(e,"Buffer",(function(){return Fc})),s.d(e,"Buffers",(function(){return Ic})),s.d(e,"BufferSource",(function(){return Vc}));var n={};s.r(n),s.d(n,"assert",(function(){return Xn})),s.d(n,"assertRange",(function(){return Yn})),s.d(n,"assertContextRunning",(function(){return Hn})),s.d(n,"setLogger",(function(){return Jn})),s.d(n,"log",(function(){return Kn})),s.d(n,"warn",(function(){return ti}));var i={};s.r(i);const o="14.7.58";var r=s(0);const a=new WeakSet,c=new WeakMap,h=new WeakMap,u=new WeakMap,l=new WeakMap,p=new WeakMap,d=new WeakMap,f=new WeakMap,_=new WeakMap,m=new WeakMap,g={construct:()=>g},v=/^import(?:(?:[\\s]+[\\w]+|(?:[\\s]+[\\w]+[\\s]*,)?[\\s]*\\{[\\s]*[\\w]+(?:[\\s]+as[\\s]+[\\w]+)?(?:[\\s]*,[\\s]*[\\w]+(?:[\\s]+as[\\s]+[\\w]+)?)*[\\s]*}|(?:[\\s]+[\\w]+[\\s]*,)?[\\s]*\\*[\\s]+as[\\s]+[\\w]+)[\\s]+from)?(?:[\\s]*)("([^"\\\\]|\\\\.)+"|\'([^\'\\\\]|\\\\.)+\')(?:[\\s]*);?/,y=(t,e)=>{const s=[];let n=t.replace(/^[\\s]+/,""),i=n.match(v);for(;null!==i;){const t=i[1].slice(1,-1),o=i[0].replace(/([\\s]+)?;?$/,"").replace(t,new URL(t,e).toString());s.push(o),n=n.slice(i[0].length).replace(/^[\\s]+/,""),i=n.match(v)}return[s.join(";"),n]},x=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},w=t=>{if(!(t=>{try{new new Proxy(t,g)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},b={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},T=(t,e)=>t.context===e,S=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},k=()=>new DOMException("","IndexSizeError"),C=t=>{var e;t.getChannelData=(e=t.getChannelData,s=>{try{return e.call(t,s)}catch(t){if(12===t.code)throw k();throw t}})},A={numberOfChannels:1},D=-34028234663852886e22,O=-D,M=t=>a.has(t),E=(t,e)=>{const s=t.get(e);if(void 0===s)throw new Error("A value with the given key could not be found.");return s},R=t=>E(d,t),q=t=>{if(a.has(t))throw new Error("The AudioNode is already stored.");a.add(t),R(t).forEach(t=>t(!0))},F=t=>{if(!a.has(t))throw new Error("The AudioNode is not stored.");a.delete(t),R(t).forEach(t=>t(!1))},I={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},V=t=>"port"in t,N=t=>E(c,t),P=t=>E(u,t),j=(t,e)=>{const{activeInputs:s}=N(t);s.forEach(s=>s.forEach(([s])=>{e.includes(t)||j(s,[...e,t])}));const n=(t=>"playbackRate"in t)(t)?[t.playbackRate]:V(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of n){const s=P(t);void 0!==s&&s.activeInputs.forEach(([t])=>j(t,e))}M(t)&&F(t)},L=t=>{j(t.destination,[])},z=t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t),B=t=>"context"in t,W=t=>B(t[0]),U=t=>"inputs"in t,G=(t,e,s,n)=>{if(U(e)){const i=e.inputs[n];return t.connect(i,s,0),[i,s,0]}return t.connect(e,s,n),[e,s,n]},Q=(t,e)=>{if(!R(t).delete(e))throw new Error("Missing the expected event listener.")},Z=(t,e,s,n)=>{U(e)?t.disconnect(e.inputs[n],s,0):t.disconnect(e,s,n)},X=t=>E(h,t),Y=t=>E(l,t),H=(t,e,s,n)=>{for(const e of t)if(s(e)){if(n)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},$=t=>f.has(t),J=t=>!a.has(t),K=(t,e)=>{const s=Array.from(t).filter(e);if(s.length>1)throw Error("More than one element was found.");if(0===s.length)throw Error("No element was found.");const[n]=s;return t.delete(n),n},tt=(t,e)=>{!V(t)&&e.every(t=>0===t.size)&&F(t)},et=t=>new Promise(e=>{const s=t.createScriptProcessor(256,1,1),n=t.createGain(),i=t.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;const r=t.createBufferSource();r.buffer=i,r.loop=!0,r.connect(s).connect(t.destination),r.connect(n),r.disconnect(n),s.onaudioprocess=n=>{const i=n.inputBuffer.getChannelData(0);Array.prototype.some.call(i,t=>1===t)?e(!0):e(!1),r.stop(),s.onaudioprocess=null,r.disconnect(s),s.disconnect(t.destination)},r.start()}),st=(t,e)=>{const s=new Map;for(const e of t)for(const t of e){const e=s.get(t);s.set(t,void 0===e?1:e+1)}s.forEach((t,s)=>e(s,t))},nt=t=>"context"in t,it=(t,e,[s,n,i],o)=>{H(t[n],[e,s,i],t=>t[0]===e&&t[1]===s,o)},ot=(t,e,[s,n],i)=>{H(t,[e,s,n],t=>t[0]===e&&t[1]===s,i)},rt=(t,e,[s,n,i],o)=>{const r=t.get(s);void 0===r?t.set(s,new Set([[n,e,i]])):H(r,[n,e,i],t=>t[0]===n&&t[1]===e,o)},at=(t,[e,s,n],i)=>{const o=t.get(e);void 0===o?t.set(e,new Set([[s,n]])):H(o,[s,n],t=>t[0]===s,i)},ct=(t,e,s,n)=>{const i=E(t,e),o=K(i,t=>t[0]===s&&t[1]===n);return 0===i.size&&t.delete(e),o},ht=(t,e,s)=>{const n=E(t,e),i=K(n,t=>t[0]===s);return 0===n.size&&t.delete(e),i},ut=(t,e,s,n,i)=>{const{activeInputs:o,passiveInputs:r}=N(e),{outputs:a}=N(t),c=R(t),h=a=>{const c=X(e),h=X(t);if(a){const a=ct(r,t,s,n);it(o,t,a,!1),i||$(t)||G(h,c,s,n),J(e)&&q(e)}else{const a=((t,e,s,n)=>K(t[n],t=>t[0]===e&&t[1]===s))(o,t,s,n);rt(r,n,a,!1),i||$(t)||Z(h,c,s,n),M(e)&&tt(e,o)}};return!!H(a,[e,s,n],t=>t[0]===e&&t[1]===s&&t[2]===n,!0)&&(c.add(h),M(t)?it(o,t,[s,n,h],!0):rt(r,n,[t,s,h],!0),!0)},lt=(t,e,s,n)=>{const{activeInputs:i,passiveInputs:o}=P(e),{outputs:r}=N(t),a=R(t),c=r=>{const a=X(t),c=Y(e);if(r){const e=ht(o,t,s);ot(i,t,e,!1),n||$(t)||a.connect(c,s)}else{const e=((t,e,s)=>K(t,t=>t[0]===e&&t[1]===s))(i,t,s);at(o,e,!1),n||$(t)||a.disconnect(c,s)}};return!!H(r,[e,s],t=>t[0]===e&&t[1]===s,!0)&&(a.add(c),M(t)?ot(i,t,[s,c],!0):at(o,[t,s,c],!0),!0)},pt=(t,e,s)=>{for(const n of t)if(n[0]===e&&n[1]===s)return t.delete(n),n;return null},dt=(t,e,s,n,i)=>{const[o,r]=((t,e,s,n)=>{const{activeInputs:i,passiveInputs:o}=N(e),r=pt(i[n],t,s);if(null===r){return[ct(o,t,s,n)[2],!1]}return[r[2],!0]})(t,s,n,i);if(null!==o&&(Q(t,o),!r||e||$(t)||Z(X(t),X(s),n,i)),M(s)){const{activeInputs:t}=N(s);tt(s,t)}},ft=(t,e,s,n)=>{const[i,o]=((t,e,s)=>{const{activeInputs:n,passiveInputs:i}=P(e),o=pt(n,t,s);if(null===o){return[ht(i,t,s)[1],!1]}return[o[2],!0]})(t,s,n);null!==i&&(Q(t,i),!o||e||$(t)||X(t).disconnect(Y(s),n))};class _t{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach((s,n)=>t.call(e,s,n,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const mt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function gt(t,e,s,n,i){if("function"==typeof t.copyFromChannel)0===e[s].byteLength&&(e[s]=new Float32Array(128)),t.copyFromChannel(e[s],n,i);else{const o=t.getChannelData(n);if(0===e[s].byteLength)e[s]=o.slice(i,i+128);else{const t=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[s].set(t)}}}const vt=(t,e,s,n,i)=>{"function"==typeof t.copyToChannel?0!==e[s].byteLength&&t.copyToChannel(e[s],n,i):0!==e[s].byteLength&&t.getChannelData(n).set(e[s],i)},yt=(t,e)=>{const s=[];for(let n=0;n<t;n+=1){const t=[],i="number"==typeof e?e:e[n];for(let e=0;e<i;e+=1)t.push(new Float32Array(128));s.push(t)}return s},xt=async(t,e,s,n,i,o,r)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,c=n.channelCount*n.numberOfInputs,h=i.reduce((t,e)=>t+e,0),u=0===h?null:s.createBuffer(h,a,s.sampleRate);if(void 0===o)throw new Error("Missing the processor constructor.");const l=N(t),p=await((t,e)=>{const s=E(m,t),n=X(e);return E(s,n)})(s,t),d=yt(n.numberOfInputs,n.channelCount),f=yt(n.numberOfOutputs,i),_=Array.from(t.parameters.keys()).reduce((t,e)=>({...t,[e]:new Float32Array(128)}),{});for(let h=0;h<a;h+=128){if(n.numberOfInputs>0&&null!==e)for(let t=0;t<n.numberOfInputs;t+=1)for(let s=0;s<n.channelCount;s+=1)gt(e,d[t],s,s,h);void 0!==o.parameterDescriptors&&null!==e&&o.parameterDescriptors.forEach(({name:t},s)=>{gt(e,_,t,c+s,h)});for(let t=0;t<n.numberOfInputs;t+=1)for(let e=0;e<i[t];e+=1)0===f[t][e].byteLength&&(f[t][e]=new Float32Array(128));try{const t=d.map((t,e)=>0===l.activeInputs[e].size?[]:t),e=r(h/s.sampleRate,s.sampleRate,()=>p.process(t,f,_));if(null!==u)for(let t=0,e=0;t<n.numberOfOutputs;t+=1){for(let s=0;s<i[t];s+=1)vt(u,f[t],s,e+s,h);e+=i[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return u},wt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},bt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Tt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},St={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},kt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Ct={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},At=(t,e,s)=>{const n=e[s];if(void 0===n)throw t();return n},Dt={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Ot={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Mt=()=>new DOMException("","InvalidStateError"),Et=()=>new DOMException("","InvalidAccessError"),Rt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},qt=(t,e,s,n,i,o,r,a,c,h,u)=>{const l=h.length;let p=a;for(let a=0;a<l;a+=1){let l=s[0]*h[a];for(let e=1;e<i;e+=1){const n=p-e&c-1;l+=s[e]*o[n],l-=t[e]*r[n]}for(let t=i;t<n;t+=1)l+=s[t]*o[p-t&c-1];for(let s=i;s<e;s+=1)l-=t[s]*r[p-s&c-1];o[p]=h[a],r[p]=l,p=p+1&c-1,u[a]=l}return p},Ft={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},It=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const s=t.decodeAudioData(e.buffer,()=>{});return void 0!==s&&(s.catch(()=>{}),!0)}catch{}return!1},Vt={numberOfChannels:1},Nt=(t,e,s)=>{const n=e[s];void 0!==n&&n!==t[s]&&(t[s]=n)},Pt=(t,e)=>{Nt(t,e,"channelCount"),Nt(t,e,"channelCountMode"),Nt(t,e,"channelInterpretation")},jt=t=>"function"==typeof t.getFloatTimeDomainData,Lt=(t,e,s)=>{const n=e[s];void 0!==n&&n!==t[s].value&&(t[s].value=n)},zt=t=>{var e;t.start=(e=t.start,(s=0,n=0,i)=>{if("number"==typeof i&&i<0||n<0||s<0)throw new RangeError("The parameters can\'t be negative.");e.call(t,s,n,i)})},Bt=t=>{var e;t.stop=(e=t.stop,(s=0)=>{if(s<0)throw new RangeError("The parameter can\'t be negative.");e.call(t,s)})},Wt=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),Ut=async(t,e)=>new t(await(t=>new Promise((e,s)=>{const{port1:n,port2:i}=new MessageChannel;n.onmessage=({data:t})=>{n.close(),i.close(),e(t)},n.onmessageerror=({data:t})=>{n.close(),i.close(),s(t)},i.postMessage(t)}))(e)),Gt=(t,e)=>{const s=t.createBiquadFilter();return Pt(s,e),Lt(s,e,"Q"),Lt(s,e,"detune"),Lt(s,e,"frequency"),Lt(s,e,"gain"),Nt(s,e,"type"),s},Qt=(t,e)=>{const s=t.createChannelSplitter(e.numberOfOutputs);return Pt(s,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Mt()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw Mt()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw Mt()}})})(s),s},Zt=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Xt=(t,e)=>{const s=t.createDelay(e.maxDelayTime);return Pt(s,e),Lt(s,e,"delayTime"),s},Yt=(t,e)=>{const s=t.createGain();return Pt(s,e),Lt(s,e,"gain"),s};function Ht(t,e){const s=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/s,(t[1]*e[0]-t[0]*e[1])/s]}function $t(t,e){let s=[0,0];for(let o=t.length-1;o>=0;o-=1)i=e,s=[(n=s)[0]*i[0]-n[1]*i[1],n[0]*i[1]+n[1]*i[0]],s[0]+=t[o];var n,i;return s}const Jt=(t,e,s,n)=>t.createScriptProcessor(e,s,n),Kt=()=>new DOMException("","NotSupportedError"),te={numberOfChannels:1},ee={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},se={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},ne={disableNormalization:!1},ie={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},oe=()=>new DOMException("","UnknownError"),re={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},ae=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},ce=(t,e,s,n)=>{let i=Object.getPrototypeOf(t);for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:r}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:s(o),set:n(r)})},he=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},ue=t=>{const e=t.createBuffer(1,1,44100),s=t.createBufferSource();s.buffer=e,s.start(),s.stop();try{return s.stop(),!0}catch{return!1}},le=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},pe=()=>{try{new DOMException}catch{return!1}return!0},de=()=>new Promise(t=>{const e=new ArrayBuffer(0),{port1:s,port2:n}=new MessageChannel;s.onmessage=({data:e})=>t(null!==e),n.postMessage(e,[e])}),fe=(t,e)=>{const s=e.createGain();t.connect(s);const n=(i=t.disconnect,()=>{i.call(t,s),t.removeEventListener("ended",n)});var i;t.addEventListener("ended",n),Zt(t,s),t.stop=(e=>{let n=!1;return(i=0)=>{if(n)try{e.call(t,i)}catch{s.gain.setValueAtTime(0,i)}else e.call(t,i),n=!0}})(t.stop)},_e=(t,e)=>s=>{const n={value:t};return Object.defineProperties(s,{currentTarget:n,target:n}),"function"==typeof e?e.call(t,s):e.handleEvent.call(t,s)},me=(ge=new Map,ve=new WeakMap,(t,e)=>{const s=ve.get(t);if(void 0!==s)return s;const n=ge.get(t);if(void 0!==n)return n;try{const s=e();return s instanceof Promise?(ge.set(t,s),s.catch(()=>!1).then(e=>(ge.delete(t),ve.set(t,e),e))):(ve.set(t,s),s)}catch{return ve.set(t,!1),!1}});var ge,ve;const ye="undefined"==typeof window?null:window,xe=(we=me,be=k,(t,e)=>{const s=t.createAnalyser();if(Pt(s,e),!(e.maxDecibels>e.minDecibels))throw be();return Nt(s,e,"fftSize"),Nt(s,e,"maxDecibels"),Nt(s,e,"minDecibels"),Nt(s,e,"smoothingTimeConstant"),we(jt,()=>jt(s))||(t=>{t.getFloatTimeDomainData=e=>{const s=new Uint8Array(e.length);t.getByteTimeDomainData(s);const n=Math.max(s.length,t.fftSize);for(let t=0;t<n;t+=1)e[t]=.0078125*(s[t]-128);return e}})(s),s});var we,be;const Te=(Se=N,t=>{const e=Se(t);if(null===e.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer});var Se;const ke=((t,e,s)=>async(n,i,o,r)=>{const a=t(n),c=[...r,n];await Promise.all(a.activeInputs.map((t,r)=>Array.from(t).filter(([t])=>!c.includes(t)).map(async([t,a])=>{const h=e(t),u=await h.render(t,i,c),l=n.context.destination;s(t)||n===l&&s(n)||u.connect(o,a,r)})).reduce((t,e)=>[...t,...e],[]))})(N,Te,$),Ce=(Ae=xe,De=X,Oe=ke,()=>{const t=new WeakMap;return{render(e,s,n){const i=t.get(s);return void 0!==i?Promise.resolve(i):(async(e,s,n)=>{let i=De(e);if(!T(i,s)){const t={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,fftSize:i.fftSize,maxDecibels:i.maxDecibels,minDecibels:i.minDecibels,smoothingTimeConstant:i.smoothingTimeConstant};i=Ae(s,t)}return t.set(s,i),await Oe(e,s,i,n),i})(e,s,n)}}});var Ae,De,Oe;const Me=(Ee=p,t=>{const e=Ee.get(t);if(void 0===e)throw Mt();return e});var Ee;const Re=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(ye),qe=(Fe=Re,t=>null!==Fe&&t instanceof Fe);var Fe;const Ie=new WeakMap,Ve=(Ne=_e,class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,e,s){if(null!==e){let n=this._listeners.get(e);void 0===n&&(n=Ne(this,e),"function"==typeof e&&this._listeners.set(e,n)),this._nativeEventTarget.addEventListener(t,n,s)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,s){const n=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===n?null:n,s)}});var Ne;const Pe=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(ye),je=(Le=Pe,t=>null!==Le&&t instanceof Le);var Le;const ze=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(ye),Be=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(ye),We=((t,e,s,n,i,o,r,a,c,u,l,p,f,_)=>class extends c{constructor(s,n,i,o){super(i),this._context=s,this._nativeAudioNode=i;const r=u(s);l(r)&&!0!==e(et,()=>et(r))&&(t=>{const e=new Map;var s,n;t.connect=(s=t.connect.bind(t),(t,n=0,i=0)=>{const o=nt(t)?s(t,n,i):s(t,n),r=e.get(t);return void 0===r?e.set(t,[{input:i,output:n}]):r.every(t=>t.input!==i||t.output!==n)&&r.push({input:i,output:n}),o}),t.disconnect=(n=t.disconnect,(s,i,o)=>{if(n.apply(t),void 0===s)e.clear();else if("number"==typeof s)for(const[t,n]of e){const i=n.filter(t=>t.output!==s);0===i.length?e.delete(t):e.set(t,i)}else if(e.has(s))if(void 0===i)e.delete(s);else{const t=e.get(s);if(void 0!==t){const n=t.filter(t=>t.output!==i&&(t.input!==o||void 0===o));0===n.length?e.delete(s):e.set(s,n)}}for(const[s,n]of e)n.forEach(e=>{nt(s)?t.connect(s,e.output,e.input):t.connect(s,e.output)})})})(i),h.set(this,i),d.set(this,new Set),"closed"!==s.state&&n&&q(this),t(this,o,i)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,e=0,r=0){if(e<0||e>=this._nativeAudioNode.numberOfOutputs)throw n();const c=u(this._context),h=_(c);if(p(t)||f(t))throw i();if(B(t)){const n=X(t);try{const s=G(this._nativeAudioNode,n,e,r),i=J(this);(h||i)&&this._nativeAudioNode.disconnect(...s),"closed"!==this.context.state&&!i&&J(t)&&q(t)}catch(t){if(12===t.code)throw i();throw t}if(ut(this,t,e,r,h)){const e=a([this],t);st(e,s(h))}return t}const l=Y(t);if("playbackRate"===l.name)throw o();try{this._nativeAudioNode.connect(l,e),(h||J(this))&&this._nativeAudioNode.disconnect(l,e)}catch(t){if(12===t.code)throw i();throw t}if(lt(this,t,e,h)){const e=a([this],t);st(e,s(h))}}disconnect(t,e,s){let o;const c=u(this._context),h=_(c);if(void 0===t)o=((t,e)=>{const s=N(t),n=[];for(const i of s.outputs)W(i)?dt(t,e,...i):ft(t,e,...i),n.push(i[0]);return s.outputs.clear(),n})(this,h);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw n();o=((t,e,s)=>{const n=N(t),i=[];for(const o of n.outputs)o[1]===s&&(W(o)?dt(t,e,...o):ft(t,e,...o),i.push(o[0]),n.outputs.delete(o));return i})(this,h,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw n();if(B(t)&&void 0!==s&&(s<0||s>=t.numberOfInputs))throw n();if(o=((t,e,s,n,i)=>{const o=N(t);return Array.from(o.outputs).filter(t=>!(t[0]!==s||void 0!==n&&t[1]!==n||void 0!==i&&t[2]!==i)).map(s=>(W(s)?dt(t,e,...s):ft(t,e,...s),o.outputs.delete(s),s[0]))})(this,h,t,e,s),0===o.length)throw i()}for(const t of o){const e=a([this],t);st(e,r)}}})((Ue=c,(t,e,s)=>{const n=[];for(let t=0;t<s.numberOfInputs;t+=1)n.push(new Set);Ue.set(t,{activeInputs:n,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),me,((t,e,s,n,i,o)=>r=>(a,c)=>{const h=t.get(a);if(void 0===h){if(!r&&o(a)){const t=n(a),{outputs:o}=s(a);for(const s of o)if(W(s)){const i=n(s[0]);e(t,i,s[1],s[2])}else{const e=i(s[0]);t.disconnect(e,s[1])}}t.set(a,c)}else t.set(a,h+c)})(f,Z,N,X,Y,M),k,Et,Kt,((t,e,s,n,i,o,r,a)=>(c,h)=>{const u=e.get(c);if(void 0===u)throw new Error("Missing the expected cycle count.");const l=o(c.context),p=a(l);if(u===h){if(e.delete(c),!p&&r(c)){const e=n(c),{outputs:o}=s(c);for(const s of o)if(W(s)){const i=n(s[0]);t(e,i,s[1],s[2])}else{const t=i(s[0]);e.connect(t,s[1])}}}else e.set(c,u-h)})(G,f,N,X,Y,Me,M,qe),((t,e,s)=>function n(i,o){const r=B(o)?o:s(t,o);if((t=>"delayTime"in t)(r))return[];if(i[0]===r)return[i];if(i.includes(r))return[];const{outputs:a}=e(r);return Array.from(a).map(t=>n([...i,r],t[0])).reduce((t,e)=>t.concat(e),[])})(Ie,N,E),Ve,Me,je,ze,Be,qe);var Ue;const Ge=((t,e,s,n,i,o)=>class extends t{constructor(t,s){const r=i(t),a={...b,...s},c=n(r,a);super(t,!1,c,o(r)?e():null),this._nativeAnalyserNode=c}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,s()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,s()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(We,Ce,k,xe,Me,qe),Qe=new WeakSet,Ze=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(ye),Xe=(Ye=new Uint32Array(1),t=>(Ye[0]=t,Ye[0]));var Ye;const He=((t,e)=>s=>{s.copyFromChannel=(n,i,o=0)=>{const r=t(o),a=t(i);if(a>=s.numberOfChannels)throw e();const c=s.length,h=s.getChannelData(a),u=n.length;for(let t=r<0?-r:0;t+r<c&&t<u;t+=1)n[t]=h[t+r]},s.copyToChannel=(n,i,o=0)=>{const r=t(o),a=t(i);if(a>=s.numberOfChannels)throw e();const c=s.length,h=s.getChannelData(a),u=n.length;for(let t=r<0?-r:0;t+r<c&&t<u;t+=1)h[t+r]=n[t]}})(Xe,k),$e=(t=>e=>{e.copyFromChannel=(s=>(n,i,o=0)=>{const r=t(o),a=t(i);if(r<e.length)return s.call(e,n,a,r)})(e.copyFromChannel),e.copyToChannel=(s=>(n,i,o=0)=>{const r=t(o),a=t(i);if(r<e.length)return s.call(e,n,a,r)})(e.copyToChannel)})(Xe),Je=((t,e,s,n,i,o,r,a)=>{let c=null;return class h{constructor(h){if(null===i)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:u,numberOfChannels:l,sampleRate:p}={...A,...h};null===c&&(c=new i(1,1,44100));const d=null!==n&&e(o,o)?new n({length:u,numberOfChannels:l,sampleRate:p}):c.createBuffer(l,u,p);if(0===d.numberOfChannels)throw s();return"function"!=typeof d.copyFromChannel?(r(d),C(d)):e(S,()=>S(d))||a(d),t.add(d),d}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===h.prototype||t.has(e)}}})(Qe,me,Kt,Ze,Re,(Ke=Ze,()=>{if(null===Ke)return!1;try{new Ke({length:1,sampleRate:44100})}catch{return!1}return!0}),He,$e);var Ke;const ts=(es=Yt,(t,e)=>{const s=es(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(s).connect(t.destination);const n=()=>{e.removeEventListener("ended",n),e.disconnect(s),s.disconnect()};e.addEventListener("ended",n)});var es;const ss=((t,e,s)=>async(n,i,o,r)=>{const a=e(n);await Promise.all(Array.from(a.activeInputs).map(async([e,n])=>{const a=t(e),c=await a.render(e,i,r);s(e)||c.connect(o,n)}))})(Te,P,$),ns=(t=>(e,s,n,i)=>t(s,e,n,i))(ss),is=((t,e,s,n,i,o,r,a,c,h,u)=>(l,p)=>{const d=l.createBufferSource();return Pt(d,p),Lt(d,p,"playbackRate"),Nt(d,p,"buffer"),Nt(d,p,"loop"),Nt(d,p,"loopEnd"),Nt(d,p,"loopStart"),e(s,()=>s(l))||(t=>{t.start=(e=>{let s=!1;return(n=0,i=0,o)=>{if(s)throw Mt();e.call(t,n,i,o),s=!0}})(t.start)})(d),e(n,()=>n(l))||c(d),e(i,()=>i(l))||h(d,l),e(o,()=>o(l))||zt(d),e(r,()=>r(l))||u(d,l),e(a,()=>a(l))||Bt(d),t(l,d),d})(ts,me,t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},t=>{const e=t.createBufferSource(),s=t.createBuffer(1,1,44100);e.buffer=s;try{e.start(0,1)}catch{return!1}return!0},t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},he,ue,le,t=>{var e;t.start=(e=t.start,(s=0,n=0,i)=>{const o=t.buffer,r=null===o?n:Math.min(o.duration,n);null!==o&&r>o.duration-.5/t.context.sampleRate?e.call(t,s,0,0):e.call(t,s,r,i)})},(os=ce,(t,e)=>{const s=e.createBuffer(1,1,e.sampleRate);null===t.buffer&&(t.buffer=s),os(t,"buffer",e=>()=>{const n=e.call(t);return n===s?null:n},e=>n=>e.call(t,null===n?s:n))}),fe);var os;const rs=((t,e)=>(s,n,i,o)=>(t(n).replay(i),e(n,s,i,o)))((t=>e=>{const s=t(e);if(null===s.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return s.renderer})(P),ss),as=((t,e,s,n,i)=>()=>{const o=new WeakMap;let r=null,a=null;return{set start(t){r=t},set stop(t){a=t},render(c,h,u){const l=o.get(h);return void 0!==l?Promise.resolve(l):(async(c,h,u)=>{let l=s(c);const p=T(l,h);if(!p){const t={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,loop:l.loop,loopEnd:l.loopEnd,loopStart:l.loopStart,playbackRate:l.playbackRate.value};l=e(h,t),null!==r&&l.start(...r),null!==a&&l.stop(a)}return o.set(h,l),p?await t(h,c.playbackRate,l.playbackRate,u):await n(h,c.playbackRate,l.playbackRate,u),await i(c,h,l,u),l})(c,h,u)}}})(ns,is,X,rs,ke),cs=((t,e,s,n,i,o,a,c,h,u,l,p)=>(d,f,_,m=null,g=null)=>{const v=new r.AutomationEventList(_.defaultValue),y=f?n(v):null,x={get defaultValue(){return _.defaultValue},get maxValue(){return null===m?_.maxValue:m},get minValue(){return null===g?_.minValue:g},get value(){return _.value},set value(t){_.value=t,x.setValueAtTime(t,d.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof _.cancelAndHoldAtTime)null===y&&v.flush(d.context.currentTime),v.add(i(t)),_.cancelAndHoldAtTime(t);else{const e=Array.from(v).pop();null===y&&v.flush(d.context.currentTime),v.add(i(t));const s=Array.from(v).pop();_.cancelScheduledValues(t),e!==s&&void 0!==s&&("exponentialRampToValue"===s.type?_.exponentialRampToValueAtTime(s.value,s.endTime):"linearRampToValue"===s.type?_.linearRampToValueAtTime(s.value,s.endTime):"setValue"===s.type?_.setValueAtTime(s.value,s.startTime):"setValueCurve"===s.type&&_.setValueCurveAtTime(s.values,s.startTime,s.duration))}return x},cancelScheduledValues:t=>(null===y&&v.flush(d.context.currentTime),v.add(o(t)),_.cancelScheduledValues(t),x),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===y&&v.flush(d.context.currentTime),v.add(a(t,e)),_.exponentialRampToValueAtTime(t,e),x},linearRampToValueAtTime:(t,e)=>(null===y&&v.flush(d.context.currentTime),v.add(c(t,e)),_.linearRampToValueAtTime(t,e),x),setTargetAtTime:(t,e,s)=>(null===y&&v.flush(d.context.currentTime),v.add(h(t,e,s)),_.setTargetAtTime(t,e,s),x),setValueAtTime:(t,e)=>(null===y&&v.flush(d.context.currentTime),v.add(u(t,e)),_.setValueAtTime(t,e),x),setValueCurveAtTime(t,e,s){const n=t instanceof Float32Array?t:new Float32Array(t);if(null!==p&&"webkitAudioContext"===p.name){const t=e+s,i=d.context.sampleRate,o=Math.ceil(e*i),r=Math.floor(t*i),a=r-o,c=new Float32Array(a);for(let t=0;t<a;t+=1){const r=(n.length-1)/s*((o+t)/i-e),a=Math.floor(r),h=Math.ceil(r);c[t]=a===h?n[a]:(1-(r-a))*n[a]+(1-(h-r))*n[h]}null===y&&v.flush(d.context.currentTime),v.add(l(c,e,s)),_.setValueCurveAtTime(c,e,s);const h=r/i;h<t&&x.setValueAtTime(c[c.length-1],h),x.setValueAtTime(n[n.length-1],t)}else null===y&&v.flush(d.context.currentTime),v.add(l(n,e,s)),_.setValueCurveAtTime(n,e,s);return x}};return s.set(x,_),e.set(x,d),t(x,y),x})((hs=u,(t,e)=>{hs.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),Ie,l,t=>({replay(e){for(const s of t)if("exponentialRampToValue"===s.type){const{endTime:t,value:n}=s;e.exponentialRampToValueAtTime(n,t)}else if("linearRampToValue"===s.type){const{endTime:t,value:n}=s;e.linearRampToValueAtTime(n,t)}else if("setTarget"===s.type){const{startTime:t,target:n,timeConstant:i}=s;e.setTargetAtTime(n,t,i)}else if("setValue"===s.type){const{startTime:t,value:n}=s;e.setValueAtTime(n,t)}else{if("setValueCurve"!==s.type)throw new Error("Can\'t apply an unknown automation.");{const{duration:t,startTime:n,values:i}=s;e.setValueCurveAtTime(i,n,t)}}}}),r.createCancelAndHoldAutomationEvent,r.createCancelScheduledValuesAutomationEvent,r.createExponentialRampToValueAutomationEvent,r.createLinearRampToValueAutomationEvent,r.createSetTargetAutomationEvent,r.createSetValueAutomationEvent,r.createSetValueCurveAutomationEvent,Pe);var hs;const us=((t,e,s,n,i,o,r,a)=>class extends t{constructor(t,n){const a=o(t),c={...I,...n},h=i(a,c),u=r(a),l=u?e():null;super(t,!1,h,l),this._audioBufferSourceNodeRenderer=l,this._isBufferNullified=!1,this._isBufferSet=null!==c.buffer,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=s(this,u,h.playbackRate,O,D)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const s=this._nativeAudioBufferSourceNode.onended;this._onended=null!==s&&s===e?t:s}get playbackRate(){return this._playbackRate}start(t=0,e=0,s){if(this._nativeAudioBufferSourceNode.start(t,e,s),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===s?[t,e]:[t,e,s]),"closed"!==this.context.state){q(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),setTimeout(()=>{M(this)&&F(this)},1e3)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(We,as,cs,Mt,is,Me,qe,_e),ls=((t,e,s,n,i,o,r,a)=>class extends t{constructor(t,s){const n=o(t),c=r(n),h=i(n,s,c);super(t,!1,h,c?e(a):null),this._isNodeOfNativeOfflineAudioContext=c,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw s();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(We,t=>{let e=null;return{render:(s,n,i)=>(null===e&&(e=(async(e,s,n)=>{const i=s.destination;return await t(e,s,i,n),i})(s,n,i)),e)}},k,Mt,((t,e)=>(s,n,i)=>{const o=s.destination;if(o.channelCount!==n)try{o.channelCount=n}catch{}i&&"explicit"!==o.channelCountMode&&(o.channelCountMode="explicit"),0===o.maxChannelCount&&Object.defineProperty(o,"maxChannelCount",{value:n});const r=t(s,{channelCount:n,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(r,"channelCount",t=>()=>t.call(r),t=>e=>{t.call(r,e);try{o.channelCount=e}catch(t){if(e>o.maxChannelCount)throw t}}),e(r,"channelCountMode",t=>()=>t.call(r),t=>e=>{t.call(r,e),o.channelCountMode=e}),e(r,"channelInterpretation",t=>()=>t.call(r),t=>e=>{t.call(r,e),o.channelInterpretation=e}),Object.defineProperty(r,"maxChannelCount",{get:()=>o.maxChannelCount}),r.connect(o),r})(Yt,ce),Me,qe,ke),ps=((t,e,s,n,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const h=o.get(a);return void 0!==h?Promise.resolve(h):(async(r,a,c)=>{let h=s(r);const u=T(h,a);if(!u){const t={Q:h.Q.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,gain:h.gain.value,type:h.type};h=e(a,t)}return o.set(a,h),u?(await t(a,r.Q,h.Q,c),await t(a,r.detune,h.detune,c),await t(a,r.frequency,h.frequency,c),await t(a,r.gain,h.gain,c)):(await n(a,r.Q,h.Q,c),await n(a,r.detune,h.detune,c),await n(a,r.frequency,h.frequency,c),await n(a,r.gain,h.gain,c)),await i(r,a,h,c),h})(r,a,c)}}})(ns,Gt,X,rs,ke),ds=(fs=We,_s=cs,ms=ps,gs=Et,vs=Gt,ys=Me,xs=qe,class extends fs{constructor(t,e){const s=ys(t),n={...wt,...e},i=vs(s,n),o=xs(s);super(t,!1,i,o?ms():null),this._Q=_s(this,o,i.Q,O,D),this._detune=_s(this,o,i.detune,1200*Math.log2(O),-1200*Math.log2(O)),this._frequency=_s(this,o,i.frequency,t.sampleRate/2,0),this._gain=_s(this,o,i.gain,40*Math.log10(O),D),this._nativeBiquadFilterNode=i}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,s){if(this._nativeBiquadFilterNode.getFrequencyResponse(t,e,s),t.length!==e.length||e.length!==s.length)throw gs()}});var fs,_s,ms,gs,vs,ys,xs;const ws=((t,e)=>(s,n,i)=>{const o=new Set;var r,a;return s.connect=(r=s.connect,(i,a=0,c=0)=>{const h=0===o.size;if(e(i))return r.call(s,i,a,c),t(o,[i,a,c],t=>t[0]===i&&t[1]===a&&t[2]===c,!0),h&&n(),i;r.call(s,i,a),t(o,[i,a],t=>t[0]===i&&t[1]===a,!0),h&&n()}),s.disconnect=(a=s.disconnect,(t,n,r)=>{const c=o.size>0;if(void 0===t)a.apply(s),o.clear();else if("number"==typeof t){a.call(s,t);for(const e of o)e[1]===t&&o.delete(e)}else{e(t)?a.call(s,t,n,r):a.call(s,t,n);for(const e of o)e[0]!==t||void 0!==n&&e[1]!==n||void 0!==r&&e[2]!==r||o.delete(e)}const h=0===o.size;c&&h&&i()}),s})(H,ze),bs=(Ts=Mt,Ss=ws,(t,e)=>{e.channelCount=1,e.channelCountMode="explicit",Object.defineProperty(e,"channelCount",{get:()=>1,set:()=>{throw Ts()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:()=>{throw Ts()}});const s=t.createBufferSource();Ss(e,()=>{const t=e.numberOfInputs;for(let n=0;n<t;n+=1)s.connect(e,0,n)},()=>s.disconnect(e))});var Ts,Ss;const ks=((t,e)=>(s,n)=>{const i=s.createChannelMerger(n.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(s,i),Pt(i,n),i})(Pe,bs),Cs=((t,e,s,n,i)=>class extends t{constructor(t,o){const r=n(t),a={...bt,...o};super(t,!1,s(r,a),i(r)?e():null)}})(We,((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o,r){const a=n.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!T(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(o,e)}return n.set(o,a),await s(i,o,a,r),a})(i,o,r)}}})(ks,X,ke),ks,Me,qe),As=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=n(t),c=o({...Tt,...r});super(t,!1,s(a,c),i(a)?e():null)}})(We,((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o,r){const a=n.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!T(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(o,e)}return n.set(o,a),await s(i,o,a,r),a})(i,o,r)}}})(Qt,X,ke),Qt,Me,qe,t=>({...t,channelCount:t.numberOfOutputs})),Ds=((t,e,s,n)=>(i,{offset:o,...r})=>{const a=i.createBuffer(1,2,i.sampleRate),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),h=s(i,{...r,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const l={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(t){h.channelCount=t},get channelCountMode(){return h.channelCountMode},set channelCountMode(t){h.channelCountMode=t},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t},get context(){return h.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get offset(){return h.gain},get onended(){return c.onended},set onended(t){c.onended=t},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2]),start(t=0){c.start.call(c,t)},stop(t=0){c.stop.call(c,t)}};return t(i,c),n(Zt(l,h),()=>c.connect(h),()=>c.disconnect(h))})(ts,is,Yt,ws),Os=((t,e,s,n,i)=>(o,r)=>{if(void 0===o.createConstantSource)return s(o,r);const a=o.createConstantSource();return Pt(a,r),Lt(a,r,"offset"),e(n,()=>n(o))||zt(a),e(i,()=>i(o))||Bt(a),t(o,a),a})(ts,me,Ds,he,le),Ms=((t,e,s,n,i,o,r)=>class extends t{constructor(t,r){const a=i(t),c={...St,...r},h=n(a,c),u=o(a),l=u?s():null;super(t,!1,h,l),this._constantSourceNodeRenderer=l,this._nativeConstantSourceNode=h,this._offset=e(this,u,h.offset,O,D),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?r(this,t):null;this._nativeConstantSourceNode.onended=e;const s=this._nativeConstantSourceNode.onended;this._onended=null!==s&&s===e?t:s}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){q(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),setTimeout(()=>{M(this)&&F(this)},1e3)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(We,cs,((t,e,s,n,i)=>()=>{const o=new WeakMap;let r=null,a=null;return{set start(t){r=t},set stop(t){a=t},render(c,h,u){const l=o.get(h);return void 0!==l?Promise.resolve(l):(async(c,h,u)=>{let l=s(c);const p=T(l,h);if(!p){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,offset:l.offset.value};l=e(h,t),null!==r&&l.start(r),null!==a&&l.stop(a)}return o.set(h,l),p?await t(h,c.offset,l.offset,u):await n(h,c.offset,l.offset,u),await i(c,h,l,u),l})(c,h,u)}}})(ns,Os,X,rs,ke),Os,Me,qe,_e),Es=((t,e)=>(s,n)=>{const i=s.createConvolver();if(Pt(i,n),n.disableNormalization===i.normalize&&(i.normalize=!n.disableNormalization),Nt(i,n,"buffer"),n.channelCount>2)throw t();if(e(i,"channelCount",t=>()=>t.call(i),e=>s=>{if(s>2)throw t();return e.call(i,s)}),"max"===n.channelCountMode)throw t();return e(i,"channelCountMode",t=>()=>t.call(i),e=>s=>{if("max"===s)throw t();return e.call(i,s)}),i})(Kt,ce),Rs=((t,e,s,n,i)=>class extends t{constructor(t,o){const r=n(t),a={...kt,...o},c=s(r,a);super(t,!1,c,i(r)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=c}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,t.sampleRate),this._isBufferNullified=!0}else this._isBufferNullified=!1}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(We,((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o,r){const a=n.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!T(a,o)){const e={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(o,e)}return n.set(o,a),U(a)?await s(i,o,a.inputs[0],r):await s(i,o,a,r),a})(i,o,r)}}})(Es,X,ke),Es,Me,qe),qs=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=i(t),c={...Ct,...r},h=n(a,c),u=o(a);super(t,!1,h,u?s(c.maxDelayTime):null),this._delayTime=e(this,u,h.delayTime)}get delayTime(){return this._delayTime}})(We,cs,((t,e,s,n,i)=>o=>{const r=new WeakMap;return{render(a,c,h){const u=r.get(c);return void 0!==u?Promise.resolve(u):(async(a,c,h)=>{let u=s(a);const l=T(u,c);if(!l){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=e(c,t)}return r.set(c,u),l?await t(c,a.delayTime,u.delayTime,h):await n(c,a.delayTime,u.delayTime,h),await i(a,c,u,h),u})(a,c,h)}}})(ns,Xt,X,rs,ke),Xt,Me,qe),Fs=(Is=Kt,(t,e)=>{const s=t.createDynamicsCompressor();if(Pt(s,e),e.channelCount>2)throw Is();if("max"===e.channelCountMode)throw Is();return Lt(s,e,"attack"),Lt(s,e,"knee"),Lt(s,e,"ratio"),Lt(s,e,"release"),Lt(s,e,"threshold"),s});var Is;const Vs=((t,e,s,n,i,o,r)=>class extends t{constructor(t,i){const a=o(t),c={...Dt,...i},h=n(a,c),u=r(a);super(t,!1,h,u?s():null),this._attack=e(this,u,h.attack),this._knee=e(this,u,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=e(this,u,h.ratio),this._release=e(this,u,h.release),this._threshold=e(this,u,h.threshold)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(We,cs,((t,e,s,n,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const h=o.get(a);return void 0!==h?Promise.resolve(h):(async(r,a,c)=>{let h=s(r);const u=T(h,a);if(!u){const t={attack:h.attack.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,knee:h.knee.value,ratio:h.ratio.value,release:h.release.value,threshold:h.threshold.value};h=e(a,t)}return o.set(a,h),u?(await t(a,r.attack,h.attack,c),await t(a,r.knee,h.knee,c),await t(a,r.ratio,h.ratio,c),await t(a,r.release,h.release,c),await t(a,r.threshold,h.threshold,c)):(await n(a,r.attack,h.attack,c),await n(a,r.knee,h.knee,c),await n(a,r.ratio,h.ratio,c),await n(a,r.release,h.release,c),await n(a,r.threshold,h.threshold,c)),await i(r,a,h,c),h})(r,a,c)}}})(ns,Fs,X,rs,ke),Fs,Kt,Me,qe),Ns=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=i(t),c={...Ot,...r},h=n(a,c),u=o(a);super(t,!1,h,u?s():null),this._gain=e(this,u,h.gain,O,D)}get gain(){return this._gain}})(We,cs,((t,e,s,n,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const h=o.get(a);return void 0!==h?Promise.resolve(h):(async(r,a,c)=>{let h=s(r);const u=T(h,a);if(!u){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,gain:h.gain.value};h=e(a,t)}return o.set(a,h),u?await t(a,r.gain,h.gain,c):await n(a,r.gain,h.gain,c),await i(r,a,h,c),h})(r,a,c)}}})(ns,Yt,X,rs,ke),Yt,Me,qe),Ps=((t,e,s,n)=>(i,o,{channelCount:r,channelCountMode:a,channelInterpretation:c,feedback:h,feedforward:u})=>{const l=Wt(o,i.sampleRate),p=h instanceof Float64Array?h:new Float64Array(h),d=u instanceof Float64Array?u:new Float64Array(u),f=p.length,_=d.length,m=Math.min(f,_);if(0===f||f>20)throw n();if(0===p[0])throw e();if(0===_||_>20)throw n();if(0===d[0])throw e();if(1!==p[0]){for(let t=0;t<_;t+=1)d[t]/=p[0];for(let t=1;t<f;t+=1)p[t]/=p[0]}const g=s(i,l,r,r);g.channelCount=r,g.channelCountMode=a,g.channelInterpretation=c;const v=[],y=[],x=[];for(let t=0;t<r;t+=1){v.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),y.push(t),x.push(e)}g.onaudioprocess=t=>{const e=t.inputBuffer,s=t.outputBuffer,n=e.numberOfChannels;for(let t=0;t<n;t+=1){const n=e.getChannelData(t),i=s.getChannelData(t);v[t]=qt(p,f,d,_,m,y[t],x[t],v[t],32,n,i)}};const w=i.sampleRate/2;return Zt({get bufferSize(){return l},get channelCount(){return g.channelCount},set channelCount(t){g.channelCount=t},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){g.channelCountMode=t},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(t){g.channelInterpretation=t},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener:(...t)=>g.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>g.dispatchEvent(t[0]),getFrequencyResponse(e,s,n){if(e.length!==s.length||s.length!==n.length)throw t();const i=e.length;for(let t=0;t<i;t+=1){const i=-Math.PI*(e[t]/w),o=[Math.cos(i),Math.sin(i)],r=Ht($t(d,o),$t(p,o));s[t]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),n[t]=Math.atan2(r[1],r[0])}},removeEventListener:(...t)=>g.removeEventListener(t[0],t[1],t[2])},g)})(Et,Mt,Jt,Kt),js=((t,e,s,n)=>i=>t(It,()=>It(i))?Promise.resolve(t(n,n)).then(t=>{if(!t){const t=s(i,512,0,1);i.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>i.currentTime,t.connect(i.destination)}return i.startRendering()}):new Promise(t=>{const s=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=e=>{s.disconnect(),t(e.renderedBuffer)},s.connect(i.destination),i.startRendering()}))(me,Yt,Jt,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const s=new e(1,1,44100),n=t(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(t=>{s.oncomplete=()=>{n.disconnect(),t(0!==s.currentTime)},s.startRendering()})})(Yt,Re)),Ls=((t,e,s,n,i)=>(o,r)=>{const a=new WeakMap;let c=null;const h=async(h,u,l)=>{let p=null,d=e(h);const f=T(d,u);if(void 0===u.createIIRFilter?p=t(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(d=u.createIIRFilter(r,o)),a.set(u,null===p?d:p),null!==p){if(null===c){if(null===s)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new s(h.context.destination.channelCount,h.context.length,u.sampleRate);c=(async()=>{await n(h,t,t.destination,l);return((t,e,s,n)=>{const i=s instanceof Float64Array?s:new Float64Array(s),o=n instanceof Float64Array?n:new Float64Array(n),r=i.length,a=o.length,c=Math.min(r,a);if(1!==i[0]){for(let t=0;t<r;t+=1)o[t]/=i[0];for(let t=1;t<a;t+=1)i[t]/=i[0]}const h=new Float32Array(32),u=new Float32Array(32),l=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),p=t.numberOfChannels;for(let e=0;e<p;e+=1){const s=t.getChannelData(e),n=l.getChannelData(e);h.fill(0),u.fill(0),qt(i,r,o,a,c,h,u,0,32,s,n)}return l})(await i(t),u,o,r)})()}const t=await c;return p.buffer=t,p.start(0),p}return await n(h,u,d,l),d};return{render(t,e,s){const n=a.get(e);return void 0!==n?Promise.resolve(n):h(t,e,s)}}})(is,X,Re,ke,js);var zs;const Bs=((t,e,s,n,i)=>class extends t{constructor(t,o){const r=n(t),a=i(r),c={...Rt,...o},h=e(r,a?null:t.baseLatency,c);super(t,!1,h,a?s(c.feedback,c.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(s,n,i)=>{if(s.length!==n.length||n.length!==i.length)throw Et();return e.call(t,s,n,i)})})(h),this._nativeIIRFilterNode=h}getFrequencyResponse(t,e,s){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,s)}})(We,(zs=Ps,(t,e,s)=>{if(void 0===t.createIIRFilter)return zs(t,e,s);const n=t.createIIRFilter(s.feedforward,s.feedback);return Pt(n,s),n}),Ls,Me,qe),Ws=((t,e,s,n,i)=>(o,r)=>{const a=r.listener,{forwardX:c,forwardY:h,forwardZ:u,positionX:l,positionY:p,positionZ:d,upX:f,upY:_,upZ:m}=void 0===a.forwardX?(()=>{const c=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),h=i(r),u=n(r,256,9,0),l=(e,n)=>{const i=s(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:n});return i.connect(c,0,e),i.start(),Object.defineProperty(i.offset,"defaultValue",{get:()=>n}),t({context:o},h,i.offset,O,D)};let p=[0,0,-1,0,1,0],d=[0,0,0];return u.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0],t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];e.some((t,e)=>t!==p[e])&&(a.setOrientation(...e),p=e);const s=[t.getChannelData(6)[0],t.getChannelData(7)[0],t.getChannelData(8)[0]];s.some((t,e)=>t!==d[e])&&(a.setPosition(...s),d=s)},c.connect(u),{forwardX:l(0,0),forwardY:l(1,0),forwardZ:l(2,-1),positionX:l(6,0),positionY:l(7,0),positionZ:l(8,0),upX:l(3,0),upY:l(4,1),upZ:l(5,0)}})():a;return{get forwardX(){return c},get forwardY(){return h},get forwardZ(){return u},get positionX(){return l},get positionY(){return p},get positionZ(){return d},get upX(){return f},get upY(){return _},get upZ(){return m}}})(cs,ks,Os,Jt,qe),Us=new WeakMap,Gs=((t,e,s,n,i,o)=>class extends s{constructor(s,o){super(s),this._nativeContext=s,p.set(this,s),n(s)&&i.set(s,new Set),this._destination=new t(this,o),this._listener=e(this,s),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?o(this,t):null;this._nativeContext.onstatechange=e;const s=this._nativeContext.onstatechange;this._onstatechange=null!==s&&s===e?t:s}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(ls,Ws,Ve,qe,Us,_e),Qs=((t,e,s,n,i,o)=>(r,a)=>{const c=r.createOscillator();return Pt(c,a),Lt(c,a,"detune"),Lt(c,a,"frequency"),void 0!==a.periodicWave?c.setPeriodicWave(a.periodicWave):Nt(c,a,"type"),e(s,()=>s(r))||zt(c),e(n,()=>n(r))||o(c,r),e(i,()=>i(r))||Bt(c),t(r,c),c})(ts,me,he,ue,le,fe),Zs=((t,e,s,n,i,o,r)=>class extends t{constructor(t,r){const a=i(t),c={...ee,...r},h=s(a,c),u=o(a),l=u?n():null,p=t.sampleRate/2;super(t,!1,h,l),this._detune=e(this,u,h.detune,153600,-153600),this._frequency=e(this,u,h.frequency,p,-p),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=l,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?r(this,t):null;this._nativeOscillatorNode.onended=e;const s=this._nativeOscillatorNode.onended;this._onended=null!==s&&s===e?t:s}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){q(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),setTimeout(()=>{M(this)&&F(this)},1e3)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(We,cs,Qs,((t,e,s,n,i)=>()=>{const o=new WeakMap;let r=null,a=null,c=null;return{set periodicWave(t){r=t},set start(t){a=t},set stop(t){c=t},render(h,u,l){const p=o.get(u);return void 0!==p?Promise.resolve(p):(async(h,u,l)=>{let p=s(h);const d=T(p,u);if(!d){const t={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,detune:p.detune.value,frequency:p.frequency.value,periodicWave:null===r?void 0:r,type:p.type};p=e(u,t),null!==a&&p.start(a),null!==c&&p.stop(c)}return o.set(u,p),d?(await t(u,h.detune,p.detune,l),await t(u,h.frequency,p.frequency,l)):(await n(u,h.detune,p.detune,l),await n(u,h.frequency,p.frequency,l)),await i(h,u,p,l),p})(h,u,l)}}})(ns,Qs,X,rs,ke),Me,qe,_e),Xs=(Ys=is,(t,e)=>{const s=Ys(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),n=t.createBuffer(1,2,t.sampleRate);return s.buffer=n,s.loop=!0,s.connect(e),s.start(),()=>{s.stop(),s.disconnect(e)}});var Ys;const Hs=((t,e,s,n,i)=>(o,{curve:r,oversample:a,...c})=>{const h=o.createWaveShaper(),u=o.createWaveShaper();Pt(h,c),Pt(u,c);const l=s(o,{...c,gain:1}),p=s(o,{...c,gain:-1}),d=s(o,{...c,gain:1}),f=s(o,{...c,gain:-1});let _=null,m=!1,g=null;const v={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(t){l.channelCount=t,p.channelCount=t,h.channelCount=t,d.channelCount=t,u.channelCount=t,f.channelCount=t},get channelCountMode(){return h.channelCountMode},set channelCountMode(t){l.channelCountMode=t,p.channelCountMode=t,h.channelCountMode=t,d.channelCountMode=t,u.channelCountMode=t,f.channelCountMode=t},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t,p.channelInterpretation=t,h.channelInterpretation=t,d.channelInterpretation=t,u.channelInterpretation=t,f.channelInterpretation=t},get context(){return h.context},get curve(){return g},set curve(s){if(null!==s&&s.length<2)throw e();if(null===s)h.curve=s,u.curve=s;else{const t=s.length,e=new Float32Array(t+2-t%2),n=new Float32Array(t+2-t%2);e[0]=s[0],n[0]=-s[t-1];const i=Math.ceil((t+1)/2),o=(t+1)/2-1;for(let r=1;r<i;r+=1){const a=r/i*o,c=Math.floor(a),h=Math.ceil(a);e[r]=c===h?s[c]:(1-(a-c))*s[c]+(1-(h-a))*s[h],n[r]=c===h?-s[t-1-c]:-(1-(a-c))*s[t-1-c]-(1-(h-a))*s[t-1-h]}e[i]=t%2==1?s[i-1]:(s[i-2]+s[i-1])/2,h.curve=e,u.curve=n}g=s,m&&(n(g)&&null===_?_=t(o,l):null!==_&&(_(),_=null))},get inputs(){return[l]},get numberOfInputs(){return h.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get oversample(){return h.oversample},set oversample(t){h.oversample=t,u.oversample=t},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};null!==r&&(v.curve=r instanceof Float32Array?r:new Float32Array(r)),a!==v.oversample&&(v.oversample=a);return i(Zt(v,d),()=>{l.connect(h).connect(d),l.connect(p).connect(u).connect(f).connect(d),m=!0,n(g)&&(_=t(o,l))},()=>{l.disconnect(h),h.disconnect(d),l.disconnect(p),p.disconnect(u),u.disconnect(f),f.disconnect(d),m=!1,null!==_&&(_(),_=null)})})(Xs,Mt,Yt,ae,ws),$s=((t,e,s,n,i,o,r)=>(a,c)=>{const h=a.createWaveShaper();if(null!==o&&"webkitAudioContext"===o.name)return s(a,c);Pt(h,c);const u=null===c.curve||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(null!==u&&u.length<2)throw e();Nt(h,{curve:u},"curve"),Nt(h,c,"oversample");let l=null,p=!1;r(h,"curve",t=>()=>t.call(h),e=>s=>(e.call(h,s),p&&(n(s)&&null===l?l=t(a,h):n(s)||null===l||(l(),l=null)),s));return i(h,()=>{p=!0,n(h.curve)&&(l=t(a,h))},()=>{p=!1,null!==l&&(l(),l=null)})})(Xs,Mt,Hs,ae,ws,Pe,ce),Js=((t,e,s,n,i,o,r,a,c)=>(h,{coneInnerAngle:u,coneOuterAngle:l,coneOuterGain:p,distanceModel:d,maxDistance:f,orientationX:_,orientationY:m,orientationZ:g,panningModel:v,positionX:y,positionY:x,positionZ:w,refDistance:b,rolloffFactor:T,...S})=>{const k=h.createPanner();if(S.channelCount>2)throw r();if("max"===S.channelCountMode)throw r();Pt(k,S);const C={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},A=s(h,{...C,channelInterpretation:"speakers",numberOfInputs:6}),D=n(h,{...S,gain:1}),O=n(h,{...C,gain:1}),M=n(h,{...C,gain:0}),E=n(h,{...C,gain:0}),R=n(h,{...C,gain:0}),q=n(h,{...C,gain:0}),F=n(h,{...C,gain:0}),I=i(h,256,6,1),V=o(h,{...C,curve:new Float32Array([1,1]),oversample:"none"});let N=[_,m,g],P=[y,x,w];I.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0]];e.some((t,e)=>t!==N[e])&&(k.setOrientation(...e),N=e);const s=[t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];s.some((t,e)=>t!==P[e])&&(k.setPosition(...s),P=s)},Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(E.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0});const j={get bufferSize(){},get channelCount(){return k.channelCount},set channelCount(t){if(t>2)throw r();D.channelCount=t,k.channelCount=t},get channelCountMode(){return k.channelCountMode},set channelCountMode(t){if("max"===t)throw r();D.channelCountMode=t,k.channelCountMode=t},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(t){D.channelInterpretation=t,k.channelInterpretation=t},get coneInnerAngle(){return k.coneInnerAngle},set coneInnerAngle(t){k.coneInnerAngle=t},get coneOuterAngle(){return k.coneOuterAngle},set coneOuterAngle(t){k.coneOuterAngle=t},get coneOuterGain(){return k.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();k.coneOuterGain=t},get context(){return k.context},get distanceModel(){return k.distanceModel},set distanceModel(t){k.distanceModel=t},get inputs(){return[D]},get maxDistance(){return k.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;k.maxDistance=t},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get orientationX(){return O.gain},get orientationY(){return M.gain},get orientationZ(){return E.gain},get panningModel(){return k.panningModel},set panningModel(t){k.panningModel=t},get positionX(){return R.gain},get positionY(){return q.gain},get positionZ(){return F.gain},get refDistance(){return k.refDistance},set refDistance(t){if(t<0)throw new RangeError;k.refDistance=t},get rolloffFactor(){return k.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;k.rolloffFactor=t},addEventListener:(...t)=>D.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>D.dispatchEvent(t[0]),removeEventListener:(...t)=>D.removeEventListener(t[0],t[1],t[2])};u!==j.coneInnerAngle&&(j.coneInnerAngle=u),l!==j.coneOuterAngle&&(j.coneOuterAngle=l),p!==j.coneOuterGain&&(j.coneOuterGain=p),d!==j.distanceModel&&(j.distanceModel=d),f!==j.maxDistance&&(j.maxDistance=f),_!==j.orientationX.value&&(j.orientationX.value=_),m!==j.orientationY.value&&(j.orientationY.value=m),g!==j.orientationZ.value&&(j.orientationZ.value=g),v!==j.panningModel&&(j.panningModel=v),y!==j.positionX.value&&(j.positionX.value=y),x!==j.positionY.value&&(j.positionY.value=x),w!==j.positionZ.value&&(j.positionZ.value=w),b!==j.refDistance&&(j.refDistance=b),T!==j.rolloffFactor&&(j.rolloffFactor=T),1===N[0]&&0===N[1]&&0===N[2]||k.setOrientation(...N),0===P[0]&&0===P[1]&&0===P[2]||k.setPosition(...P);return c(Zt(j,k),()=>{D.connect(k),t(D,V,0,0),V.connect(O).connect(A,0,0),V.connect(M).connect(A,0,1),V.connect(E).connect(A,0,2),V.connect(R).connect(A,0,3),V.connect(q).connect(A,0,4),V.connect(F).connect(A,0,5),A.connect(I).connect(h.destination)},()=>{D.disconnect(k),a(D,V,0,0),V.disconnect(O),O.disconnect(A),V.disconnect(M),M.disconnect(A),V.disconnect(E),E.disconnect(A),V.disconnect(R),R.disconnect(A),V.disconnect(q),q.disconnect(A),V.disconnect(F),F.disconnect(A),A.disconnect(I),I.disconnect(h.destination)})})(G,Mt,ks,Yt,Jt,$s,Kt,Z,ws),Ks=(tn=Js,(t,e)=>{const s=t.createPanner();return void 0===s.orientationX?tn(t,e):(Pt(s,e),Lt(s,e,"orientationX"),Lt(s,e,"orientationY"),Lt(s,e,"orientationZ"),Lt(s,e,"positionX"),Lt(s,e,"positionY"),Lt(s,e,"positionZ"),Nt(s,e,"coneInnerAngle"),Nt(s,e,"coneOuterAngle"),Nt(s,e,"coneOuterGain"),Nt(s,e,"distanceModel"),Nt(s,e,"maxDistance"),Nt(s,e,"panningModel"),Nt(s,e,"refDistance"),Nt(s,e,"rolloffFactor"),s)});var tn;const en=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=i(t),c={...se,...r},h=s(a,c),u=o(a);super(t,!1,h,u?n():null),this._nativePannerNode=h,this._orientationX=e(this,u,h.orientationX,O,D),this._orientationY=e(this,u,h.orientationY,O,D),this._orientationZ=e(this,u,h.orientationZ,O,D),this._positionX=e(this,u,h.positionX,O,D),this._positionY=e(this,u,h.positionY,O,D),this._positionZ=e(this,u,h.positionZ,O,D)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(We,cs,Ks,((t,e,s,n,i,o,r,a,c,h)=>()=>{const u=new WeakMap;let l=null;return{render(p,d,f){const _=u.get(d);return void 0!==_?Promise.resolve(_):(async(p,d,f)=>{let _=null,m=o(p);const g={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},v={...g,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},y=T(m,d);if("bufferSize"in m)_=n(d,{...g,gain:1});else if(!y){const t={...v,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=i(d,t)}if(u.set(d,null===_?m:_),null!==_){if(null===l){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new r(6,p.context.length,d.sampleRate),n=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});n.connect(t.destination),l=(async()=>{const e=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(async(e,n)=>{const i=s(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===n?1:0});return await a(t,e,i.offset,f),i}));for(let t=0;t<6;t+=1)e[t].connect(n,0,t),e[t].start(0);return h(t)})()}const t=await l,o=n(d,{...g,gain:1});await c(p,d,o,f);const u=[];for(let e=0;e<t.numberOfChannels;e+=1)u.push(t.getChannelData(e));let m=[u[0][0],u[1][0],u[2][0]],y=[u[3][0],u[4][0],u[5][0]],x=n(d,{...g,gain:1}),w=i(d,{...v,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]});o.connect(x).connect(w.inputs[0]),w.connect(_);for(let e=128;e<t.length;e+=128){const t=[u[0][e],u[1][e],u[2][e]],s=[u[3][e],u[4][e],u[5][e]];if(t.some((t,e)=>t!==m[e])||s.some((t,e)=>t!==y[e])){m=t,y=s;const r=e/d.sampleRate;x.gain.setValueAtTime(0,r),x=n(d,{...g,gain:0}),w=i(d,{...v,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]}),x.gain.setValueAtTime(1,r),o.connect(x).connect(w.inputs[0]),w.connect(_)}}return _}return y?(await t(d,p.orientationX,m.orientationX,f),await t(d,p.orientationY,m.orientationY,f),await t(d,p.orientationZ,m.orientationZ,f),await t(d,p.positionX,m.positionX,f),await t(d,p.positionY,m.positionY,f),await t(d,p.positionZ,m.positionZ,f)):(await a(d,p.orientationX,m.orientationX,f),await a(d,p.orientationY,m.orientationY,f),await a(d,p.orientationZ,m.orientationZ,f),await a(d,p.positionX,m.positionX,f),await a(d,p.positionY,m.positionY,f),await a(d,p.positionZ,m.positionZ,f)),U(m)?await c(p,d,m.inputs[0],f):await c(p,d,m,f),m})(p,d,f)}}})(ns,ks,Os,Yt,Ks,X,Re,rs,ke,js),Me,qe),sn=((t,e,s,n)=>class i{constructor(i,o){const r=e(i),a=n({...ne,...o}),c=t(r,a);return s.add(c),c}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===i.prototype||s.has(t)}})((t=>(e,{disableNormalization:s,imag:n,real:i})=>{const o=n instanceof Float32Array?n:new Float32Array(n),r=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(r,o,{disableNormalization:s});if(Array.from(n).length<2)throw t();return a})(k),Me,new WeakSet,t=>{const{imag:e,real:s}=t;return void 0===e?void 0===s?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(s,()=>0),real:s}:void 0===s?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:s}}),nn=((t,e)=>(s,n)=>{const i=n.channelCountMode;if("clamped-max"===i)throw e();if(void 0===s.createStereoPanner)return t(s,n);const o=s.createStereoPanner();return Pt(o,n),Lt(o,n,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:t=>{if(t!==i)throw e()}}),o})(((t,e,s,n,i,o)=>{const r=new Float32Array([1,1]),a=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},h={...c,oversample:"none"},u=(t,o,u,l,p)=>{if(1===o)return((t,e,i,o)=>{const u=new Float32Array(16385),l=new Float32Array(16385);for(let t=0;t<16385;t+=1){const e=t/16384*a;u[t]=Math.cos(e),l[t]=Math.sin(e)}const p=s(t,{...c,gain:0}),d=n(t,{...h,curve:u}),f=n(t,{...h,curve:r}),_=s(t,{...c,gain:0}),m=n(t,{...h,curve:l});return{connectGraph(){e.connect(p),e.connect(f.inputs[0]),e.connect(_),f.connect(i),i.connect(d.inputs[0]),i.connect(m.inputs[0]),d.connect(p.gain),m.connect(_.gain),p.connect(o,0,0),_.connect(o,0,1)},disconnectGraph(){e.disconnect(p),e.disconnect(f.inputs[0]),e.disconnect(_),f.disconnect(i),i.disconnect(d.inputs[0]),i.disconnect(m.inputs[0]),d.disconnect(p.gain),m.disconnect(_.gain),p.disconnect(o,0,0),_.disconnect(o,0,1)}}})(t,u,l,p);if(2===o)return((t,i,o,u)=>{const l=new Float32Array(16385),p=new Float32Array(16385),d=new Float32Array(16385),f=new Float32Array(16385),_=Math.floor(8192.5);for(let t=0;t<16385;t+=1)if(t>_){const e=(t-_)/(16384-_)*a;l[t]=Math.cos(e),p[t]=Math.sin(e),d[t]=0,f[t]=1}else{const e=t/(16384-_)*a;l[t]=1,p[t]=0,d[t]=Math.cos(e),f[t]=Math.sin(e)}const m=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),g=s(t,{...c,gain:0}),v=n(t,{...h,curve:l}),y=s(t,{...c,gain:0}),x=n(t,{...h,curve:p}),w=n(t,{...h,curve:r}),b=s(t,{...c,gain:0}),T=n(t,{...h,curve:d}),S=s(t,{...c,gain:0}),k=n(t,{...h,curve:f});return{connectGraph(){i.connect(m),i.connect(w.inputs[0]),m.connect(g,0),m.connect(y,0),m.connect(b,1),m.connect(S,1),w.connect(o),o.connect(v.inputs[0]),o.connect(x.inputs[0]),o.connect(T.inputs[0]),o.connect(k.inputs[0]),v.connect(g.gain),x.connect(y.gain),T.connect(b.gain),k.connect(S.gain),g.connect(u,0,0),b.connect(u,0,0),y.connect(u,0,1),S.connect(u,0,1)},disconnectGraph(){i.disconnect(m),i.disconnect(w.inputs[0]),m.disconnect(g,0),m.disconnect(y,0),m.disconnect(b,1),m.disconnect(S,1),w.disconnect(o),o.disconnect(v.inputs[0]),o.disconnect(x.inputs[0]),o.disconnect(T.inputs[0]),o.disconnect(k.inputs[0]),v.disconnect(g.gain),x.disconnect(y.gain),T.disconnect(b.gain),k.disconnect(S.gain),g.disconnect(u,0,0),b.disconnect(u,0,0),y.disconnect(u,0,1),S.disconnect(u,0,1)}}})(t,u,l,p);throw i()};return(e,{channelCount:n,channelCountMode:r,pan:a,...c})=>{if("max"===r)throw i();const h=t(e,{...c,channelCount:1,channelCountMode:r,numberOfInputs:2}),l=s(e,{...c,channelCount:n,channelCountMode:r,gain:1}),p=s(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:d,disconnectGraph:f}=u(e,n,l,p,h);Object.defineProperty(p.gain,"defaultValue",{get:()=>0}),Object.defineProperty(p.gain,"minValue",{get:()=>-1});const _={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount!==t&&(m&&f(),({connectGraph:d,disconnectGraph:f}=u(e,t,l,p,h)),m&&d()),l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw i();l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[l]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get pan(){return p.gain},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};let m=!1;return o(Zt(_,h),()=>{d(),m=!0},()=>{f(),m=!1})}})(ks,Qt,Yt,$s,Kt,ws),Kt),on=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=i(t),c={...ie,...r},h=s(a,c),u=o(a);super(t,!1,h,u?n():null),this._pan=e(this,u,h.pan)}get pan(){return this._pan}})(We,cs,nn,((t,e,s,n,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const h=o.get(a);return void 0!==h?Promise.resolve(h):(async(r,a,c)=>{let h=s(r);const u=T(h,a);if(!u){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,pan:h.pan.value};h=e(a,t)}return o.set(a,h),u?await t(a,r.pan,h.pan,c):await n(a,r.pan,h.pan,c),U(h)?await i(r,a,h.inputs[0],c):await i(r,a,h,c),h})(r,a,c)}}})(ns,nn,X,rs,ke),Me,qe),rn=((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o,r){const a=n.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!T(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(o,e)}return n.set(o,a),U(a)?await s(i,o,a.inputs[0],r):await s(i,o,a,r),a})(i,o,r)}}})($s,X,ke),an=((t,e,s,n,i,o)=>class extends t{constructor(t,e){const r=i(t),a={...re,...e},c=s(r,a);super(t,!0,c,o(r)?n():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=c}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(We,Mt,$s,rn,Me,qe),cn=(t=>null!==t&&t.isSecureContext)(ye),hn=(t=>(e,s,n)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*s)},currentTime:{configurable:!0,get:()=>e}});try{return n()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(ye),un=new WeakMap,ln=((t,e)=>s=>{let n=t.get(s);if(void 0!==n)return n;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new e(1,1,8e3),t.set(s,n),n})(un,Re),pn=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(ye),dn=cn?((t,e,s,n,i,o,r,a,c,h,u,l)=>(p,d,f={credentials:"omit"})=>{const m=o(p),g=new URL(d,l.location.href).toString();if(void 0!==m.audioWorklet)return Promise.all([i(d),Promise.resolve(t(u,u))]).then(([t,e])=>{const[s,n]=y(t,g),i=e?n:n.replace(/\\s+extends\\s+AudioWorkletProcessor\\s*{/," extends (class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}){"),o=new Blob([`${s};(registerProcessor=>{${i}\\n})((n,p)=>registerProcessor(n,class extends p{${e?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${e?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))`],{type:"application/javascript; charset=utf-8"}),c=URL.createObjectURL(o);return m.audioWorklet.addModule(c,f).then(()=>{if(a(m))return;return r(m).audioWorklet.addModule(c,f)}).finally(()=>URL.revokeObjectURL(c))});const v=h.get(p);if(void 0!==v&&v.has(d))return Promise.resolve();const b=c.get(p);if(void 0!==b){const t=b.get(d);if(void 0!==t)return t}const T=i(d).then(t=>{const[e,n]=y(t,g);return s(`${e};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${n}\\n})})(window,\'_AWGS\')`)}).then(()=>{const t=l._AWGS.pop();if(void 0===t)throw new SyntaxError;n(m.currentTime,m.sampleRate,()=>t(class{},void 0,(t,s)=>{if(""===t.trim())throw e();const n=_.get(m);if(void 0!==n){if(n.has(t))throw e();w(s),x(s.parameterDescriptors),n.set(t,s)}else w(s),x(s.parameterDescriptors),_.set(m,new Map([[t,s]]))},m.sampleRate,void 0,void 0))});return void 0===b?c.set(p,new Map([[d,T]])):b.set(d,T),T.then(()=>{const t=h.get(p);void 0===t?h.set(p,new Set([d])):t.add(d)}).finally(()=>{const t=c.get(p);void 0!==t&&t.delete(d)}),T})(me,Kt,(t=>e=>new Promise((s,n)=>{if(null===t)return void n(new SyntaxError);const i=t.document.head;if(null===i)n(new SyntaxError);else{const o=t.document.createElement("script"),r=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(r),c=t.onerror,h=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(e,s,i,o,r)=>s===a||s===t.location.href&&1===i&&1===o?(h(),n(r),!1):null!==c?c(e,s,i,o,r):void 0,o.onerror=()=>{h(),n(new SyntaxError)},o.onload=()=>{h(),s()},o.src=a,o.type="module",i.appendChild(o)}}))(ye),hn,(t=>async e=>{try{const t=await fetch(e);if(t.ok)return t.text()}catch{}throw t()})(()=>new DOMException("","AbortError")),Me,ln,qe,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const s=new Blob([\'class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)\'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,8e3),i=URL.createObjectURL(s);let o=!1,r=!1;try{await n.audioWorklet.addModule(i);const e=new t(n,"a",{numberOfOutputs:0}),s=n.createOscillator();e.port.onmessage=()=>o=!0,e.onprocessorerror=()=>r=!0,s.connect(e),await n.startRendering()}catch{}finally{URL.revokeObjectURL(i)}return o&&!r})(pn,Re),ye):void 0,fn=((t,e)=>s=>t(s)||e(s))(je,qe),_n=((t,e,s,n,i,o,r,a,c,h,u,l,p,d,f,_,m,g,v,y)=>class extends f{constructor(e,s){super(e,s),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,s)=>t(this,e,s)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(t,e,n){return new s({length:e,numberOfChannels:t,sampleRate:n})}createBufferSource(){return new n(this)}createChannelMerger(t=6){return new o(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new r(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(t=1){return new u(this,{maxDelayTime:t})}createDynamicsCompressor(){return new l(this)}createGain(){return new p(this)}createIIRFilter(t,e){return new d(this,{feedback:e,feedforward:t})}createOscillator(){return new _(this)}createPanner(){return new m(this)}createPeriodicWave(t,e,s={disableNormalization:!1}){return new g(this,{...s,imag:e,real:t})}createStereoPanner(){return new v(this)}createWaveShaper(){return new y(this)}decodeAudioData(t,e,s){return h(this._nativeContext,t).then(t=>("function"==typeof e&&e(t),t)).catch(t=>{throw"function"==typeof s&&s(t),t})}})(dn,Ge,Je,us,ds,Cs,As,Ms,Rs,((t,e,s,n,i,o,r,a,c,h,u)=>(l,p)=>{const d=r(l)?l:o(l);if(i.has(p)){const t=s();return Promise.reject(t)}try{i.add(p)}catch{}return e(c,()=>c(d))?d.decodeAudioData(p).then(s=>(e(a,()=>a(s))||u(s),t.add(s),s)):new Promise((e,s)=>{const i=()=>{try{(t=>{const{port1:e}=new MessageChannel;e.postMessage(t,[t])})(p)}catch{}},o=t=>{s(t),i()};try{d.decodeAudioData(p,s=>{"function"!=typeof s.copyFromChannel&&(h(s),C(s)),t.add(s),i(),e(s)},t=>{o(null===t?n():t)})}catch(t){o(t)}})})(Qe,me,()=>new DOMException("","DataCloneError"),()=>new DOMException("","EncodingError"),new WeakSet,Me,fn,S,It,He,$e),qs,Vs,Ns,Bs,Gs,Zs,en,sn,on,an),mn=((t,e,s,n)=>class extends t{constructor(t,i){const o=s(t),r=e(o,i);if(n(o))throw TypeError();super(t,!0,r,null),this._nativeMediaElementAudioSourceNode=r}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(We,(t,e)=>t.createMediaElementSource(e.mediaElement),Me,qe),gn=((t,e,s,n)=>class extends t{constructor(t,i){const o=s(t);if(n(o))throw new TypeError;const r={...Ft,...i},a=e(o,r);super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(We,(t,e)=>{const s=t.createMediaStreamDestination();return Pt(s,e),1===s.numberOfOutputs&&Object.defineProperty(s,"numberOfOutputs",{get:()=>0}),s},Me,qe),vn=((t,e,s,n)=>class extends t{constructor(t,i){const o=s(t),r=e(o,i);if(n(o))throw new TypeError;super(t,!0,r,null),this._nativeMediaStreamAudioSourceNode=r}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(We,(t,{mediaStream:e})=>{const s=e.getAudioTracks();s.sort((t,e)=>t.id<e.id?-1:t.id>e.id?1:0);const n=s.slice(0,1),i=t.createMediaStreamSource(new MediaStream(n));return Object.defineProperty(i,"mediaStream",{value:e}),i},Me,qe),yn=((t,e,s)=>class extends t{constructor(t,n){const i=s(t);super(t,!0,e(i,n),null)}})(We,((t,e)=>(s,{mediaStreamTrack:n})=>{if("function"==typeof s.createMediaStreamTrackSource)return s.createMediaStreamTrackSource(n);const i=new MediaStream([n]),o=s.createMediaStreamSource(i);if("audio"!==n.kind)throw t();if(e(s))throw new TypeError;return o})(Mt,qe),Me),xn=((t,e,s,n,i,o,r,a,c)=>class extends t{constructor(t={}){if(null===c)throw new Error("Missing the native AudioContext constructor.");const e=new c(t);if(null===e)throw n();if(!z(t.latencyHint))throw new TypeError(`The provided value \'${t.latencyHint}\' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw s();super(e,2);const{latencyHint:i}=t,{sampleRate:o}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===i?512/o:"interactive"===i||void 0===i?256/o:"playback"===i?1024/o:128*Math.max(2,Math.min(128,Math.round(i*o/128)))/o,this._nativeAudioContext=e,"webkitAudioContext"===c.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw e()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then(()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),L(this)}))}createMediaElementSource(t){return new i(this,{mediaElement:t})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(t){return new r(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise((t,e)=>{const s=()=>{this._nativeAudioContext.removeEventListener("statechange",s),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",s)}):this._nativeAudioContext.resume().catch(t=>{if(void 0===t||15===t.code)throw e();throw t})}suspend(){return this._nativeAudioContext.suspend().catch(t=>{if(void 0===t)throw e();throw t})}})(_n,Mt,Kt,oe,mn,gn,vn,yn,Pe),wn=(bn=Us,t=>{const e=bn.get(t);if(void 0===e)throw new Error("The context has no set of AudioWorkletNodes.");return e});var bn;const Tn=(Sn=wn,(t,e)=>{Sn(t).add(e)});var Sn;const kn=(t=>(e,s,n=0,i=0)=>{const o=e[n];if(void 0===o)throw t();return nt(s)?o.connect(s,0,i):o.connect(s,0)})(k),Cn=(t=>(e,s)=>{t(e).delete(s)})(wn),An=(t=>(e,s,n,i=0)=>void 0===s?e.forEach(t=>t.disconnect()):"number"==typeof s?At(t,e,s).disconnect():nt(s)?void 0===n?e.forEach(t=>t.disconnect(s)):void 0===i?At(t,e,n).disconnect(s,0):At(t,e,n).disconnect(s,0,i):void 0===n?e.forEach(t=>t.disconnect(s)):At(t,e,n).disconnect(s,0))(k),Dn=new WeakMap,On=((t,e)=>s=>e(t,s))(Dn,E),Mn=((t,e,s,n,i,o,r,a,c,h,u,l,p)=>(d,f,_,g)=>{if(0===g.numberOfInputs&&0===g.numberOfOutputs)throw c();const v=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(v.some(t=>t<1))throw c();if(v.length!==g.numberOfOutputs)throw e();if("explicit"!==g.channelCountMode)throw c();const y=g.channelCount*g.numberOfInputs,x=v.reduce((t,e)=>t+e,0),w=void 0===_.parameterDescriptors?0:_.parameterDescriptors.length;if(y+w>6||x>6)throw c();const b=new MessageChannel,T=[],S=[];for(let t=0;t<g.numberOfInputs;t+=1)T.push(r(d,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),S.push(i(d,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const k=[];if(void 0!==_.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:s,name:n}of _.parameterDescriptors){const i=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==g.parameterData[n]?g.parameterData[n]:void 0===t?0:t});Object.defineProperties(i.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?O:e},minValue:{get:()=>void 0===s?D:s}}),k.push(i)}const C=n(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+w)}),A=Wt(f,d.sampleRate),M=a(d,A,y+w,Math.max(1,x)),E=i(d,{channelCount:Math.max(1,x),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,x)}),R=[];for(let t=0;t<g.numberOfOutputs;t+=1)R.push(n(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[t]}));for(let t=0;t<g.numberOfInputs;t+=1){T[t].connect(S[t]);for(let e=0;e<g.channelCount;e+=1)S[t].connect(C,e,t*g.channelCount+e)}const q=new _t(void 0===_.parameterDescriptors?[]:_.parameterDescriptors.map(({name:t},e)=>{const s=k[e];return s.connect(C,0,y+e),s.start(0),[t,s.offset]}));C.connect(M);let F=g.channelInterpretation,I=null;const V=0===g.numberOfOutputs?[M]:R,N={get bufferSize(){return A},get channelCount(){return g.channelCount},set channelCount(t){throw s()},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){throw s()},get channelInterpretation(){return F},set channelInterpretation(t){for(const e of T)e.channelInterpretation=t;F=t},get context(){return M.context},get inputs(){return T},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return I},set onprocessorerror(t){"function"==typeof I&&N.removeEventListener("processorerror",I),I="function"==typeof t?t:null,"function"==typeof I&&N.addEventListener("processorerror",I)},get parameters(){return q},get port(){return b.port2},addEventListener:(...t)=>M.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,V),disconnect:h.bind(null,V),dispatchEvent:(...t)=>M.dispatchEvent(t[0]),removeEventListener:(...t)=>M.removeEventListener(t[0],t[1],t[2])},P=new Map;var j,L;b.port1.addEventListener=(j=b.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const s=P.get(t[1]);void 0!==s?t[1]=s:(t[1]=t=>{u(d.currentTime,d.sampleRate,()=>e(t))},P.set(e,t[1]))}}return j.call(b.port1,t[0],t[1],t[2])}),b.port1.removeEventListener=(L=b.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=P.get(t[1]);void 0!==e&&(P.delete(t[1]),t[1]=e)}return L.call(b.port1,t[0],t[1],t[2])});let z=null;Object.defineProperty(b.port1,"onmessage",{get:()=>z,set:t=>{"function"==typeof z&&b.port1.removeEventListener("message",z),z="function"==typeof t?t:null,"function"==typeof z&&(b.port1.addEventListener("message",z),b.port1.start())}}),_.prototype.port=b.port1;let B=null;((t,e,s,n)=>{let i=m.get(t);void 0===i&&(i=new WeakMap,m.set(t,i));const o=Ut(s,n);return i.set(e,o),o})(d,N,_,g).then(t=>B=t);const W=yt(g.numberOfInputs,g.channelCount),U=yt(g.numberOfOutputs,v),G=void 0===_.parameterDescriptors?[]:_.parameterDescriptors.reduce((t,{name:e})=>({...t,[e]:new Float32Array(128)}),{});let Q=!0;const Z=()=>{g.numberOfOutputs>0&&M.disconnect(E);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const s=R[t];for(let n=0;n<v[t];n+=1)E.disconnect(s,e+n,n);e+=v[t]}};M.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==B)for(let s=0;s<A;s+=128){for(let e=0;e<g.numberOfInputs;e+=1)for(let n=0;n<g.channelCount;n+=1)gt(t,W[e],n,n,s);void 0!==_.parameterDescriptors&&_.parameterDescriptors.forEach(({name:e},n)=>{gt(t,G,e,y+n,s)});for(let t=0;t<g.numberOfInputs;t+=1)for(let e=0;e<v[t];e+=1)0===U[t][e].byteLength&&(U[t][e]=new Float32Array(128));try{const t=l(N),n=W.map((e,s)=>t[s].size>0?e:[]),i=u(d.currentTime+s/d.sampleRate,d.sampleRate,()=>B.process(n,U,G));Q=i;for(let t=0,n=0;t<g.numberOfOutputs;t+=1){for(let i=0;i<v[t];i+=1)vt(e,U[t],i,n+i,s);n+=v[t]}}catch(t){Q=!1,N.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!Q){for(let t=0;t<g.numberOfInputs;t+=1){T[t].disconnect(S[t]);for(let e=0;e<g.channelCount;e+=1)S[s].disconnect(C,e,t*g.channelCount+e)}if(void 0!==_.parameterDescriptors){const t=_.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=k[e];t.disconnect(C,0,y+e),t.stop()}}C.disconnect(M),M.onaudioprocess=null,X?Z():$();break}}};let X=!1;const Y=r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),H=()=>M.connect(Y).connect(d.destination),$=()=>{M.disconnect(Y),Y.disconnect()};return H(),p(N,()=>{if(Q){$(),g.numberOfOutputs>0&&M.connect(E);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const s=R[t];for(let n=0;n<v[t];n+=1)E.connect(s,e+n,n);e+=v[t]}}X=!0},()=>{Q&&(H(),Z()),X=!1})})(kn,k,Mt,ks,Qt,Os,Yt,Jt,Kt,An,hn,On,ws),En=((t,e,s,n,i)=>(o,r,a,c,h,u)=>{if(null!==a)try{const e=new a(o,c,u),n=new Map;let r=null;if(Object.defineProperties(e,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>r,set:t=>{"function"==typeof r&&e.removeEventListener("processorerror",r),r="function"==typeof t?t:null,"function"==typeof r&&e.addEventListener("processorerror",r)}}}),e.addEventListener=(p=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const s=n.get(t[1]);void 0!==s?t[1]=s:(t[1]=s=>{"error"===s.type?(Object.defineProperties(s,{type:{value:"processorerror"}}),e(s)):e(new ErrorEvent(t[0],{...s}))},n.set(e,t[1]))}}return p.call(e,"error",t[1],t[2]),p.call(e,...t)}),e.removeEventListener=(l=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=n.get(t[1]);void 0!==e&&(n.delete(t[1]),t[1]=e)}return l.call(e,"error",t[1],t[2]),l.call(e,t[0],t[1],t[2])}),0!==u.numberOfOutputs){const t=s(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(o.destination);return i(e,()=>t.disconnect(),()=>t.connect(o.destination))}return e}catch(t){if(11===t.code)throw n();throw t}var l,p;if(void 0===h)throw n();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(u),e(o,r,h,u)})(Mt,Mn,Yt,Kt,ws),Rn=((t,e,s,n,i,o,r,a,c,h,u,l,p,d,f,_)=>(m,g,v)=>{const y=new WeakMap;let x=null;return{render(w,b,S){a(b,w);const k=y.get(b);return void 0!==k?Promise.resolve(k):(async(a,w,b)=>{let S=u(a),k=null;const C=T(S,w),A=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(null===l){const t=A.reduce((t,e)=>t+e,0),s=i(w,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),o=[];for(let t=0;t<a.numberOfOutputs;t+=1)o.push(n(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:A[t]}));const h=r(w,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});h.connect=e.bind(null,o),h.disconnect=c.bind(null,o),k=[s,o,h]}else C||(S=new l(w,m));if(y.set(w,null===k?S:k[2]),null!==k){if(null===x){if(void 0===v)throw new Error("Missing the processor constructor.");if(null===p)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===v.parameterDescriptors?0:v.parameterDescriptors.length,s=t+e,c=async()=>{const c=new p(s,128*Math.ceil(a.context.length/128),w.sampleRate),h=[],u=[];for(let t=0;t<g.numberOfInputs;t+=1)h.push(r(c,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),u.push(i(c,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const l=await Promise.all(Array.from(a.parameters.values()).map(async t=>{const e=o(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await d(c,t,e.offset,b),e})),m=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<g.numberOfInputs;t+=1){h[t].connect(u[t]);for(let e=0;e<g.channelCount;e+=1)u[t].connect(m,e,t*g.channelCount+e)}for(const[e,s]of l.entries())s.connect(m,0,t+e),s.start(0);return m.connect(c.destination),await Promise.all(h.map(t=>f(a,c,t,b))),_(c)};x=xt(a,0===s?null:await c(),w,g,A,v,h)}const t=await x,e=s(w,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[c,u,l]=k;null!==t&&(e.buffer=t,e.start(0)),e.connect(c);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const s=u[t];for(let n=0;n<A[t];n+=1)c.connect(s,e+n,n);e+=A[t]}return l}if(C)for(const[e,s]of a.parameters.entries())await t(w,s,S.parameters.get(e),b);else for(const[t,e]of a.parameters.entries())await d(w,e,S.parameters.get(t),b);return await f(a,w,S,b),S})(w,b,S)}}})(ns,kn,is,ks,Qt,Os,Yt,Cn,An,hn,X,pn,Re,rs,ke,js),qn=(t=>e=>t.get(e))(un),Fn=(t=>(e,s)=>{t.set(e,s)})(Dn),In=cn?((t,e,s,n,i,o,r,a,c,h,u,l,p)=>class extends e{constructor(e,p,d){var f;const m=a(e),g=c(m),v=u({...mt,...d}),y=_.get(m),x=null==y?void 0:y.get(p),w=g||"closed"!==m.state?m:null!==(f=r(m))&&void 0!==f?f:m,b=i(w,g?null:e.baseLatency,h,p,x,v);super(e,!0,b,g?n(p,v,x):null);const T=[];b.parameters.forEach((t,e)=>{const n=s(this,g,t);T.push([e,n])}),this._nativeAudioWorkletNode=b,this._onprocessorerror=null,this._parameters=new _t(T),g&&t(m,this);const{activeInputs:S}=o(this);l(b,S)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?p(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const s=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==s&&s===e?t:s}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(Tn,We,cs,Rn,En,N,qn,Me,qe,pn,t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),Fn,_e):void 0,Vn=(((t,e,s,n,i)=>{})(Mt,Kt,oe,Gs,Pe),((t,e)=>(s,n,i)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(s,n,i)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})(Kt,Re)),Nn=((t,e,s,n,i,o,r,a)=>{const c=[];return(h,u)=>s(h).render(h,u,c).then(()=>Promise.all(Array.from(n(u)).map(t=>s(t).render(t,u,c)))).then(()=>i(u)).then(s=>("function"!=typeof s.copyFromChannel?(r(s),C(s)):e(o,()=>o(s))||a(s),t.add(s),s))})(Qe,me,Te,wn,js,S,He,$e),Pn=(((t,e,s,n,i)=>{})(me,Mt,Vn,Gs,Nn),((t,e,s,n,i)=>class extends t{constructor(t,s,i){let o;if("number"==typeof t&&void 0!==s&&void 0!==i)o={length:s,numberOfChannels:t,sampleRate:i};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");o=t}const{length:r,numberOfChannels:a,sampleRate:c}={...te,...o},h=n(a,r,c);e(It,()=>It(h))||h.addEventListener("statechange",(()=>{let t=0;const e=s=>{"running"===this._state&&(t>0?(h.removeEventListener("statechange",e),s.stopImmediatePropagation(),this._waitForThePromiseToSettle(s)):t+=1)};return e})()),super(h,a),this._length=r,this._nativeOfflineAudioContext=h,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(s()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,L(this)}))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout(()=>this._waitForThePromiseToSettle(t))}})(_n,me,Mt,Vn,Nn)),jn=((t,e)=>s=>{const n=t.get(s);return e(n)||e(s)})(p,je),Ln=(zn=h,Bn=ze,t=>zn.has(t)||Bn(t));var zn,Bn;const Wn=(Un=l,Gn=Be,t=>Un.has(t)||Gn(t));var Un,Gn;const Qn=((t,e)=>s=>{const n=t.get(s);return e(n)||e(s)})(p,qe),Zn=()=>(async(t,e,s,n,i,o,r,a,c,h,u,l,p,d,f,_)=>{if(t(e,e)&&t(s,s)&&t(i,i)&&t(o,o)&&t(a,a)&&t(c,c)&&t(h,h)&&t(u,u)&&t(l,l)&&t(p,p)&&t(d,d)){return(await Promise.all([t(n,n),t(r,r),t(f,f),t(_,_)])).every(t=>t)}return!1})(me,(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createBuffer(1,1,44100);if(void 0===e.copyToChannel)return!0;const s=new Float32Array(2);try{e.copyFromChannel(s,0,0)}catch{return!1}return!0})(Re),(t=>()=>{if(null===t)return!1;if(void 0!==t.prototype&&void 0!==t.prototype.close)return!0;const e=new t,s=void 0!==e.close;try{e.close()}catch{}return s})(Pe),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);return new Promise(t=>{let s=!0;const n=n=>{s&&(s=!1,e.startRendering(),t(n instanceof TypeError))};let i;try{i=e.decodeAudioData(null,()=>{},n)}catch(t){n(t)}void 0!==i&&i.catch(n)})})(Re),(t=>()=>{if(null===t)return!1;let e;try{e=new t({latencyHint:"balanced"})}catch{return!1}return e.close(),!0})(Pe),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createGain(),s=e.connect(e)===e;return e.disconnect(e),s})(Re),((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const s=new Blob([\'class A extends AudioWorkletProcessor{process(){this.port.postMessage(0)}}registerProcessor("a",A)\'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,8e3),i=URL.createObjectURL(s);let o=!1;try{await n.audioWorklet.addModule(i);const e=new t(n,"a",{numberOfOutputs:0}),s=n.createOscillator();e.port.onmessage=()=>o=!0,s.connect(e),s.start(0),await n.startRendering(),o||await new Promise(t=>setTimeout(t,5))}catch{}finally{URL.revokeObjectURL(i)}return o})(pn,Re),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createChannelMerger();if("max"===e.channelCountMode)return!0;try{e.channelCount=2}catch{return!0}return!1})(Re),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100);if(void 0===e.createConstantSource)return!0;return e.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY})(Re),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100),s=e.createConvolver();s.buffer=e.createBuffer(1,1,e.sampleRate);try{s.buffer=e.createBuffer(1,1,e.sampleRate)}catch{return!1}return!0})(Re),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createConvolver();try{e.channelCount=1}catch{return!1}return!0})(Re),pe,(t=>()=>null!==t&&t.hasOwnProperty("isSecureContext"))(ye),(t=>()=>{if(null===t)return!1;const e=new t;try{return e.createMediaStreamSource(new MediaStream),!1}catch(t){return!0}})(Pe),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);if(void 0===e.createStereoPanner)return Promise.resolve(!0);if(void 0===e.createConstantSource)return Promise.resolve(!0);const s=e.createConstantSource(),n=e.createStereoPanner();return s.channelCount=1,s.offset.value=1,n.channelCount=1,s.start(),s.connect(n).connect(e.destination),e.startRendering().then(t=>1!==t.getChannelData(0)[0])})(Re),de);function Xn(t,e){if(!t)throw new Error(e)}function Yn(t,e,s=1/0){if(!(e<=t&&t<=s))throw new RangeError(`Value must be within [${e}, ${s}], got: ${t}`)}function Hn(t){t.isOffline||"running"===t.state||ti(\'The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.\')}let $n=console;function Jn(t){$n=t}function Kn(...t){$n.log(...t)}function ti(...t){$n.warn(...t)}function ei(t){return void 0===t}function si(t){return!ei(t)}function ni(t){return"function"==typeof t}function ii(t){return"number"==typeof t}function oi(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function ri(t){return"boolean"==typeof t}function ai(t){return Array.isArray(t)}function ci(t){return"string"==typeof t}function hi(t){return ci(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}const ui="object"==typeof self?self:null,li=ui&&(ui.hasOwnProperty("AudioContext")||ui.hasOwnProperty("webkitAudioContext"));function pi(t,e,s,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,s):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(o<3?i(r):o>3?i(e,s,r):i(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r}function di(t,e,s,n){return new(s||(s=Promise))((function(i,o){function r(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}c((n=n.apply(t,e||[])).next())}))}Object.create;Object.create;class fi{constructor(t,e,s){this._callback=t,this._type=e,this._updateInterval=s,this._createClock()}_createWorker(){const t=new Blob([`\\n\\t\\t\\t// the initial timeout time\\n\\t\\t\\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\\n\\t\\t\\t// onmessage callback\\n\\t\\t\\tself.onmessage = function(msg){\\n\\t\\t\\t\\ttimeoutTime = parseInt(msg.data);\\n\\t\\t\\t};\\n\\t\\t\\t// the tick function which posts a message\\n\\t\\t\\t// and schedules a new tick\\n\\t\\t\\tfunction tick(){\\n\\t\\t\\t\\tsetTimeout(tick, timeoutTime);\\n\\t\\t\\t\\tself.postMessage(\'tick\');\\n\\t\\t\\t}\\n\\t\\t\\t// call tick initially\\n\\t\\t\\ttick();\\n\\t\\t\\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),s=new Worker(e);s.onmessage=this._callback.bind(this),this._worker=s}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function _i(t){return Wn(t)}function mi(t){return Ln(t)}function gi(t){return Qn(t)}function vi(t){return jn(t)}function yi(t){return t instanceof AudioBuffer}function xi(t,e){return"value"===t||_i(e)||mi(e)||yi(e)}function wi(t,...e){if(!e.length)return t;const s=e.shift();if(oi(t)&&oi(s))for(const e in s)xi(e,s[e])?t[e]=s[e]:oi(s[e])?(t[e]||Object.assign(t,{[e]:{}}),wi(t[e],s[e])):Object.assign(t,{[e]:s[e]});return wi(t,...e)}function bi(t,e,s=[],n){const i={},o=Array.from(e);if(oi(o[0])&&n&&!Reflect.has(o[0],n)){Object.keys(o[0]).some(e=>Reflect.has(t,e))||(wi(i,{[n]:o[0]}),s.splice(s.indexOf(n),1),o.shift())}if(1===o.length&&oi(o[0]))wi(i,o[0]);else for(let t=0;t<s.length;t++)si(o[t])&&(i[s[t]]=o[t]);return wi(t,i)}function Ti(t,e){return ei(t)?e:t}function Si(t,e){return e.forEach(e=>{Reflect.has(t,e)&&delete t[e]}),t}\n/**\n * Tone.js\n * @author Yotam Mann\n * @license http://opensource.org/licenses/MIT MIT License\n * @copyright 2014-2019 Yotam Mann\n */class ki{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||ui&&this.toString()===ui.TONE_DEBUG_CLASS)&&Kn(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}ki.version=o;function Ci(t,e){return t>e+1e-6}function Ai(t,e){return Ci(t,e)||Oi(t,e)}function Di(t,e){return t+1e-6<e}function Oi(t,e){return Math.abs(t-e)<1e-6}function Mi(t,e,s){return Math.max(Math.min(t,s),e)}class Ei extends ki{constructor(){super(),this.name="Timeline",this._timeline=[];const t=bi(Ei.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(Xn(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];Xn(Ai(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const s=this._search(t,e);return-1!==s?this._timeline[s]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const s=this._search(t,e);return s+1<this._timeline.length?this._timeline[s+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const s=this._search(t);return s-1>=0?this._timeline[s-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Oi(this._timeline[e].time,t)){for(let s=e;s>=0&&Oi(this._timeline[s].time,t);s--)e=s;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&Ai(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let s=0;const n=this._timeline.length;let i=n;if(n>0&&this._timeline[n-1][e]<=t)return n-1;for(;s<i;){let n=Math.floor(s+(i-s)/2);const o=this._timeline[n],r=this._timeline[n+1];if(Oi(o[e],t)){for(let s=n;s<this._timeline.length;s++){if(!Oi(this._timeline[s][e],t))break;n=s}return n}if(Di(o[e],t)&&Ci(r[e],t))return n;Ci(o[e],t)?i=n:s=n+1}return-1}_iterate(t,e=0,s=this._timeline.length-1){this._timeline.slice(e,s+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const s=this._search(t);return-1!==s&&this._iterate(e,0,s),this}forEachAfter(t,e){const s=this._search(t);return this._iterate(e,s+1),this}forEachBetween(t,e,s){let n=this._search(t),i=this._search(e);return-1!==n&&-1!==i?(this._timeline[n].time!==t&&(n+=1),this._timeline[i].time===e&&(i-=1),this._iterate(s,n,i)):-1===n&&this._iterate(s,0,i),this}forEachFrom(t,e){let s=this._search(t);for(;s>=0&&this._timeline[s].time>=t;)s--;return this._iterate(e,s+1),this}forEachAtTime(t,e){const s=this._search(t);if(-1!==s&&Oi(this._timeline[s].time,t)){let n=s;for(let e=s;e>=0&&Oi(this._timeline[e].time,t);e--)n=e;this._iterate(t=>{e(t)},n,s)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Ri=[];function qi(t){Ri.push(t)}const Fi=[];function Ii(t){Fi.push(t)}class Vi extends ki{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\\W+/).forEach(t=>{ei(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)}),this}once(t,e){const s=(...n)=>{e(...n),this.off(t,s)};return this.on(t,s),this}off(t,e){return t.split(/\\W+/).forEach(s=>{if(ei(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(ei(e))this._events[t]=[];else{const s=this._events[t];for(let t=s.length-1;t>=0;t--)s[t]===e&&s.splice(t,1)}}),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const s=this._events[t].slice(0);for(let t=0,n=s.length;t<n;t++)s[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach(e=>{const s=Object.getOwnPropertyDescriptor(Vi.prototype,e);Object.defineProperty(t.prototype,e,s)})}dispose(){return super.dispose(),this._events=void 0,this}}class Ni extends Vi{constructor(){super(...arguments),this.isOffline=!1}}class Pi extends Ni{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Ei,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=bi(Pi.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new xn(t)}({latencyHint:t.latencyHint}),this._ticker=new fi(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,Ri.forEach(e=>e(t)),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,s){return this._context.createBuffer(t,e,s)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,s){return this._context.createPeriodicWave(t,e,s)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){Xn(vi(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaStreamDestination(){Xn(vi(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){Xn(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){Xn(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){Xn(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){Xn(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,s){return Xn(si(In),"This node only works in a secure context (https or localhost)"),new In(t,e,s)}\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */(this.rawContext,t,e)}addAudioWorkletModule(t,e){return di(this,void 0,void 0,(function*(){Xn(si(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return di(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach(e=>t.push(e)),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,ci(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return"suspended"===this._context.state&&vi(this._context)?this._context.resume():Promise.resolve()}close(){return di(this,void 0,void 0,(function*(){var t;vi(this._context)&&(yield this._context.close()),this._initialized&&(t=this,Fi.forEach(e=>e(t)))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),s=e.getChannelData(0);for(let e=0;e<s.length;e++)s[e]=t;const n=this._context.createBufferSource();return n.channelCount=1,n.channelCountMode="explicit",n.buffer=e,n.loop=!0,n.start(0),this._constants.set(t,n),n}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=>this._constants[t].disconnect()),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const s=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:s+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach(e=>{e.id===t&&this._timeouts.remove(e)}),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const s=++this._timeoutIds,n=()=>{const i=this.now();this._timeouts.add({callback:()=>{t(),n()},id:s,time:i+e})};return n(),s}}function ji(t,e){ai(e)?e.forEach(e=>ji(t,e)):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function Li(t,e){ai(e)?e.forEach(e=>Li(t,e)):Object.defineProperty(t,e,{writable:!0})}const zi=()=>{};class Bi extends ki{constructor(){super(),this.name="ToneAudioBuffer",this.onload=zi;const t=bi(Bi.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&yi(t.url)||t.url instanceof Bi?this.set(t.url):ci(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:zi,onload:zi,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Qi().sampleRate}set(t){return t instanceof Bi?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return di(this,void 0,void 0,(function*(){const e=Bi.load(t).then(t=>{this.set(t),this.onload(this)});Bi.downloads.push(e);try{yield e}finally{const t=Bi.downloads.indexOf(e);Bi.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=ai(t)&&t[0].length>0,s=e?t.length:1,n=e?t[0].length:t.length,i=Qi(),o=i.createBuffer(s,n,i.sampleRate),r=e||1!==s?t:[t];for(let t=0;t<s;t++)o.copyToChannel(r[t],t);return this._buffer=o,this}toMono(t){if(ii(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let s=0;s<e;s++){const e=this.toArray(s);for(let s=0;s<e.length;s++)t[s]+=e[s]}t=t.map(t=>t/e),this.fromArray(t)}return this}toArray(t){if(ii(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const s=Math.floor(t*this.sampleRate),n=Math.floor(e*this.sampleRate);Xn(s<n,"The start time must be less than the end time");const i=n-s,o=Qi().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)o.copyToChannel(this.getChannelData(t).subarray(s,n),t);return new Bi(o)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new Bi).fromArray(t)}static fromUrl(t){return di(this,void 0,void 0,(function*(){const e=new Bi;return yield e.load(t)}))}static load(t){return di(this,void 0,void 0,(function*(){const e=t.match(/\\[(.+\\|?)+\\]$/);if(e){const s=e[1].split("|");let n=s[0];for(const t of s)if(Bi.supportsType(t)){n=t;break}t=t.replace(e[0],n)}const s=""===Bi.baseUrl||Bi.baseUrl.endsWith("/")?Bi.baseUrl:Bi.baseUrl+"/",n=yield fetch(s+t);if(!n.ok)throw new Error("could not load url: "+t);const i=yield n.arrayBuffer();return yield Qi().decodeAudioData(i)}))}static supportsType(t){const e=t.split("."),s=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+s)}static loaded(){return di(this,void 0,void 0,(function*(){for(yield Promise.resolve();Bi.downloads.length;)yield Bi.downloads[0]}))}}Bi.baseUrl="",Bi.downloads=[];class Wi extends Pi{constructor(){var t,e,s;super({clockSource:"offline",context:gi(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],s=arguments[2],new Pn(t,e,s)),lookAhead:0,updateInterval:gi(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=gi(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return di(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const s=Math.floor(this.sampleRate/128);t&&e%s==0&&(yield new Promise(t=>setTimeout(t,1)))}}))}render(t=!0){return di(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new Bi(e)}))}close(){return Promise.resolve()}}const Ui=new class extends Ni{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,s){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,s){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return di(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let Gi=Ui;function Qi(){return Gi===Ui&&li&&Zi(new Pi),Gi}function Zi(t){Gi=vi(t)?new Pi(t):gi(t)?new Wi(t):t}function Xi(){return Gi.resume()}if(ui&&!ui.TONE_SILENCE_LOGGING){let t="v";"dev"===o&&(t="");const e=` * Tone.js ${t}${o} * `;console.log("%c"+e,"background: #000; color: #fff")}function Yi(t){return Math.pow(10,t/20)}function Hi(t){return Math.log(t)/Math.LN10*20}function $i(t){return Math.pow(2,t/12)}let Ji=440;function Ki(t){return Math.round(to(t))}function to(t){return 69+12*Math.log2(t/Ji)}function eo(t){return Ji*Math.pow(2,(t-69)/12)}class so extends ki{constructor(t,e,s){super(),this.defaultUnits="s",this._val=e,this._units=s,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\\d+(?:\\.\\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\\d+)m$/i},n:{method:(t,e)=>{const s=parseInt(t,10),n="."===e?1.5:1;return 1===s?this._beatsToUnits(this._getTimeSignature())*n:this._beatsToUnits(4/s)*n},regexp:/^(\\d+)n(\\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\\d+(?:\\.\\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\\d+(?:\\.\\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\\d+)t$/i},tr:{method:(t,e,s)=>{let n=0;return t&&"0"!==t&&(n+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(n+=this._beatsToUnits(parseFloat(e))),s&&"0"!==s&&(n+=this._beatsToUnits(parseFloat(s)/4)),n},regexp:/^(\\d+(?:\\.\\d+)?):(\\d+(?:\\.\\d+)?):?(\\d+(?:\\.\\d+)?)?$/}}}valueOf(){if(this._val instanceof so&&this.fromType(this._val),ei(this._val))return this._noArg();if(ci(this._val)&&ei(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(oi(this._val)){let t=0;for(const e in this._val)if(si(this._val[e])){const s=this._val[e];t+=new this.constructor(this.context,e).valueOf()*s}return t}if(si(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return ci(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class no extends so{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\\+(.+)/},quantize:{method:t=>{const e=new no(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const s=new this.constructor(this.context,t).valueOf(),n=this.valueOf();return n+(Math.round(n/s)*s-n)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const s=Math.pow(2,t);e.push(s+"n."),e.push(s+"n"),e.push(s+"t")}e.push("0");let s=e[0],n=new no(this.context,e[0]).toSeconds();return e.forEach(e=>{const i=new no(this.context,e).toSeconds();Math.abs(i-t)<Math.abs(n-t)&&(s=e,n=i)}),s}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const s=Math.floor(e/this._getTimeSignature());let n=e%1*4;e=Math.floor(e)%this._getTimeSignature();const i=n.toString();i.length>3&&(n=parseFloat(parseFloat(i).toFixed(3)));return[s,e,n].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return Ki(this.toFrequency())}_now(){return this.context.now()}}function io(t,e){return new no(Qi(),t,e)}class oo extends no{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return Ji}static set A4(t){!function(t){Ji=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\\d+(?:\\.\\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:oo.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const s=ro[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?s:oo.mtof(s)}},tr:{regexp:/^(\\d+(?:\\.\\d+)?):(\\d+(?:\\.\\d+)?):?(\\d+(?:\\.\\d+)?)?/,method(t,e,s){let n=1;return t&&"0"!==t&&(n*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(n*=this._beatsToUnits(parseFloat(e))),s&&"0"!==s&&(n*=this._beatsToUnits(parseFloat(s)/4)),n}}})}transpose(t){return new oo(this.context,this.valueOf()*$i(t))}harmonize(t){return t.map(t=>this.transpose(t))}toMidi(){return Ki(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/oo.A4);let s=Math.round(12*e)+57;const n=Math.floor(s/12);n<0&&(s+=-12*n);return ao[s%12]+n.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return eo(t)}static ftom(t){return Ki(t)}}const ro={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},ao=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function co(t,e){return new oo(Qi(),t,e)}class ho extends no{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}function uo(t,e){return new ho(Qi(),t,e)}class lo extends ki{constructor(){super();const t=bi(lo.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Qi()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new no(this.context,t).toSeconds()}toFrequency(t){return new oo(this.context,t).toFrequency()}toTicks(t){return new ho(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach(s=>{ei(t[s])&&delete e[s]}),e}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach(e=>{if(Reflect.has(this,e)){const s=this[e];si(s)&&si(s.value)&&si(s.setValueAtTime)?t[e]=s.value:s instanceof lo?t[e]=s._getPartialProperties(t[e]):ai(s)||ii(s)||ci(s)||ri(s)?t[e]=s:delete t[e]}}),t}set(t){return Object.keys(t).forEach(e=>{Reflect.has(this,e)&&si(this[e])&&(this[e]&&si(this[e].value)&&si(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof lo?this[e].set(t[e]):this[e]=t[e])}),this}}class po extends Ei{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,s){return Yn(e,0),this.add(Object.assign({},s,{state:t,time:e})),this}getLastState(t,e){for(let s=this._search(e);s>=0;s--){const e=this._timeline[s];if(e.state===t)return e}}getNextState(t,e){const s=this._search(e);if(-1!==s)for(let e=s;e<this._timeline.length;e++){const s=this._timeline[e];if(s.state===t)return s}}}class fo extends lo{constructor(){super(bi(fo.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=bi(fo.getDefaults(),arguments,["param","units","convert"]);for(Xn(si(t.param)&&(_i(t.param)||t.param instanceof fo),"param must be an AudioParam");!_i(t.param);)t.param=t.param._param;this._swappable=!!si(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Ei(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,si(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(lo.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return si(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return si(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return si(this.maxValue)&&si(this.minValue)&&Yn(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?Yi(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&"decibels"===this.units?Hi(t):t}setValueAtTime(t,e){const s=this.toSeconds(e),n=this._fromType(t);return Xn(isFinite(n)&&isFinite(s),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this.log(this.units,"setValueAtTime",t,s),this._events.add({time:s,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,s),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),s=this._events.getAfter(e),n=this._events.get(e);let i=this._initialValue;if(null===n)i=this._initialValue;else if("setTargetAtTime"!==n.type||null!==s&&"setValueAtTime"!==s.type)if(null===s)i=n.value;else if("linearRampToValueAtTime"===s.type||"exponentialRampToValueAtTime"===s.type){let t=n.value;if("setTargetAtTime"===n.type){const e=this._events.getBefore(n.time);t=null===e?this._initialValue:e.value}i="linearRampToValueAtTime"===s.type?this._linearInterpolate(n.time,t,s.time,s.value,e):this._exponentialInterpolate(n.time,t,s.time,s.value,e)}else i=n.value;else{const t=this._events.getBefore(n.time);let s;s=null===t?this._initialValue:t.value,"setTargetAtTime"===n.type&&(i=this._exponentialApproach(n.time,s,n.value,n.constant,e))}return this._toType(i)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const s=this._fromType(t),n=this.toSeconds(e);return Xn(isFinite(s)&&isFinite(n),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(s),this._events.add({time:n,type:"linearRampToValueAtTime",value:s}),this.log(this.units,"linearRampToValueAtTime",t,n),this._param.linearRampToValueAtTime(s,n),this}exponentialRampToValueAtTime(t,e){let s=this._fromType(t);s=Math.max(this._minOutput,s),this._assertRange(s);const n=this.toSeconds(e);return Xn(isFinite(s)&&isFinite(n),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:n,type:"exponentialRampToValueAtTime",value:s}),this.log(this.units,"exponentialRampToValueAtTime",t,n),this._param.exponentialRampToValueAtTime(s,n),this}exponentialRampTo(t,e,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialRampToValueAtTime(t,s+this.toSeconds(e)),this}linearRampTo(t,e,s){return s=this.toSeconds(s),this.setRampPoint(s),this.linearRampToValueAtTime(t,s+this.toSeconds(e)),this}targetRampTo(t,e,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialApproachValueAtTime(t,s,e),this}exponentialApproachValueAtTime(t,e,s){e=this.toSeconds(e),s=this.toSeconds(s);const n=Math.log(s+1)/Math.log(200);return this.setTargetAtTime(t,e,n),this.cancelAndHoldAtTime(e+.9*s),this.linearRampToValueAtTime(t,e+s),this}setTargetAtTime(t,e,s){const n=this._fromType(t);Xn(isFinite(s)&&s>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(e);return this._assertRange(n),Xn(isFinite(n)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:s,time:i,type:"setTargetAtTime",value:n}),this.log(this.units,"setTargetAtTime",t,i,s),this._param.setTargetAtTime(n,i,s),this}setValueCurveAtTime(t,e,s,n=1){s=this.toSeconds(s),e=this.toSeconds(e);const i=this._fromType(t[0])*n;this.setValueAtTime(this._toType(i),e);const o=s/(t.length-1);for(let s=1;s<t.length;s++){const i=this._fromType(t[s])*n;this.linearRampToValueAtTime(this._toType(i),e+s*o)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return Xn(isFinite(e),"Invalid argument to cancelScheduledValues: "+JSON.stringify(t)),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),s=this._fromType(this.getValueAtTime(e));Xn(isFinite(e),"Invalid argument to cancelAndHoldAtTime: "+JSON.stringify(t)),this.log(this.units,"cancelAndHoldAtTime",e,"value="+s);const n=this._events.get(e),i=this._events.getAfter(e);return n&&Oi(n.time,e)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),"linearRampToValueAtTime"===i.type?this.linearRampToValueAtTime(this._toType(s),e):"exponentialRampToValueAtTime"===i.type&&this.exponentialRampToValueAtTime(this._toType(s),e)),this._events.add({time:e,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,e),this}rampTo(t,e=.1,s){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,s):this.linearRampTo(t,e,s),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const s=this._events.get(e);if(s&&"setTargetAtTime"===s.type){const n=this._events.getAfter(s.time),i=n?n.time:e+2,o=(i-e)/10;for(let s=e;s<i;s+=o)t.linearRampToValueAtTime(this.getValueAtTime(s),s)}return this._events.forEachAfter(this.context.currentTime,e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)}),this}setParam(t){Xn(this._swappable,"The Param must be assigned as \'swappable\' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,s,n,i){return s+(e-s)*Math.exp(-(i-t)/n)}_linearInterpolate(t,e,s,n,i){return e+(i-t)/(s-t)*(n-e)}_exponentialInterpolate(t,e,s,n,i){return e*Math.pow(n/e,(i-t)/(s-t))}}class _o extends lo{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return si(this.input)?_i(this.input)||this.input instanceof fo?1:this.input.numberOfInputs:0}get numberOfOutputs(){return si(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return si(t)&&(t instanceof _o||mi(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach(e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation})}_getChannelProperties(){const t=this._getInternalNodes();Xn(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,s=0){return go(this,t,e,s),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return ti("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,s=0){return vo(this,t,e,s),this}chain(...t){return mo(this,...t),this}fan(...t){return t.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),si(this.input)&&(this.input instanceof _o?this.input.dispose():mi(this.input)&&this.input.disconnect()),si(this.output)&&(this.output instanceof _o?this.output.dispose():mi(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function mo(...t){const e=t.shift();t.reduce((t,e)=>(t instanceof _o?t.connect(e):mi(t)&&go(t,e),e),e)}function go(t,e,s=0,n=0){for(Xn(si(t),"Cannot connect from undefined node"),Xn(si(e),"Cannot connect to undefined node"),(e instanceof _o||mi(e))&&Xn(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Xn(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof _o||e instanceof fo;)si(e.input)&&(e=e.input);for(;t instanceof _o;)si(t.output)&&(t=t.output);_i(e)?t.connect(e,s):t.connect(e,s,n)}function vo(t,e,s=0,n=0){if(si(e))for(;e instanceof _o;)e=e.input;for(;!mi(t);)si(t.output)&&(t=t.output);_i(e)?t.disconnect(e,s):mi(e)?t.disconnect(e,s,n):t.disconnect()}class yo extends _o{constructor(){super(bi(yo.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=bi(yo.getDefaults(),arguments,["gain","units"]);this.gain=new fo({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),ji(this,"gain")}static getDefaults(){return Object.assign(_o.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class xo extends _o{constructor(t){super(t),this.onended=zi,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new yo({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(_o.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:zi})}_startGain(t,e=1){Xn(-1===this._startTime,"Source cannot be started more than once");const s=this.toSeconds(this._fadeIn);return this._startTime=t+s,this._startTime=Math.max(this._startTime,this.context.currentTime),s>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+s):this._gainNode.gain.exponentialApproachValueAtTime(e,t,s)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){Xn(-1!==this._startTime,"\'start\' must be called before \'stop\'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==zi&&(this.onended(this),this.onended=zi,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Xn(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class wo extends xo{constructor(){super(bi(wo.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=bi(wo.getDefaults(),arguments,["offset"]);go(this._source,this._gainNode),this.offset=new fo({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(xo.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class bo extends _o{constructor(){super(bi(bo.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=bi(bo.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new wo({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(_o.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,s=0){return To(this,t,e,s),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,s){return this._param.exponentialRampTo(t,e,s),this}linearRampTo(t,e,s){return this._param.linearRampTo(t,e,s),this}targetRampTo(t,e,s){return this._param.targetRampTo(t,e,s),this}exponentialApproachValueAtTime(t,e,s){return this._param.exponentialApproachValueAtTime(t,e,s),this}setTargetAtTime(t,e,s){return this._param.setTargetAtTime(t,e,s),this}setValueCurveAtTime(t,e,s,n){return this._param.setValueCurveAtTime(t,e,s,n),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,s){return this._param.rampTo(t,e,s),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function To(t,e,s,n){(e instanceof fo||_i(e)||e instanceof bo&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof bo&&(e.overridden=!0)),go(t,e,s,n)}class So extends fo{constructor(){super(bi(So.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Ei(1/0),this._multiplier=1;const t=bi(So.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(fo.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,s){e=this.toSeconds(e),this.setRampPoint(e);const n=this._fromType(t),i=this._events.get(e),o=Math.round(Math.max(1/s,1));for(let t=0;t<=o;t++){const o=s*t+e,r=this._exponentialApproach(i.time,i.value,n,s,o);this.linearRampToValueAtTime(this._toType(r),o)}return this}setValueAtTime(t,e){const s=this.toSeconds(e);super.setValueAtTime(t,e);const n=this._events.get(s),i=this._events.previousEvent(n),o=this._getTicksUntilEvent(i,s);return n.ticks=Math.max(o,0),this}linearRampToValueAtTime(t,e){const s=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const n=this._events.get(s),i=this._events.previousEvent(n),o=this._getTicksUntilEvent(i,s);return n.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const s=this._fromType(t),n=this._events.get(e),i=Math.round(Math.max(10*(e-n.time),1)),o=(e-n.time)/i;for(let t=0;t<=i;t++){const i=o*t+n.time,r=this._exponentialInterpolate(n.time,n.value,e,s,i);this.linearRampToValueAtTime(this._toType(r),i)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(ei(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const s=this._fromType(this.getValueAtTime(t.time));let n=this._fromType(this.getValueAtTime(e));const i=this._events.get(e);return i&&i.time===e&&"setValueAtTime"===i.type&&(n=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(s+n)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),s=this._events.get(e);return Math.max(this._getTicksUntilEvent(s,e),0)}getDurationOfTicks(t,e){const s=this.toSeconds(e),n=this.getTicksAtTime(e);return this.getTimeOfTick(n+t)-s}getTimeOfTick(t){const e=this._events.get(t,"ticks"),s=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&s&&"linearRampToValueAtTime"===s.type&&e.value!==s.value){const n=this._fromType(this.getValueAtTime(e.time)),i=(this._fromType(this.getValueAtTime(s.time))-n)/(s.time-e.time),o=Math.sqrt(Math.pow(n,2)-2*i*(e.ticks-t)),r=(-n+o)/i,a=(-n-o)/i;return(r>0?r:a)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const s=this.toSeconds(e),n=this.toSeconds(t),i=this.getTicksAtTime(s);return this.getTicksAtTime(s+n)-i}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class ko extends bo{constructor(){super(bi(ko.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=bi(ko.getDefaults(),arguments,["value"]);this.input=this._param=new So({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(bo.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class Co extends lo{constructor(){super(bi(Co.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new po,this._tickOffset=new Ei;const t=bi(Co.getDefaults(),arguments,["frequency"]);this.frequency=new ko({context:this.context,units:t.units,value:t.frequency}),ji(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},lo.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const s=this.toSeconds(t);return"started"!==this._state.getValueAtTime(s)&&(this._state.setStateAtTime("started",s),si(e)&&this.setTicksAtTime(e,s)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),s=this._state.getLastState("stopped",e),n={state:"paused",time:e};this._state.add(n);let i=s,o=0;return this._state.forEachBetween(s.time,e+this.sampleTime,t=>{let e=i.time;const s=this._tickOffset.get(t.time);s&&s.time>=i.time&&(o=s.ticks,e=s.time),"started"===i.state&&"started"!==t.state&&(o+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),i=t}),this._state.remove(n),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),s=this.frequency.timeToTicks(t,e);this.setTicksAtTime(s,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),s={state:"paused",time:t};this._state.add(s);let n=e,i=0;return this._state.forEachBetween(e.time,t+this.sampleTime,t=>{let e=n.time;const s=this._tickOffset.get(t.time);s&&s.time>=n.time&&(i=s.seconds,e=s.time),"started"===n.state&&"started"!==t.state&&(i+=t.time-e),n=t}),this._state.remove(s),i}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const s=this._tickOffset.get(e),n=this._state.get(e),i=Math.max(s.time,n.time),o=this.frequency.getTicksAtTime(i)+t-s.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(t,e,s){let n=this._state.get(t);this._state.forEachBetween(t,e,e=>{n&&"started"===n.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(n.time,t),e.time-this.sampleTime,s),n=e});let i=null;if(n&&"started"===n.state){const o=Math.max(n.time,t),r=this.frequency.getTicksAtTime(o),a=r-this.frequency.getTicksAtTime(n.time);let c=Math.ceil(a)-a;c=Oi(c,1)?0:c;let h=this.frequency.getTimeOfTick(r+c);for(;h<e;){try{s(h,Math.round(this.getTicksAtTime(h)))}catch(t){i=t;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class Ao extends lo{constructor(){super(bi(Ao.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=zi,this._lastUpdate=0,this._state=new po("stopped"),this._boundLoop=this._loop.bind(this);const t=bi(Ao.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new Co({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,ji(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(lo.getDefaults(),{callback:zi,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){Hn(this.context);const s=this.toSeconds(t);return this.log("start",s),"started"!==this._state.getValueAtTime(s)&&(this._state.setStateAtTime("started",s),this._tickSource.start(s,e),s<this._lastUpdate&&this.emit("start",s,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const s=this.toSeconds(e),n=this.getTicksAtTime(s);return this._tickSource.getTimeOfTick(n+t,s)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}}),this._tickSource.forEachTickBetween(t,e,(t,e)=>{this.callback(t,e)}))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Vi.mixin(Ao);class Do extends _o{constructor(){super(bi(Do.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";const t=bi(Do.getDefaults(),arguments,["delayTime","maxDelay"]),e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new fo({context:this.context,param:this._delayNode.delayTime,units:"time",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),ji(this,"delayTime")}static getDefaults(){return Object.assign(_o.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}function Oo(t,e,s=2,n=Qi().sampleRate){return di(this,void 0,void 0,(function*(){const i=Qi(),o=new Wi(s,e,n);Zi(o),yield t(o);const r=o.render();Zi(i);const a=yield r;return new Bi(a)}))}class Mo extends ki{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=bi(Mo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(e=>{this._loadingCount++;const s=t.urls[e];this.add(e,s,this._bufferLoaded.bind(this,t.onload),t.onerror)})}static getDefaults(){return{baseUrl:"",onerror:zi,onload:zi,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return Xn(this.has(t),"ToneAudioBuffers has no buffer named: "+t),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every(([t,e])=>e.loaded)}add(t,e,s=zi,n=zi){return ci(e)?this._buffers.set(t.toString(),new Bi(this.baseUrl+e,s,n)):this._buffers.set(t.toString(),new Bi(e,s,n)),this}dispose(){return super.dispose(),this._buffers.forEach(t=>t.dispose()),this._buffers.clear(),this}}class Eo extends oo{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return Ki(super._frequencyToUnits(t))}_ticksToUnits(t){return Ki(super._ticksToUnits(t))}_beatsToUnits(t){return Ki(super._beatsToUnits(t))}_secondsToUnits(t){return Ki(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return eo(this.toMidi())}transpose(t){return new Eo(this.context,this.toMidi()+t)}}function Ro(t,e){return new Eo(Qi(),t,e)}class qo extends ho{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}function Fo(t,e){return new qo(Qi(),t,e)}class Io extends lo{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Ei,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}qi(t=>{t.draw=new Io({context:t})}),Ii(t=>{t.draw.dispose()});class Vo extends ki{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){Xn(si(t.time),"Events must have a time property"),Xn(si(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new No(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const s of e)if(s.event===t){this._removeNode(s),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,t=>this.remove(t)),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,s=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,s=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,s=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,s=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,s=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),s&&this._rebalance(s)}t.dispose()}_rotateLeft(t){const e=t.parent,s=t.isLeftChild(),n=t.right;n&&(t.right=n.left,n.left=t),null!==e?s?e.left=n:e.right=n:this._setRoot(n)}_rotateRight(t){const e=t.parent,s=t.isLeftChild(),n=t.left;n&&(t.left=n.right,n.right=t),null!==e?s?e.left=n:e.right=n:this._setRoot(n)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let s=1;s<e.length;s++)e[s].low>t.low&&(t=e[s]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse(t=>e.push(t)),e.forEach(e=>{e.event&&t(e.event)})}return this}forEachAtTime(t,e){if(null!==this._root){const s=[];this._root.search(t,s),s.forEach(t=>{t.event&&e(t.event)})}return this}forEachFrom(t,e){if(null!==this._root){const s=[];this._root.searchAfter(t,s),s.forEach(t=>{t.event&&e(t.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(t=>t.dispose()),this._root=null,this}}class No{constructor(t,e,s){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=s,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Po extends _o{constructor(){super(bi(Po.getDefaults(),arguments,["volume"])),this.name="Volume";const t=bi(Po.getDefaults(),arguments,["volume"]);this.input=this.output=new yo({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,ji(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(_o.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class jo extends _o{constructor(){super(bi(jo.getDefaults(),arguments)),this.name="Destination",this.input=new Po({context:this.context}),this.output=new yo({context:this.context}),this.volume=this.input.volume;const t=bi(jo.getDefaults(),arguments);mo(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(_o.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),mo(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}qi(t=>{t.destination=new jo({context:t})}),Ii(t=>{t.destination.dispose()});class Lo extends ki{constructor(t){super(),this.name="TimelineValue",this._timeline=new Ei({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class zo{constructor(t,e){this.id=zo._eventId++;const s=Object.assign(zo.getDefaults(),e);this.transport=t,this.callback=s.callback,this._once=s.once,this.time=s.time}static getDefaults(){return{callback:zi,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}zo._eventId=0;class Bo extends zo{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const s=Object.assign(Bo.getDefaults(),e);this.duration=new qo(t.context,s.duration).valueOf(),this._interval=new qo(t.context,s.interval).valueOf(),this._nextTick=s.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},zo.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new qo(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new qo(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new qo(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class Wo extends lo{constructor(){super(bi(Wo.getDefaults(),arguments)),this.name="Transport",this._loop=new Lo(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Ei,this._repeatedEvents=new Vo,this._syncedSignals=[],this._swingAmount=0;const t=bi(Wo.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new Ao({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),ji(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(lo.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const s=e%(2*this._swingTicks)/(2*this._swingTicks),n=Math.sin(s*Math.PI)*this._swingAmount;t+=new qo(this.context,2*this._swingTicks/3).toSeconds()*n}this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._timeline.forEachAtTime(e,e=>e.invoke(t))}schedule(t,e){const s=new zo(this,{callback:t,time:new ho(this.context,e).toTicks()});return this._addEvent(s,this._timeline)}scheduleRepeat(t,e,s,n=1/0){const i=new Bo(this,{callback:t,duration:new no(this.context,n).toTicks(),interval:new no(this.context,e).toTicks(),time:new ho(this.context,s).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(t,e){const s=new zo(this,{callback:t,once:!0,time:new ho(this.context,e).toTicks()});return this._addEvent(s,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,t=>this.clear(t.id)),this._repeatedEvents.forEachFrom(e,t=>this.clear(t.id)),this}_bindClockEvents(){this._clock.on("start",(t,e)=>{e=new qo(this.context,e).toSeconds(),this.emit("start",t,e)}),this._clock.on("stop",t=>{this.emit("stop",t)}),this._clock.on("pause",t=>{this.emit("pause",t)})}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let s;return si(e)&&(s=this.toTicks(e)),this._clock.start(t,s),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){ai(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new no(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new no(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new qo(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new qo(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),s=this._clock.frequency.timeToTicks(t,e);this.ticks=s}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const s=this._clock.getTicksAtTime(e),n=this._clock.getTimeOfTick(Math.ceil(s));this.emit("stop",n),this._clock.setTicksAtTime(t,n),this.emit("start",n,this._clock.getSecondsAtTime(n))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),s=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(s,e)}}syncSignal(t,e){if(!e){const s=this.now();if(0!==t.getValueAtTime(s)){const n=1/(60/this.bpm.getValueAtTime(s)/this.PPQ);e=t.getValueAtTime(s)/n}else e=0}const s=new yo(e);return this.bpm.connect(s),s.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:s,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const s=this._syncedSignals[e];s.signal===t&&(s.ratio.dispose(),s.signal.value=s.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Li(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Vi.mixin(Wo),qi(t=>{t.transport=new Wo({context:t})}),Ii(t=>{t.transport.dispose()});class Uo extends _o{constructor(t){super(t),this.input=void 0,this._state=new po("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=zi,this._syncedStop=zi,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Po({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,ji(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(_o.getDefaults(),{mute:!1,onstop:zi,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,s){let n=ei(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(n=this._clampToCurrentTime(n),this._synced||"started"!==this._state.getValueAtTime(n))if(this.log("start",n),this._state.setStateAtTime("started",n),this._synced){const t=this._state.get(n);t&&(t.offset=this.toSeconds(Ti(e,0)),t.duration=s?this.toSeconds(s):void 0);const i=this.context.transport.schedule(t=>{this._start(t,e,s)},n);this._scheduled.push(i),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>n&&this._syncedStart(this.now(),this.context.transport.seconds)}else Hn(this.context),this._start(n,e,s);else Xn(Ci(n,this._state.get(n).time),"Start time must be strictly greater than previous start time"),this._state.cancel(n),this._state.setStateAtTime("started",n),this.log("restart",n),this.restart(n,e,s);return this}stop(t){let e=ei(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||si(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,s){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,s)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const s=this._state.get(e);if(s&&"started"===s.state&&s.time!==e){const n=e-this.toSeconds(s.time);let i;s.duration&&(i=this.toSeconds(s.duration)-n),this._start(t,this.toSeconds(s.offset)+n,i)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=>this.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=zi,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Go extends xo{constructor(){super(bi(Go.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=bi(Go.getDefaults(),arguments,["url","onload"]);go(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new fo({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new Bi(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(xo.getDefaults(),{url:new Bi,loop:!1,loopEnd:0,loopStart:0,onload:zi,onerror:zi,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,s,n=1){Xn(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(t);this._startGain(i,n),e=this.loop?Ti(e,this.loopStart):Ti(e,0);let o=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),s=t-e;Ai(o,t)&&(o=(o-e)%s+e),Oi(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Di(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,o)),si(s)){let t=this.toSeconds(s);t=Math.max(t,0),this.stop(i+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class Qo extends Uo{constructor(){super(bi(Qo.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const t=bi(Qo.getDefaults(),arguments,["type"]);this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Uo.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(Xn(t in Xo,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){const e=Xo[this._type];this._source=new Go({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const Zo={brown:null,pink:null,white:null},Xo={get brown(){if(!Zo.brown){const t=[];for(let e=0;e<2;e++){const s=new Float32Array(220500);t[e]=s;let n=0;for(let t=0;t<220500;t++){const e=2*Math.random()-1;s[t]=(n+.02*e)/1.02,n=s[t],s[t]*=3.5}}Zo.brown=(new Bi).fromArray(t)}return Zo.brown},get pink(){if(!Zo.pink){const t=[];for(let e=0;e<2;e++){const s=new Float32Array(220500);let n,i,o,r,a,c,h;t[e]=s,n=i=o=r=a=c=h=0;for(let t=0;t<220500;t++){const e=2*Math.random()-1;n=.99886*n+.0555179*e,i=.99332*i+.0750759*e,o=.969*o+.153852*e,r=.8665*r+.3104856*e,a=.55*a+.5329522*e,c=-.7616*c-.016898*e,s[t]=n+i+o+r+a+c+h+.5362*e,s[t]*=.11,h=.115926*e}}Zo.pink=(new Bi).fromArray(t)}return Zo.pink},get white(){if(!Zo.white){const t=[];for(let e=0;e<2;e++){const s=new Float32Array(220500);t[e]=s;for(let t=0;t<220500;t++)s[t]=2*Math.random()-1}Zo.white=(new Bi).fromArray(t)}return Zo.white}};class Yo extends _o{constructor(){super(bi(Yo.getDefaults(),arguments,["volume"])),this.name="UserMedia";const t=bi(Yo.getDefaults(),arguments,["volume"]);this._volume=this.output=new Po({context:this.context,volume:t.volume}),this.volume=this._volume.volume,ji(this,"volume"),this.mute=t.mute}static getDefaults(){return Object.assign(_o.getDefaults(),{mute:!1,volume:0})}open(t){return di(this,void 0,void 0,(function*(){Xn(Yo.supported,"UserMedia is not supported"),"started"===this.state&&this.close();const e=yield Yo.enumerateDevices();ii(t)?this._device=e[t]:(this._device=e.find(e=>e.label===t||e.deviceId===t),!this._device&&e.length>0&&(this._device=e[0]),Xn(si(this._device),"No matching device "+t));const s={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(s.audio.deviceId=this._device.deviceId);const n=yield navigator.mediaDevices.getUserMedia(s);if(!this._stream){this._stream=n;const t=this.context.createMediaStreamSource(n);go(t,this.output),this._mediaStream=t}return this}))}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(t=>{t.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return di(this,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(t=>"audioinput"===t.kind)}))}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return si(navigator.mediaDevices)&&si(navigator.mediaDevices.getUserMedia)}}function Ho(t,e){return di(this,void 0,void 0,(function*(){const s=e/t.context.sampleRate,n=new Wi(1,s,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/s,detune:0,context:n})).toDestination().start(0);return(yield n.render()).getChannelData(0)}))}class $o extends xo{constructor(){super(bi($o.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=bi($o.getDefaults(),arguments,["frequency","type"]);go(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new fo({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new fo({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),ji(this,["frequency","detune"])}static getDefaults(){return Object.assign(xo.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Jo extends Uo{constructor(){super(bi(Jo.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=bi(Jo.getDefaults(),arguments,["frequency","type"]);this.frequency=new bo({context:this.context,units:"frequency",value:t.frequency}),ji(this,"frequency"),this.detune=new bo({context:this.context,units:"cents",value:t.detune}),ji(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(Uo.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),s=new $o({context:this.context,onended:()=>this.onstop(this)});this._oscillator=s,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return Jo._periodicWaveCache.find(t=>{return t.phase===this._phase&&(e=t.partials,s=this._partials,e.length===s.length&&e.every((t,e)=>s[e]===t));var e,s})}{const t=Jo._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(si(e)){const{partials:t,wave:s}=e;this._wave=s,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,s]=this._getRealImaginary(t,this._phase),n=this.context.createPeriodicWave(e,s);this._wave=n,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),Jo._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),Jo._periodicWaveCache.length>100&&Jo._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){Yn(t,0);let e=this._type;const s=/^(sine|triangle|square|sawtooth)(\\d+)$/.exec(this._type);if(s&&(e=s[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach((t,s)=>e[s]=t),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let s=2048;const n=new Float32Array(s),i=new Float32Array(s);let o=1;if("custom"===t){if(o=this._partials.length+1,this._partialCount=this._partials.length,s=o,0===this._partials.length)return[n,i]}else{const e=/^(sine|triangle|square|sawtooth)(\\d+)$/.exec(t);e?(o=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],o=Math.max(o,2),s=o):this._partialCount=0,this._partials=[]}for(let r=1;r<s;++r){const s=2/(r*Math.PI);let a;switch(t){case"sine":a=r<=o?1:0,this._partials[r-1]=a;break;case"square":a=1&r?2*s:0,this._partials[r-1]=a;break;case"sawtooth":a=s*(1&r?1:-1),this._partials[r-1]=a;break;case"triangle":a=1&r?s*s*2*(r-1>>1&1?-1:1):0,this._partials[r-1]=a;break;case"custom":a=this._partials[r-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(n[r]=-a*Math.sin(e*r),i[r]=a*Math.cos(e*r)):(n[r]=0,i[r]=0)}return[n,i]}_inverseFFT(t,e,s){let n=0;const i=t.length;for(let o=0;o<i;o++)n+=t[o]*Math.cos(o*s)+e[o]*Math.sin(o*s);return n}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let s=0;const n=2*Math.PI;for(let i=0;i<32;i++)s=Math.max(this._inverseFFT(t,e,i/32*n),s);return Mi(-this._inverseFFT(t,e,this._phase)/s,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return di(this,void 0,void 0,(function*(){return Ho(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Jo._periodicWaveCache=[];class Ko extends _o{constructor(){super(Object.assign(bi(Ko.getDefaults(),arguments,["context"])))}connect(t,e=0,s=0){return To(this,t,e,s),this}}class tr extends Ko{constructor(){super(Object.assign(bi(tr.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=bi(tr.getDefaults(),arguments,["mapping","length"]);ai(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):ni(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(bo.getDefaults(),{length:1024})}setMap(t,e=1024){const s=new Float32Array(e);for(let n=0,i=e;n<i;n++){const e=n/(i-1)*2-1;s[n]=t(e,n)}return this.curve=s,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){Xn(["none","2x","4x"].some(e=>e.includes(t)),"oversampling must be either \'none\', \'2x\', or \'4x\'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class er extends Ko{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new tr({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class sr extends bo{constructor(){super(Object.assign(bi(sr.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=bi(sr.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new yo({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(bo.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class nr extends Uo{constructor(){super(bi(nr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new er({context:this.context}),this._modulationNode=new yo({context:this.context});const t=bi(nr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Jo({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Jo({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new sr({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),ji(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Jo.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return di(this,void 0,void 0,(function*(){return Ho(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class ir extends Uo{constructor(){super(bi(ir.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new yo({context:this.context,gain:0});const t=bi(ir.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Jo({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new bo({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new Jo({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new sr({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new sr({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),ji(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Jo.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return di(this,void 0,void 0,(function*(){return Ho(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class or extends Uo{constructor(){super(bi(or.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new yo({context:this.context,gain:0}),this._thresh=new tr({context:this.context,mapping:t=>t<=0?-1:1});const t=bi(or.getDefaults(),arguments,["frequency","width"]);this.width=new bo({context:this.context,units:"audioRange",value:t.width}),this._triangle=new Jo({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),ji(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Uo.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return di(this,void 0,void 0,(function*(){return Ho(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class rr extends Uo{constructor(){super(bi(rr.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=bi(rr.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new bo({context:this.context,units:"frequency",value:t.frequency}),this.detune=new bo({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,ji(this,["frequency","detune"])}static getDefaults(){return Object.assign(Jo.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach(e=>e.start(t))}_stop(t){t=this.toSeconds(t),this._forEach(e=>e.stop(t))}_restart(t){this._forEach(e=>e.restart(t))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach(e=>e.type=t)}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,s=t/(this._oscillators.length-1);this._forEach((t,n)=>t.detune.value=e+s*n)}}get count(){return this._oscillators.length}set count(t){if(Yn(t,1),this._oscillators.length!==t){this._forEach(t=>t.dispose()),this._oscillators=[];for(let e=0;e<t;e++){const s=new Jo({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):zi});"custom"===this.type&&(s.partials=this._partials),this.frequency.connect(s.frequency),this.detune.connect(s.detune),s.detune.overridden=!1,s.connect(this.output),this._oscillators[e]=s}this.spread=this._spread,"started"===this.state&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach((t,e)=>t.phase=this._phase+e/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach(e=>e.baseType=t),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach(e=>e.partials=t))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach(e=>e.partialCount=t),this._type=this._oscillators[0].type}asArray(t=1024){return di(this,void 0,void 0,(function*(){return Ho(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=>t.dispose()),this}}class ar extends Uo{constructor(){super(bi(ar.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new sr({context:this.context,value:2});const t=bi(ar.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new or({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Jo({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),ji(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Uo.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return di(this,void 0,void 0,(function*(){return Ho(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const cr={am:nr,fat:rr,fm:ir,oscillator:Jo,pulse:or,pwm:ar};class hr extends Uo{constructor(){super(bi(hr.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=bi(hr.getDefaults(),arguments,["frequency","type"]);this.frequency=new bo({context:this.context,units:"frequency",value:t.frequency}),this.detune=new bo({context:this.context,units:"cents",value:t.detune}),ji(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(Jo.getDefaults(),ir.getDefaults(),nr.getDefaults(),rr.getDefaults(),or.getDefaults(),ar.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=cr[t],s=this.now();if(this._oscillator){const t=this._oscillator;t.stop(s),this.context.setTimeout(()=>t.dispose(),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(s)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof cr[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&ii(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&ii(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&ci(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return di(this,void 0,void 0,(function*(){return Ho(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class ur extends bo{constructor(){super(Object.assign(bi(ur.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new yo({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,mo(this._constantSource,this._sum)}static getDefaults(){return Object.assign(bo.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class lr extends Ko{constructor(){super(Object.assign(bi(lr.getDefaults(),arguments,["min","max"]))),this.name="Scale";const t=bi(lr.getDefaults(),arguments,["min","max"]);this._mult=this.input=new sr({context:this.context,value:t.max-t.min}),this._add=this.output=new ur({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(Ko.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class pr extends Ko{constructor(){super(Object.assign(bi(pr.getDefaults(),arguments))),this.name="Zero",this._gain=new yo({context:this.context}),this.output=this._gain,this.input=void 0,go(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),vo(this.context.getConstant(0),this._gain),this}}class dr extends _o{constructor(){super(bi(dr.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=fo.prototype._fromType,this._toType=fo.prototype._toType,this._is=fo.prototype._is,this._clampValue=fo.prototype._clampValue;const t=bi(dr.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new Jo({context:this.context,frequency:t.frequency,type:t.type}),this.frequency=this._oscillator.frequency,this._amplitudeGain=new yo({context:this.context,gain:t.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new bo({context:this.context,units:"audioRange",value:0}),this._zeros=new pr({context:this.context}),this._a2g=new er({context:this.context}),this._scaler=this.output=new lr({context:this.context,max:t.max,min:t.min}),this.units=t.units,this.min=t.min,this.max=t.max,this._oscillator.chain(this._a2g,this._amplitudeGain,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),ji(this,["amplitude","frequency"]),this.phase=t.phase}static getDefaults(){return Object.assign(_o.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,phase:0,type:"sine",units:"number"})}start(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}get min(){return this._toType(this._scaler.min)}set min(t){t=this._fromType(t),this._scaler.min=t}get max(){return this._toType(this._scaler.max)}set max(t){t=this._fromType(t),this._scaler.max=t}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get units(){return this._units}set units(t){const e=this.min,s=this.max;this._units=t,this.min=e,this.max=s}get state(){return this._oscillator.state}connect(t,e,s){return(t instanceof fo||t instanceof bo)&&(this.convert=t.convert,this.units=t.units),To(this,t,e,s),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function fr(t,e=1/0){const s=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return s.get(this)},set:function(n){Yn(n,t,e),s.set(this,n)}})}}function _r(t,e=1/0){const s=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return s.get(this)},set:function(n){Yn(this.toSeconds(n),t,e),s.set(this,n)}})}}class mr extends Uo{constructor(){super(bi(mr.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=bi(mr.getDefaults(),arguments,["url","onload"]);this._buffer=new Bi({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Uo.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:zi,onerror:zi,playbackRate:1,reverse:!1})}load(t){return di(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=zi){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,s){return super.start(t,e,s),this}_start(t,e,s){e=this._loop?Ti(e,this._loopStart):Ti(e,0);let n=this.toSeconds(e);this._synced&&(n*=this._playbackRate);const i=s;s=Ti(s,Math.max(this._buffer.duration-n,0));let o=this.toSeconds(s);o/=this._playbackRate,t=this.toSeconds(t);const r=new Go({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+o),this._state.setStateAtTime("stopped",t+o,{implicitEnd:!0})),this._activeSources.add(r),this._loop&&ei(i)?r.start(t,n):r.start(t,n,o-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach(t=>t.stop(e))}restart(t,e,s){return super.restart(t,e,s),this}_restart(t,e,s){this._stop(t),this._start(t,e,s)}seek(t,e){const s=this.toSeconds(e);if("started"===this._state.getValueAtTime(s)){const e=this.toSeconds(t);this._stop(s),this._start(s,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&Yn(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopStart=t})}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&Yn(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopEnd=t})}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(e=>{e.loop=t}),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),s=this._state.getNextState("stopped",e);s&&s.implicitEnd&&(this._state.cancel(s.time),this._activeSources.forEach(t=>t.cancelStop())),this._activeSources.forEach(s=>{s.playbackRate.setValueAtTime(t,e)})}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(t=>t.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}pi([_r(0)],mr.prototype,"fadeIn",void 0),pi([_r(0)],mr.prototype,"fadeOut",void 0);class gr extends _o{constructor(){super(bi(gr.getDefaults(),arguments,["urls","onload"],"urls")),this.name="Players",this.input=void 0,this._players=new Map;const t=bi(gr.getDefaults(),arguments,["urls","onload"],"urls");this._volume=this.output=new Po({context:this.context,volume:t.volume}),this.volume=this._volume.volume,ji(this,"volume"),this._buffers=new Mo({urls:t.urls,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.mute=t.mute,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Uo.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:zi,onerror:zi,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._players.forEach(e=>{e.fadeIn=t})}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._players.forEach(e=>{e.fadeOut=t})}get state(){return Array.from(this._players).some(([t,e])=>"started"===e.state)?"started":"stopped"}has(t){return this._buffers.has(t)}player(t){if(Xn(this.has(t),`No Player with the name ${t} exists on this object`),!this._players.has(t)){const e=new mr({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(t)}).connect(this.output);this._players.set(t,e)}return this._players.get(t)}get loaded(){return this._buffers.loaded}add(t,e,s){return Xn(!this._buffers.has(t),"A buffer with that name already exists on this object"),this._buffers.add(t,e,s),this}stopAll(t){return this._players.forEach(e=>e.stop(t)),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach(t=>t.dispose()),this._buffers.dispose(),this}}class vr extends Uo{constructor(){super(bi(vr.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];const t=bi(vr.getDefaults(),arguments,["url","onload"]);this.buffer=new Bi({onload:t.onload,onerror:t.onerror,reverse:t.reverse,url:t.url}),this._clock=new Ao({context:this.context,callback:this._tick.bind(this),frequency:1/t.grainSize}),this._playbackRate=t.playbackRate,this._grainSize=t.grainSize,this._overlap=t.overlap,this.detune=t.detune,this.overlap=t.overlap,this.loop=t.loop,this.playbackRate=t.playbackRate,this.grainSize=t.grainSize,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.reverse=t.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(Uo.getDefaults(),{onload:zi,onerror:zi,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(t,e,s){e=Ti(e,0),e=this.toSeconds(e),t=this.toSeconds(t);const n=1/this._clock.frequency.getValueAtTime(t);this._clock.start(t,e/n),s&&this.stop(t+this.toSeconds(s))}restart(t,e,s){return super.restart(t,e,s),this}_restart(t,e,s){this._stop(t),this._start(t,e,s)}_stop(t){this._clock.stop(t)}_onstop(t){this._activeSources.forEach(e=>{e.fadeOut=0,e.stop(t)}),this.onstop(this)}_tick(t){const e=this._clock.getTicksAtTime(t),s=e*this._grainSize;if(this.log("offset",s),!this.loop&&s>this.buffer.duration)return void this.stop(t);const n=s<this._overlap?0:this._overlap,i=new Go({context:this.context,url:this.buffer,fadeIn:n,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:$i(this.detune/100)}).connect(this.output);i.start(t,this._grainSize*e),i.stop(t+this._grainSize/this.playbackRate),this._activeSources.push(i),i.onended=()=>{const t=this._activeSources.indexOf(i);-1!==t&&this._activeSources.splice(t,1)}}get playbackRate(){return this._playbackRate}set playbackRate(t){Yn(t,.001),this._playbackRate=t,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(t){this.buffer.loaded&&Yn(this.toSeconds(t),0,this.buffer.duration),this._loopStart=this.toSeconds(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this.buffer.loaded&&Yn(this.toSeconds(t),0,this.buffer.duration),this._loopEnd=this.toSeconds(t)}get reverse(){return this.buffer.reverse}set reverse(t){this.buffer.reverse=t}get grainSize(){return this._grainSize}set grainSize(t){this._grainSize=this.toSeconds(t),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(t){const e=this.toSeconds(t);Yn(e,0),this._overlap=e}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach(t=>t.dispose()),this}}class yr extends Ko{constructor(){super(...arguments),this.name="Abs",this._abs=new tr({context:this.context,mapping:t=>Math.abs(t)<.001?0:Math.abs(t)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class xr extends Ko{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new tr({context:this.context,mapping:t=>2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class wr extends Ko{constructor(){super(...arguments),this.name="Negate",this._multiply=new sr({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}}class br extends bo{constructor(){super(Object.assign(bi(br.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Subtract",this._sum=new yo({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new wr({context:this.context}),this.subtrahend=this._param,mo(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(bo.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}}class Tr extends Ko{constructor(){super(Object.assign(bi(Tr.getDefaults(),arguments))),this.name="GreaterThanZero",this._thresh=this.output=new tr({context:this.context,length:127,mapping:t=>t<=0?0:1}),this._scale=this.input=new sr({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}}class Sr extends bo{constructor(){super(Object.assign(bi(Sr.getDefaults(),arguments,["value"]))),this.name="GreaterThan",this.override=!1;const t=bi(Sr.getDefaults(),arguments,["value"]);this._subtract=this.input=new br({context:this.context,value:t.value}),this._gtz=this.output=new Tr({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,ji(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(bo.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}class kr extends Ko{constructor(){super(Object.assign(bi(kr.getDefaults(),arguments,["value"]))),this.name="Pow";const t=bi(kr.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new tr({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(Ko.getDefaults(),{value:1})}_expFunc(t){return e=>Math.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class Cr extends lr{constructor(){super(Object.assign(bi(Cr.getDefaults(),arguments,["min","max","exponent"]))),this.name="ScaleExp";const t=bi(Cr.getDefaults(),arguments,["min","max","exponent"]);this.input=this._exp=new kr({context:this.context,value:t.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(lr.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(t){this._exp.value=t}dispose(){return super.dispose(),this._exp.dispose(),this}}class Ar extends bo{constructor(){super(bi(bo.getDefaults(),arguments,["value","units"])),this.name="SyncedSignal",this.override=!1;const t=bi(bo.getDefaults(),arguments,["value","units"]);this._lastVal=t.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on("start",this._syncedCallback),this.context.transport.on("pause",this._syncedCallback),this.context.transport.on("stop",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new wo({context:this.context,offset:t.value,units:t.units}).start(0),this.setValueAtTime(t.value,0)}_onTick(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==e&&(this._lastVal=e,this._constantSource.offset.setValueAtTime(e,t))}_anchorValue(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal=e,this._constantSource.offset.cancelAndHoldAtTime(t),this._constantSource.offset.setValueAtTime(e,t)}getValueAtTime(t){const e=new ho(this.context,t).toSeconds();return super.getValueAtTime(e)}setValueAtTime(t,e){const s=new ho(this.context,e).toSeconds();return super.setValueAtTime(t,s),this}linearRampToValueAtTime(t,e){const s=new ho(this.context,e).toSeconds();return super.linearRampToValueAtTime(t,s),this}exponentialRampToValueAtTime(t,e){const s=new ho(this.context,e).toSeconds();return super.exponentialRampToValueAtTime(t,s),this}setTargetAtTime(t,e,s){const n=new ho(this.context,e).toSeconds();return super.setTargetAtTime(t,n,s),this}cancelScheduledValues(t){const e=new ho(this.context,t).toSeconds();return super.cancelScheduledValues(e),this}setValueCurveAtTime(t,e,s,n){const i=new ho(this.context,e).toSeconds();return s=this.toSeconds(s),super.setValueCurveAtTime(t,i,s,n),this}cancelAndHoldAtTime(t){const e=new ho(this.context,t).toSeconds();return super.cancelAndHoldAtTime(e),this}setRampPoint(t){const e=new ho(this.context,t).toSeconds();return super.setRampPoint(e),this}exponentialRampTo(t,e,s){const n=new ho(this.context,s).toSeconds();return super.exponentialRampTo(t,e,n),this}linearRampTo(t,e,s){const n=new ho(this.context,s).toSeconds();return super.linearRampTo(t,e,n),this}targetRampTo(t,e,s){const n=new ho(this.context,s).toSeconds();return super.targetRampTo(t,e,n),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}}class Dr extends _o{constructor(){super(bi(Dr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new bo({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=bi(Dr.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(_o.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(ci(t))return t;{let s;for(s in Or)if(Or[s][e]===t)return s;return t}}_setCurve(t,e,s){if(ci(s)&&Reflect.has(Or,s)){const n=Or[s];oi(n)?"_decayCurve"!==t&&(this[t]=n[e]):this[t]=n}else{if(!ai(s)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+s);this[t]=s}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){Xn(["linear","exponential"].some(e=>e===t),"Invalid envelope curve: "+t),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let s=this.toSeconds(this.attack);const n=this.toSeconds(this.decay),i=this.getValueAtTime(t);if(i>0){s=(1-i)/(1/s)}if(s<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,s,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,s,t);else{this._sig.cancelAndHoldAtTime(t);let n=this._attackCurve;for(let t=1;t<n.length;t++)if(n[t-1]<=i&&i<=n[t]){n=this._attackCurve.slice(t),n[0]=i;break}this._sig.setValueCurveAtTime(n,t,s,e)}if(n&&this.sustain<1){const i=e*this.sustain,o=t+s;this.log("decay",o),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(i,n+o):this._sig.exponentialApproachValueAtTime(i,o,n)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const s=this.toSeconds(this.release);s<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,s,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,s,t):(Xn(ai(this._releaseCurve),"releaseCurve must be either \'linear\', \'exponential\' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,s,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,s=1){return e=this.toSeconds(e),this.triggerAttack(e,s),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,s=0){return To(this,t,e,s),this}asArray(t=1024){return di(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,s=new Wi(1,e,this.context.sampleRate),n=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=n+this.toSeconds(this.release),o=.1*i,r=i+o,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/r,decay:e*this.toSeconds(this.decay)/r,release:e*this.toSeconds(this.release)/r,context:s}));a._sig.toDestination(),a.triggerAttackRelease(e*(n+o)/r,0);return(yield s.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}pi([_r(0)],Dr.prototype,"attack",void 0),pi([_r(0)],Dr.prototype,"decay",void 0),pi([fr(0,1)],Dr.prototype,"sustain",void 0),pi([_r(0)],Dr.prototype,"release",void 0);const Or=(()=>{let t,e;const s=[];for(t=0;t<128;t++)s[t]=Math.sin(t/127*(Math.PI/2));const n=[];for(t=0;t<127;t++){e=t/127;const s=Math.sin(e*(2*Math.PI)*6.4-Math.PI/2)+1;n[t]=s/10+.83*e}n[127]=1;const i=[];for(t=0;t<128;t++)i[t]=Math.ceil(t/127*5)/5;const o=[];for(t=0;t<128;t++)e=t/127,o[t]=.5*(1-Math.cos(Math.PI*e));const r=[];for(t=0;t<128;t++){e=t/127;const s=4*Math.pow(e,3)+.2,n=Math.cos(s*Math.PI*2*e);r[t]=Math.abs(n*(1-e))}function a(t){const e=new Array(t.length);for(let s=0;s<t.length;s++)e[s]=1-t[s];return e}return{bounce:{In:a(r),Out:r},cosine:{In:s,Out:(c=s,c.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:n,Out:a(n)},sine:{In:o,Out:a(o)},step:{In:i,Out:a(i)}};var c})();class Mr extends _o{constructor(){super(bi(Mr.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=bi(Mr.getDefaults(),arguments);this._volume=this.output=new Po({context:this.context,volume:t.volume}),this.volume=this._volume.volume,ji(this,"volume")}static getDefaults(){return Object.assign(_o.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const s=this["_original_"+t]=this[t];this[t]=(...t)=>{const n=t[e],i=this.context.transport.schedule(n=>{t[e]=n,s.apply(this,t)},n);this._scheduledEvents.push(i)}}unsync(){return this._scheduledEvents.forEach(t=>this.context.transport.clear(t)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,s,n){const i=this.toSeconds(s),o=this.toSeconds(e);return this.triggerAttack(t,i,n),this.triggerRelease(i+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Er extends Mr{constructor(){super(bi(Er.getDefaults(),arguments));const t=bi(Er.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Mr.getDefaults(),{detune:0,onsilence:zi,portamento:0})}triggerAttack(t,e,s=1){this.log("triggerAttack",t,e,s);const n=this.toSeconds(e);return this._triggerEnvelopeAttack(n,s),this.setNote(t,n),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const s=this.toSeconds(e),n=t instanceof oo?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(s)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(n,t,s)}else this.frequency.setValueAtTime(n,s);return this}}pi([_r(0)],Er.prototype,"portamento",void 0);class Rr extends Dr{constructor(){super(bi(Rr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new yo({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class qr extends Er{constructor(){super(bi(qr.getDefaults(),arguments)),this.name="Synth";const t=bi(qr.getDefaults(),arguments);this.oscillator=new hr(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Rr(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),ji(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Er.getDefaults(),{envelope:Object.assign(Si(Dr.getDefaults(),Object.keys(_o.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Si(hr.getDefaults(),[...Object.keys(Uo.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),s=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+s)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Fr extends Er{constructor(){super(bi(Fr.getDefaults(),arguments)),this.name="ModulationSynth";const t=bi(Fr.getDefaults(),arguments);this._carrier=new qr({context:this.context,oscillator:t.oscillator,envelope:t.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new qr({context:this.context,oscillator:t.modulation,envelope:t.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new bo({context:this.context,units:"frequency"}),this.detune=new bo({context:this.context,value:t.detune,units:"cents"}),this.harmonicity=new sr({context:this.context,value:t.harmonicity,minValue:0}),this._modulationNode=new yo({context:this.context,gain:0}),ji(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Er.getDefaults(),{harmonicity:3,oscillator:Object.assign(Si(hr.getDefaults(),[...Object.keys(Uo.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(Si(Dr.getDefaults(),Object.keys(_o.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Si(hr.getDefaults(),[...Object.keys(Uo.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(Si(Dr.getDefaults(),Object.keys(_o.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class Ir extends Fr{constructor(){super(bi(Ir.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new er({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}}class Vr extends _o{constructor(){super(bi(Vr.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";const t=bi(Vr.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new fo({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new fo({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new fo({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new fo({context:this.context,units:"gain",value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(_o.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){Xn(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: "+t),this._filter.type=t}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let s=0;s<t;s++){const n=19980*Math.pow(s/t,2)+20;e[s]=n}const s=new Float32Array(t),n=new Float32Array(t),i=this.context.createBiquadFilter();return i.type=this.type,i.Q.value=this.Q.value,i.frequency.value=this.frequency.value,i.gain.value=this.gain.value,i.getFrequencyResponse(e,s,n),s}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class Nr extends _o{constructor(){super(bi(Nr.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new yo({context:this.context}),this.output=new yo({context:this.context}),this._filters=[];const t=bi(Nr.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new bo({context:this.context,units:"positive",value:t.Q}),this.frequency=new bo({context:this.context,units:"frequency",value:t.frequency}),this.detune=new bo({context:this.context,units:"cents",value:t.detune}),this.gain=new bo({context:this.context,units:"decibels",value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,ji(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(_o.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(t){Xn(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: "+t),this._type=t,this._filters.forEach(e=>e.type=t)}get rolloff(){return this._rolloff}set rolloff(t){const e=ii(t)?t:parseInt(t,10),s=[-12,-24,-48,-96];let n=s.indexOf(e);Xn(-1!==n,"rolloff can only be "+s.join(", ")),n+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach(t=>t.disconnect()),this._filters=new Array(n);for(let t=0;t<n;t++){const e=new Vr({context:this.context});e.type=this._type,this.frequency.connect(e.frequency),this.detune.connect(e.detune),this.Q.connect(e.Q),this.gain.connect(e.gain),this._filters[t]=e}this._internalChannels=this._filters,mo(this.input,...this._internalChannels,this.output)}getFrequencyResponse(t=128){const e=new Vr({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),s=new Float32Array(t).map(()=>1);return this._filters.forEach(()=>{e.getFrequencyResponse(t).forEach((t,e)=>s[e]*=t)}),e.dispose(),s}dispose(){return super.dispose(),this._filters.forEach(t=>{t.dispose()}),Li(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class Pr extends Dr{constructor(){super(bi(Pr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";const t=bi(Pr.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=t.octaves,this._baseFrequency=this.toFrequency(t.baseFrequency),this._exponent=this.input=new kr({context:this.context,value:t.exponent}),this._scale=this.output=new lr({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(Dr.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){const e=this.toFrequency(t);Yn(e,0),this._baseFrequency=e,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){Yn(t,0),this._octaves=t,this._scale.max=this._baseFrequency*Math.pow(2,t)}get exponent(){return this._exponent.value}set exponent(t){this._exponent.value=t}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class jr extends Er{constructor(){super(bi(jr.getDefaults(),arguments)),this.name="MonoSynth";const t=bi(jr.getDefaults(),arguments);this.oscillator=new hr(Object.assign(t.oscillator,{context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new Nr(Object.assign(t.filter,{context:this.context})),this.filterEnvelope=new Pr(Object.assign(t.filterEnvelope,{context:this.context})),this.envelope=new Rr(Object.assign(t.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),ji(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(Er.getDefaults(),{envelope:Object.assign(Si(Dr.getDefaults(),Object.keys(_o.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(Si(Nr.getDefaults(),Object.keys(_o.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(Si(Pr.getDefaults(),Object.keys(_o.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(Si(hr.getDefaults(),Object.keys(Uo.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(t,e=1){if(this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),s=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+s)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class Lr extends Er{constructor(){super(bi(Lr.getDefaults(),arguments)),this.name="DuoSynth";const t=bi(Lr.getDefaults(),arguments);this.voice0=new jr(Object.assign(t.voice0,{context:this.context,onsilence:()=>this.onsilence(this)})),this.voice1=new jr(Object.assign(t.voice1,{context:this.context})),this.harmonicity=new sr({context:this.context,units:"positive",value:t.harmonicity}),this._vibrato=new dr({frequency:t.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new yo({context:this.context,units:"normalRange",gain:t.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new bo({context:this.context,units:"frequency",value:440}),this.detune=new bo({context:this.context,units:"cents",value:t.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),ji(this,["voice0","voice1","frequency","vibratoAmount","vibratoRate"])}getLevelAtTime(t){return t=this.toSeconds(t),this.voice0.envelope.getValueAtTime(t)+this.voice1.envelope.getValueAtTime(t)}static getDefaults(){return wi(Er.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:wi(Si(jr.getDefaults(),Object.keys(Er.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:wi(Si(jr.getDefaults(),Object.keys(Er.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(t,e){this.voice0._triggerEnvelopeAttack(t,e),this.voice1._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this.voice0._triggerEnvelopeRelease(t),this.voice1._triggerEnvelopeRelease(t),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}class zr extends Fr{constructor(){super(bi(zr.getDefaults(),arguments)),this.name="FMSynth";const t=bi(zr.getDefaults(),arguments);this.modulationIndex=new sr({context:this.context,value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(Fr.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}const Br=[1,1.483,1.932,2.546,2.63,3.897];class Wr extends Er{constructor(){super(bi(Wr.getDefaults(),arguments)),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[];const t=bi(Wr.getDefaults(),arguments);this.detune=new bo({context:this.context,units:"cents",value:t.detune}),this.frequency=new bo({context:this.context,units:"frequency"}),this._amplitude=new yo({context:this.context,gain:0}).connect(this.output),this._highpass=new Nr({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let e=0;e<Br.length;e++){const s=new ir({context:this.context,harmonicity:t.harmonicity,modulationIndex:t.modulationIndex,modulationType:"square",onstop:0===e?()=>this.onsilence(this):zi,type:"square"});s.connect(this._highpass),this._oscillators[e]=s;const n=new sr({context:this.context,value:Br[e]});this._freqMultipliers[e]=n,this.frequency.chain(n,s.frequency),this.detune.connect(s.detune)}this._filterFreqScaler=new lr({context:this.context,max:7e3,min:this.toFrequency(t.resonance)}),this.envelope=new Dr({attack:t.envelope.attack,attackCurve:"linear",context:this.context,decay:t.envelope.decay,release:t.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=t.octaves,this.octaves=t.octaves}static getDefaults(){return wi(Er.getDefaults(),{envelope:Object.assign(Si(Dr.getDefaults(),Object.keys(_o.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(t,e=1){return this.envelope.triggerAttack(t,e),this._oscillators.forEach(e=>e.start(t)),0===this.envelope.sustain&&this._oscillators.forEach(e=>{e.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))}),this}_triggerEnvelopeRelease(t){return this.envelope.triggerRelease(t),this._oscillators.forEach(e=>e.stop(t+this.toSeconds(this.envelope.release))),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(t){this._oscillators.forEach(e=>e.modulationIndex.value=t)}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(t){this._oscillators.forEach(e=>e.harmonicity.value=t)}get resonance(){return this._filterFreqScaler.min}set resonance(t){this._filterFreqScaler.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}dispose(){return super.dispose(),this._oscillators.forEach(t=>t.dispose()),this._freqMultipliers.forEach(t=>t.dispose()),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class Ur extends qr{constructor(){super(bi(Ur.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=bi(Ur.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,ji(this,["oscillator","envelope"])}static getDefaults(){return wi(Er.getDefaults(),qr.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const s=this.toSeconds(e),n=this.toFrequency(t instanceof oo?t.toFrequency():t),i=n*this.octaves;return this.oscillator.frequency.setValueAtTime(i,s),this.oscillator.frequency.exponentialRampToValueAtTime(n,s+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}pi([fr(0)],Ur.prototype,"octaves",void 0),pi([_r(0)],Ur.prototype,"pitchDecay",void 0);class Gr extends Mr{constructor(){super(bi(Gr.getDefaults(),arguments)),this.name="NoiseSynth";const t=bi(Gr.getDefaults(),arguments);this.noise=new Qo(Object.assign({context:this.context},t.noise)),this.envelope=new Rr(Object.assign({context:this.context},t.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(Mr.getDefaults(),{envelope:Object.assign(Si(Dr.getDefaults(),Object.keys(_o.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(Si(Qo.getDefaults(),Object.keys(Uo.getDefaults())),{type:"white"})})}triggerAttack(t,e=1){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.noise.start(t),0===this.envelope.sustain&&this.noise.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(t,e,s=1){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,s),this.triggerRelease(e+t),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const Qr=new Set;function Zr(t){Qr.add(t)}function Xr(t,e){const s=`registerProcessor("${t}", ${e})`;Qr.add(s)}class Yr extends _o{constructor(t){super(t),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=zi;const e=URL.createObjectURL(new Blob([Array.from(Qr).join("\\n")],{type:"text/javascript"})),s=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(e,s).then(()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(s,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))})}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}Zr(\'\\n\\t/**\\n\\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \\n\\t */\\n\\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\\n\\n\\t\\tconstructor(options) {\\n\\t\\t\\t\\n\\t\\t\\tsuper(options);\\n\\t\\t\\t/**\\n\\t\\t\\t * If the processor was disposed or not. Keep alive until it\\\'s disposed.\\n\\t\\t\\t */\\n\\t\\t\\tthis.disposed = false;\\n\\t\\t   \\t/** \\n\\t\\t\\t * The number of samples in the processing block\\n\\t\\t\\t */\\n\\t\\t\\tthis.blockSize = 128;\\n\\t\\t\\t/**\\n\\t\\t\\t * the sample rate\\n\\t\\t\\t */\\n\\t\\t\\tthis.sampleRate = sampleRate;\\n\\n\\t\\t\\tthis.port.onmessage = (event) => {\\n\\t\\t\\t\\t// when it receives a dispose \\n\\t\\t\\t\\tif (event.data === "dispose") {\\n\\t\\t\\t\\t\\tthis.disposed = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t};\\n\\t\\t}\\n\\t}\\n\');Zr("\\n\\t/**\\n\\t * Abstract class for a single input/output processor. \\n\\t * has a \'generate\' function which processes one sample at a time\\n\\t */\\n\\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\\n\\n\\t\\tconstructor(options) {\\n\\t\\t\\tsuper(Object.assign(options, {\\n\\t\\t\\t\\tnumberOfInputs: 1,\\n\\t\\t\\t\\tnumberOfOutputs: 1\\n\\t\\t\\t}));\\n\\t\\t\\t/**\\n\\t\\t\\t * Holds the name of the parameter and a single value of that\\n\\t\\t\\t * parameter at the current sample\\n\\t\\t\\t * @type { [name: string]: number }\\n\\t\\t\\t */\\n\\t\\t\\tthis.params = {}\\n\\t\\t}\\n\\n\\t\\t/**\\n\\t\\t * Generate an output sample from the input sample and parameters\\n\\t\\t * @abstract\\n\\t\\t * @param input number\\n\\t\\t * @param channel number\\n\\t\\t * @param parameters { [name: string]: number }\\n\\t\\t * @returns number\\n\\t\\t */\\n\\t\\tgenerate(){}\\n\\n\\t\\t/**\\n\\t\\t * Update the private params object with the \\n\\t\\t * values of the parameters at the given index\\n\\t\\t * @param parameters { [name: string]: Float32Array },\\n\\t\\t * @param index number\\n\\t\\t */\\n\\t\\tupdateParams(parameters, index) {\\n\\t\\t\\tfor (const paramName in parameters) {\\n\\t\\t\\t\\tconst param = parameters[paramName];\\n\\t\\t\\t\\tif (param.length > 1) {\\n\\t\\t\\t\\t\\tthis.params[paramName] = parameters[paramName][index];\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tthis.params[paramName] = parameters[paramName][0];\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\t/**\\n\\t\\t * Process a single frame of the audio\\n\\t\\t * @param inputs Float32Array[][]\\n\\t\\t * @param outputs Float32Array[][]\\n\\t\\t */\\n\\t\\tprocess(inputs, outputs, parameters) {\\n\\t\\t\\tconst input = inputs[0];\\n\\t\\t\\tconst output = outputs[0];\\n\\t\\t\\t// get the parameter values\\n\\t\\t\\tconst channelCount = Math.max(input && input.length || 0, output.length);\\n\\t\\t\\tfor (let sample = 0; sample < this.blockSize; sample++) {\\n\\t\\t\\t\\tthis.updateParams(parameters, sample);\\n\\t\\t\\t\\tfor (let channel = 0; channel < channelCount; channel++) {\\n\\t\\t\\t\\t\\tconst inputSample = input && input.length ? input[channel][sample] : 0;\\n\\t\\t\\t\\t\\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\treturn !this.disposed;\\n\\t\\t}\\n\\t};\\n");Zr("\\n\\t/**\\n\\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\\n\\t */\\n\\tclass DelayLine {\\n\\t\\t\\n\\t\\tconstructor(size, channels) {\\n\\t\\t\\tthis.buffer = [];\\n\\t\\t\\tthis.writeHead = []\\n\\t\\t\\tthis.size = size;\\n\\n\\t\\t\\t// create the empty channels\\n\\t\\t\\tfor (let i = 0; i < channels; i++) {\\n\\t\\t\\t\\tthis.buffer[i] = new Float32Array(this.size);\\n\\t\\t\\t\\tthis.writeHead[i] = 0;\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\t/**\\n\\t\\t * Push a value onto the end\\n\\t\\t * @param channel number\\n\\t\\t * @param value number\\n\\t\\t */\\n\\t\\tpush(channel, value) {\\n\\t\\t\\tthis.writeHead[channel] += 1;\\n\\t\\t\\tif (this.writeHead[channel] > this.size) {\\n\\t\\t\\t\\tthis.writeHead[channel] = 0;\\n\\t\\t\\t}\\n\\t\\t\\tthis.buffer[channel][this.writeHead[channel]] = value;\\n\\t\\t}\\n\\n\\t\\t/**\\n\\t\\t * Get the recorded value of the channel given the delay\\n\\t\\t * @param channel number\\n\\t\\t * @param delay number delay samples\\n\\t\\t */\\n\\t\\tget(channel, delay) {\\n\\t\\t\\tlet readHead = this.writeHead[channel] - Math.floor(delay);\\n\\t\\t\\tif (readHead < 0) {\\n\\t\\t\\t\\treadHead += this.size;\\n\\t\\t\\t}\\n\\t\\t\\treturn this.buffer[channel][readHead];\\n\\t\\t}\\n\\t}\\n");Xr("feedback-comb-filter",\'\\n\\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\\n\\n\\t\\tconstructor(options) {\\n\\t\\t\\tsuper(options);\\n\\t\\t\\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\\n\\t\\t}\\n\\n\\t\\tstatic get parameterDescriptors() {\\n\\t\\t\\treturn [{\\n\\t\\t\\t\\tname: "delayTime",\\n\\t\\t\\t\\tdefaultValue: 0.1,\\n\\t\\t\\t\\tminValue: 0,\\n\\t\\t\\t\\tmaxValue: 1,\\n\\t\\t\\t\\tautomationRate: "k-rate"\\n\\t\\t\\t}, {\\n\\t\\t\\t\\tname: "feedback",\\n\\t\\t\\t\\tdefaultValue: 0.5,\\n\\t\\t\\t\\tminValue: 0,\\n\\t\\t\\t\\tmaxValue: 0.9999,\\n\\t\\t\\t\\tautomationRate: "k-rate"\\n\\t\\t\\t}];\\n\\t\\t}\\n\\n\\t\\tgenerate(input, channel, parameters) {\\n\\t\\t\\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\\n\\t\\t\\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\\n\\t\\t\\treturn delayedSample;\\n\\t\\t}\\n\\t}\\n\');class Hr extends Yr{constructor(){super(bi(Hr.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";const t=bi(Hr.getDefaults(),arguments,["delayTime","resonance"]);this.input=new yo({context:this.context}),this.output=new yo({context:this.context}),this.delayTime=new fo({context:this.context,value:t.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new fo({context:this.context,value:t.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),ji(this,["resonance","delayTime"])}_audioWorkletName(){return"feedback-comb-filter"}static getDefaults(){return Object.assign(_o.getDefaults(),{delayTime:.1,resonance:.5})}onReady(t){mo(this.input,t,this.output);const e=t.parameters.get("delayTime");this.delayTime.setParam(e);const s=t.parameters.get("feedback");this.resonance.setParam(s)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class $r extends _o{constructor(){super(bi($r.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";const t=bi($r.getDefaults(),arguments,["frequency","type"]);this._frequency=t.frequency,this._type=t.type,this.input=new yo({context:this.context}),this.output=new yo({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(_o.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const t=this._filter,e=this.toFrequency(this._frequency),s=1/(2*Math.PI*e);if("lowpass"===this._type){const t=1/(s*this.context.sampleRate),e=t-1;this._filter=this.context.createIIRFilter([t,0],[1,e])}else{const t=1/(s*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,t])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout(()=>{this.disposed||(this.input.disconnect(t),t.disconnect())},this.blockTime)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._createFilter()}get type(){return this._type}set type(t){this._type=t,this._createFilter()}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let s=0;s<t;s++){const n=19980*Math.pow(s/t,2)+20;e[s]=n}const s=new Float32Array(t),n=new Float32Array(t);return this._filter.getFrequencyResponse(e,s,n),s}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class Jr extends _o{constructor(){super(bi(Jr.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";const t=bi(Jr.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new Hr({context:this.context,delayTime:t.delayTime,resonance:t.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new $r({context:this.context,frequency:t.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(_o.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(t){this._lowpass.frequency=t}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class Kr extends Mr{constructor(){super(bi(Kr.getDefaults(),arguments)),this.name="PluckSynth";const t=bi(Kr.getDefaults(),arguments);this._noise=new Qo({context:this.context,type:"pink"}),this.attackNoise=t.attackNoise,this._lfcf=new Jr({context:this.context,dampening:t.dampening,resonance:t.resonance}),this.resonance=t.resonance,this.release=t.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return wi(Mr.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(t){this._lfcf.dampening=t}triggerAttack(t,e){const s=this.toFrequency(t);e=this.toSeconds(e);const n=1/s;return this._lfcf.delayTime.setValueAtTime(n,e),this._noise.start(e),this._noise.stop(e+n*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(e),this._lfcf.resonance.setValueAtTime(this.resonance,e),this}triggerRelease(t){return this._lfcf.resonance.linearRampTo(0,this.release,t),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}}class ta extends Mr{constructor(){super(bi(ta.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;const t=bi(ta.getDefaults(),arguments,["voice","options"]);Xn(!ii(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const s=this._voices.indexOf(this._dummyVoice);this._voices.splice(s,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Mr.getDefaults(),{maxPolyphony:32,options:{},voice:qr})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex(e=>e.voice===t);this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return t.connect(this.output),this._voices.push(t),t}ti("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,s){t.forEach(t=>{const n=new Eo(this.context,t).toMidi(),i=this._getNextAvailableVoice();i&&(i.triggerAttack(t,e,s),this._activeVoices.push({midi:n,voice:i,released:!1}),this.log("triggerAttack",t,e))})}_triggerRelease(t,e){t.forEach(t=>{const s=new Eo(this.context,t).toMidi(),n=this._activeVoices.find(({midi:t,released:e})=>t===s&&!e);n&&(n.voice.triggerRelease(e),n.released=!0,this.log("triggerRelease",t,e))})}_scheduleEvent(t,e,s,n){Xn(!this.disposed,"Synth was already disposed"),s<=this.now()?"attack"===t?this._triggerAttack(e,s,n):this._triggerRelease(e,s):this.context.setTimeout(()=>{this._scheduleEvent(t,e,s,n)},s-this.now())}triggerAttack(t,e,s){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("attack",t,n,s),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const s=this.toSeconds(e);return this._scheduleEvent("release",t,s),this}triggerAttackRelease(t,e,s,n){const i=this.toSeconds(s);if(this.triggerAttack(t,i,n),ai(e)){Xn(ai(t),"If the duration is an array, the notes must also be an array"),t=t;for(let s=0;s<t.length;s++){const n=e[Math.min(s,e.length-1)],o=this.toSeconds(n);Xn(o>0,"The duration must be greater than 0"),this.triggerRelease(t[s],i+o)}}else{const s=this.toSeconds(e);Xn(s>0,"The duration must be greater than 0"),this.triggerRelease(t,i+s)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(t){const e=Si(t,["onsilence","context"]);return this.options=wi(this.options,e),this._voices.forEach(t=>t.set(e)),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach(({voice:t})=>{t.triggerRelease(e)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(t=>t.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class ea extends Mr{constructor(){super(bi(ea.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=bi(ea.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach(s=>{const n=parseInt(s,10);if(Xn(hi(s)||ii(n)&&isFinite(n),"url key is neither a note or midi pitch: "+s),hi(s)){const n=new oo(this.context,s).toMidi();e[n]=t.urls[s]}else ii(n)&&isFinite(n)&&(e[n]=t.urls[n])}),this._buffers=new Mo({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Mr.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:zi,onerror:zi,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error("No available buffers for note: "+t)}triggerAttack(t,e,s=1){return this.log("triggerAttack",t,e,s),Array.isArray(t)||(t=[t]),t.forEach(t=>{const n=to(new oo(this.context,t).toFrequency()),i=Math.round(n),o=n-i,r=this._findClosest(i),a=i-r,c=this._buffers.get(a),h=$i(r+o),u=new Go({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);u.start(e,0,c.duration/h,s),ai(this._activeSources.get(i))||this._activeSources.set(i,[]),this._activeSources.get(i).push(u),u.onended=()=>{if(this._activeSources&&this._activeSources.has(i)){const t=this._activeSources.get(i),e=t.indexOf(u);-1!==e&&t.splice(e,1)}}}),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach(t=>{const s=new oo(this.context,t).toMidi();if(this._activeSources.has(s)&&this._activeSources.get(s).length){const t=this._activeSources.get(s);e=this.toSeconds(e),t.forEach(t=>{t.stop(e)}),this._activeSources.set(s,[])}}),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach(t=>{for(;t.length;){t.shift().stop(e)}}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,s,n=1){const i=this.toSeconds(s);return this.triggerAttack(t,i,n),ai(e)?(Xn(ai(t),"notes must be an array when duration is array"),t.forEach((t,s)=>{const n=e[Math.min(s,e.length-1)];this.triggerRelease(t,i+this.toSeconds(n))})):this.triggerRelease(t,i+this.toSeconds(e)),this}add(t,e,s){if(Xn(hi(t)||isFinite(t),"note must be a pitch or midi: "+t),hi(t)){const n=new oo(this.context,t).toMidi();this._buffers.add(n,e,s)}else this._buffers.add(t,e,s);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=>{t.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}pi([_r(0)],ea.prototype,"attack",void 0),pi([_r(0)],ea.prototype,"release",void 0);class sa extends lo{constructor(){super(bi(sa.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new po("stopped"),this._startOffset=0;const t=bi(sa.getDefaults(),arguments,["callback","value"]);this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(lo.getDefaults(),{callback:zi,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,t=>{let e;if("started"===t.state){-1!==t.id&&this.context.transport.clear(t.id);const s=t.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||ii(this._loop)&&this._loop>1){e=1/0,ii(this._loop)&&(e=this._loop*this._getLoopDuration());const n=this._state.getAfter(s);null!==n&&(e=Math.min(e,n.time-s)),e!==1/0&&(this._state.setStateAtTime("stopped",s+e+1,{id:-1}),e=new qo(this.context,e));const i=new qo(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),i,new qo(this.context,s),e)}else t.id=this.context.transport.schedule(this._tick.bind(this),new qo(this.context,s))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});const t=this._state.getBefore(e);let s=e;null!==t&&(s=t.time),this._rescheduleEvents(s)}return this}cancel(t){t=Ti(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,t=>{this.context.transport.clear(t.id)}),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let e=.02;ri(this.humanize)||(e=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*e}this.callback(t,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new qo(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new qo(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){const s=this._getLoopDuration();return(t-e.time)%s/s}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class na extends lo{constructor(){super(bi(na.getDefaults(),arguments,["callback","interval"])),this.name="Loop";const t=bi(na.getDefaults(),arguments,["callback","interval"]);this._event=new sa({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability}),this.callback=t.callback,this.iterations=t.iterations}static getDefaults(){return Object.assign(lo.getDefaults(),{interval:"4n",callback:zi,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(t){return this._event.start(t),this}stop(t){return this._event.stop(t),this}cancel(t){return this._event.cancel(t),this}_tick(t){this.callback(t)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(t){this._event.loopEnd=t}get playbackRate(){return this._event.playbackRate}set playbackRate(t){this._event.playbackRate=t}get humanize(){return this._event.humanize}set humanize(t){this._event.humanize=t}get probability(){return this._event.probability}set probability(t){this._event.probability=t}get mute(){return this._event.mute}set mute(t){this._event.mute=t}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(t){this._event.loop=t===1/0||t}dispose(){return super.dispose(),this._event.dispose(),this}}class ia extends sa{constructor(){super(bi(ia.getDefaults(),arguments,["callback","events"])),this.name="Part",this._state=new po("stopped"),this._events=new Set;const t=bi(ia.getDefaults(),arguments,["callback","events"]);this._state.increasing=!0,t.events.forEach(t=>{ai(t)?this.add(t[0],t[1]):this.add(t)})}static getDefaults(){return Object.assign(sa.getDefaults(),{events:[]})}start(t,e){const s=this.toTicks(t);if("started"!==this._state.getValueAtTime(s)){e=Ti(e,this._loop?this._loopStart:0),e=this._loop?Ti(e,this._loopStart):Ti(e,0);const t=this.toTicks(e);this._state.add({id:-1,offset:t,state:"started",time:s}),this._forEach(e=>{this._startNote(e,s,t)})}return this}_startNote(t,e,s){e-=s,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<s&&(e+=this._getLoopDuration()),t.start(new qo(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=s&&(t.loop=!1,t.start(new qo(this.context,e))):t.startOffset>=s&&t.start(new qo(this.context,e))}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t,this._forEach(t=>{t.startOffset+=this._startOffset})}stop(t){const e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach(e=>{e.stop(t)}),this}at(t,e){const s=new ho(this.context,t).toTicks(),n=new qo(this.context,1).toSeconds(),i=this._events.values();let o=i.next();for(;!o.done;){const t=o.value;if(Math.abs(s-t.startOffset)<n)return si(e)&&(t.value=e),t;o=i.next()}return si(e)?(this.add(t,e),this.at(t)):null}add(t,e){t instanceof Object&&Reflect.has(t,"time")&&(t=(e=t).time);const s=this.toTicks(t);let n;return e instanceof sa?(n=e,n.callback=this._tick.bind(this)):n=new sa({callback:this._tick.bind(this),context:this.context,value:e}),n.startOffset=s,n.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(n),this._restartEvent(n),this}_restartEvent(t){this._state.forEach(e=>{"started"===e.state?this._startNote(t,e.time,e.offset):t.stop(new qo(this.context,e.time))})}remove(t,e){return oi(t)&&t.hasOwnProperty("time")&&(t=(e=t).time),t=this.toTicks(t),this._events.forEach(s=>{s.startOffset===t&&(ei(e)||si(e)&&s.value===e)&&(this._events.delete(s),s.dispose())}),this}clear(){return this._forEach(t=>t.dispose()),this._events.clear(),this}cancel(t){return this._forEach(e=>e.cancel(t)),this._state.cancel(this.toTicks(t)),this}_forEach(t){return this._events&&this._events.forEach(e=>{e instanceof ia?e._forEach(t):t(e)}),this}_setAll(t,e){this._forEach(s=>{s[t]=e})}_tick(t,e){this.mute||this.callback(t,e)}_testLoopBoundries(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):"stopped"===t.state&&this._restartEvent(t)}get probability(){return this._probability}set probability(t){this._probability=t,this._setAll("probability",t)}get humanize(){return this._humanize}set humanize(t){this._humanize=t,this._setAll("humanize",t)}get loop(){return this._loop}set loop(t){this._loop=t,this._forEach(e=>{e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.loop=t,this._testLoopBoundries(e)})}get loopEnd(){return new qo(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach(e=>{e.loopEnd=t,this._testLoopBoundries(e)})}get loopStart(){return new qo(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach(t=>{t.loopStart=this.loopStart,this._testLoopBoundries(t)})}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._setAll("playbackRate",t)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}function*oa(t){let e=0;for(;e<t.length;)e=ca(e,t),yield t[e],e++}function*ra(t){let e=t.length-1;for(;e>=0;)e=ca(e,t),yield t[e],e--}function*aa(t,e){for(;;)yield*e(t)}function ca(t,e){return Mi(t,0,e.length-1)}function*ha(t,e){let s=e?0:t.length-1;for(;;)s=ca(s,t),yield t[s],e?(s++,s>=t.length-1&&(e=!1)):(s--,s<=0&&(e=!0))}function*ua(t){let e=0,s=0;for(;e<t.length;)e=ca(e,t),yield t[e],s++,e+=s%2?2:-1}function*la(t){let e=t.length-1,s=0;for(;e>=0;)e=ca(e,t),yield t[e],s++,e+=s%2?-2:1}function*pa(t){const e=[];for(let s=0;s<t.length;s++)e.push(s);for(;e.length>0;){const s=ca(e.splice(Math.floor(e.length*Math.random()),1)[0],t);yield t[s]}}function*da(t,e="up",s=0){switch(Xn(t.length>0,"The array must have more than one value in it"),e){case"up":yield*aa(t,oa);case"down":yield*aa(t,ra);case"upDown":yield*ha(t,!0);case"downUp":yield*ha(t,!1);case"alternateUp":yield*aa(t,ua);case"alternateDown":yield*aa(t,la);case"random":yield*function*(t){for(;;){const e=Math.floor(Math.random()*t.length);yield t[e]}}(t);case"randomOnce":yield*aa(t,pa);case"randomWalk":yield*function*(t){let e=Math.floor(Math.random()*t.length);for(;;)0===e?e++:e===t.length-1||Math.random()<.5?e--:e++,yield t[e]}(t)}}class fa extends na{constructor(){super(bi(fa.getDefaults(),arguments,["callback","values","pattern"])),this.name="Pattern";const t=bi(fa.getDefaults(),arguments,["callback","values","pattern"]);this.callback=t.callback,this._values=t.values,this._pattern=da(t.values,t.pattern),this._type=t.pattern}static getDefaults(){return Object.assign(na.getDefaults(),{pattern:"up",values:[],callback:zi})}_tick(t){const e=this._pattern.next();this._value=e.value,this.callback(t,this._value)}get values(){return this._values}set values(t){this._values=t,this.pattern=this._type}get value(){return this._value}get pattern(){return this._type}set pattern(t){this._type=t,this._pattern=da(this._values,this._type)}}class _a extends sa{constructor(){super(bi(_a.getDefaults(),arguments,["callback","events","subdivision"])),this.name="Sequence",this._part=new ia({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[];const t=bi(_a.getDefaults(),arguments,["callback","events","subdivision"]);this._subdivision=this.toTicks(t.subdivision),this.events=t.events,this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.playbackRate=t.playbackRate,this.probability=t.probability,this.humanize=t.humanize,this.mute=t.mute,this.playbackRate=t.playbackRate}static getDefaults(){return Object.assign(Si(sa.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}_seqCallback(t,e){null!==e&&this.callback(t,e)}get events(){return this._events}set events(t){this.clear(),this._eventsArray=t,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(t,e){return this._part.start(t,e?this._indexTime(e):e),this}stop(t){return this._part.stop(t),this}get subdivision(){return new qo(this.context,this._subdivision).toSeconds()}_createSequence(t){return new Proxy(t,{get:(t,e)=>t[e],set:(t,e,s)=>(ci(e)&&isFinite(parseInt(e,10))&&ai(s)?t[e]=this._createSequence(s):t[e]=s,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(t,e,s){t.forEach((t,n)=>{const i=n*e+s;if(ai(t))this._rescheduleSequence(t,e/t.length,i);else{const e=new qo(this.context,i,"i").toSeconds();this._part.add(e,t)}})}_indexTime(t){return new qo(this.context,t*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(t){this._part.loop=t}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this._part.loopStart=this._indexTime(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this._part.loopEnd=0===t?this._indexTime(this._eventsArray.length):this._indexTime(t)}get startOffset(){return this._part.startOffset}set startOffset(t){this._part.startOffset=t}get playbackRate(){return this._part.playbackRate}set playbackRate(t){this._part.playbackRate=t}get probability(){return this._part.probability}set probability(t){this._part.probability=t}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(t){this._part.humanize=t}get length(){return this._part.length}}class ma extends _o{constructor(){super(Object.assign(bi(ma.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new xr({context:this.context}),this.a=new yo({context:this.context,gain:0}),this.b=new yo({context:this.context,gain:0}),this.output=new yo({context:this.context}),this._internalChannels=[this.a,this.b];const t=bi(ma.getDefaults(),arguments,["fade"]);this.fade=new bo({context:this.context,units:"normalRange",value:t.fade}),ji(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",go(this._split,this.a.gain,0),go(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(_o.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class ga extends _o{constructor(t){super(t),this.name="Effect",this._dryWet=new ma({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new yo({context:this.context}),this.effectReturn=new yo({context:this.context}),this.input=new yo({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],ji(this,"wet")}static getDefaults(){return Object.assign(_o.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class va extends ga{constructor(t){super(t),this.name="LFOEffect",this._lfo=new dr({context:this.context,frequency:t.frequency,amplitude:t.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=t.type,ji(this,["frequency","depth"])}static getDefaults(){return Object.assign(ga.getDefaults(),{frequency:1,type:"sine",depth:1})}start(t){return this._lfo.start(t),this}stop(t){return this._lfo.stop(t),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class ya extends va{constructor(){super(bi(ya.getDefaults(),arguments,["frequency","baseFrequency","octaves"])),this.name="AutoFilter";const t=bi(ya.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);this.filter=new Nr(Object.assign(t.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=t.octaves,this.baseFrequency=t.baseFrequency}static getDefaults(){return Object.assign(va.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(t){this._lfo.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._lfo.max=this._lfo.min*Math.pow(2,t)}dispose(){return super.dispose(),this.filter.dispose(),this}}class xa extends _o{constructor(){super(Object.assign(bi(xa.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=bi(xa.getDefaults(),arguments,["pan"]);this.pan=new fo({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",ji(this,"pan")}static getDefaults(){return Object.assign(_o.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class wa extends va{constructor(){super(bi(wa.getDefaults(),arguments,["frequency"])),this.name="AutoPanner";const t=bi(wa.getDefaults(),arguments,["frequency"]);this._panner=new xa({context:this.context,channelCount:t.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(va.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}}class ba extends _o{constructor(){super(bi(ba.getDefaults(),arguments,["smoothing"])),this.name="Follower";const t=bi(ba.getDefaults(),arguments,["smoothing"]);this._abs=this.input=new yr({context:this.context}),this._lowpass=this.output=new $r({context:this.context,frequency:1/this.toSeconds(t.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=t.smoothing}static getDefaults(){return Object.assign(_o.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class Ta extends ga{constructor(){super(bi(Ta.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"])),this.name="AutoWah";const t=bi(Ta.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);this._follower=new ba({context:this.context,smoothing:t.follower}),this._sweepRange=new Cr({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this._inputBoost=new yo({context:this.context}),this._bandpass=new Nr({context:this.context,rolloff:-48,frequency:0,Q:t.Q}),this._peaking=new Nr({context:this.context,type:"peaking"}),this._peaking.gain.value=t.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=t.sensitivity,ji(this,["gain","Q"])}static getDefaults(){return Object.assign(ga.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(t){this._follower.smoothing=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._setSweepRange()}get sensitivity(){return Hi(1/this._inputBoost.gain.value)}set sensitivity(t){this._inputBoost.gain.value=1/Yi(t)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}Xr("bit-crusher","\\n\\tclass BitCrusherWorklet extends SingleIOProcessor {\\n\\n\\t\\tstatic get parameterDescriptors() {\\n\\t\\t\\treturn [{\\n\\t\\t\\t\\tname: \\"bits\\",\\n\\t\\t\\t\\tdefaultValue: 12,\\n\\t\\t\\t\\tminValue: 1,\\n\\t\\t\\t\\tmaxValue: 16,\\n\\t\\t\\t\\tautomationRate: \'k-rate\'\\n\\t\\t\\t}];\\n\\t\\t}\\n\\n\\t\\tgenerate(input, _channel, parameters) {\\n\\t\\t\\tconst step = Math.pow(0.5, parameters.bits - 1);\\n\\t\\t\\tconst val = step * Math.floor(input / step + 0.5);\\n\\t\\t\\treturn val;\\n\\t\\t}\\n\\t}\\n");class Sa extends ga{constructor(){super(bi(Sa.getDefaults(),arguments,["bits"])),this.name="BitCrusher";const t=bi(Sa.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new ka({context:this.context,bits:t.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(ga.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class ka extends Yr{constructor(){super(bi(ka.getDefaults(),arguments)),this.name="BitCrusherWorklet";const t=bi(ka.getDefaults(),arguments);this.input=new yo({context:this.context}),this.output=new yo({context:this.context}),this.bits=new fo({context:this.context,value:t.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(Yr.getDefaults(),{bits:12})}_audioWorkletName(){return"bit-crusher"}onReady(t){mo(this.input,t,this.output);const e=t.parameters.get("bits");this.bits.setParam(e)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}class Ca extends ga{constructor(){super(bi(Ca.getDefaults(),arguments,["order"])),this.name="Chebyshev";const t=bi(Ca.getDefaults(),arguments,["order"]);this._shaper=new tr({context:this.context,length:4096}),this._order=t.order,this.connectEffect(this._shaper),this.order=t.order,this.oversample=t.oversample}static getDefaults(){return Object.assign(ga.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(t,e,s){return s.has(e)||(0===e?s.set(e,0):1===e?s.set(e,t):s.set(e,2*t*this._getCoefficient(t,e-1,s)-this._getCoefficient(t,e-2,s))),s.get(e)}get order(){return this._order}set order(t){this._order=t,this._shaper.setMap(e=>this._getCoefficient(e,t,new Map))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class Aa extends _o{constructor(){super(bi(Aa.getDefaults(),arguments,["channels"])),this.name="Split";const t=bi(Aa.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(_o.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class Da extends _o{constructor(){super(bi(Da.getDefaults(),arguments,["channels"])),this.name="Merge";const t=bi(Da.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(_o.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class Oa extends _o{constructor(t){super(t),this.name="StereoEffect",this.input=new yo({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new ma({context:this.context,fade:t.wet}),this.wet=this._dryWet.fade,this._split=new Aa({context:this.context,channels:2}),this._merge=new Da({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),ji(this,["wet"])}connectEffectLeft(...t){this._split.connect(t[0],0,0),mo(...t),go(t[t.length-1],this._merge,0,0)}connectEffectRight(...t){this._split.connect(t[0],1,0),mo(...t),go(t[t.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(_o.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class Ma extends Oa{constructor(t){super(t),this.feedback=new bo({context:this.context,value:t.feedback,units:"normalRange"}),this._feedbackL=new yo({context:this.context}),this._feedbackR=new yo({context:this.context}),this._feedbackSplit=new Aa({context:this.context,channels:2}),this._feedbackMerge=new Da({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),ji(this,["feedback"])}static getDefaults(){return Object.assign(Oa.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class Ea extends Ma{constructor(){super(bi(Ea.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";const t=bi(Ea.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new dr({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new dr({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._delayNodeL=new Do({context:this.context}),this._delayNodeR=new Do({context:this.context}),this.frequency=this._lfoL.frequency,ji(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=t.type,this.spread=t.spread}static getDefaults(){return Object.assign(Ma.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(t){this._depth=t;const e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}get delayTime(){return 1e3*this._delayTime}set delayTime(t){this._delayTime=t/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class Ra extends ga{constructor(){super(bi(Ra.getDefaults(),arguments,["distortion"])),this.name="Distortion";const t=bi(Ra.getDefaults(),arguments,["distortion"]);this._shaper=new tr({context:this.context,length:4096}),this._distortion=t.distortion,this.connectEffect(this._shaper),this.distortion=t.distortion,this.oversample=t.oversample}static getDefaults(){return Object.assign(ga.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(t){this._distortion=t;const e=100*t,s=Math.PI/180;this._shaper.setMap(t=>Math.abs(t)<.001?0:(3+e)*t*20*s/(Math.PI+e*Math.abs(t)))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class qa extends ga{constructor(t){super(t),this.name="FeedbackEffect",this._feedbackGain=new yo({context:this.context,gain:t.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,ji(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(ga.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class Fa extends qa{constructor(){super(bi(Fa.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";const t=bi(Fa.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new Do({context:this.context,delayTime:t.delayTime,maxDelay:t.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),ji(this,"delayTime")}static getDefaults(){return Object.assign(qa.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class Ia extends _o{constructor(t){super(t),this.name="PhaseShiftAllpass",this.input=new yo({context:this.context}),this.output=new yo({context:this.context}),this.offset90=new yo({context:this.context});this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),mo(this.input,...this._bank0,this._oneSampleDelay,this.output),mo(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(t){return t.map(t=>{const e=[[t*t,0,-1],[1,0,-t*t]];return this.context.createIIRFilter(e[0],e[1])})}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach(t=>t.disconnect()),this._bank1.forEach(t=>t.disconnect()),this._oneSampleDelay.disconnect(),this}}class Va extends ga{constructor(){super(bi(Va.getDefaults(),arguments,["frequency"])),this.name="FrequencyShifter";const t=bi(Va.getDefaults(),arguments,["frequency"]);this.frequency=new bo({context:this.context,units:"frequency",value:t.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new $o({context:this.context,type:"sine"}),this._cosine=new Jo({context:this.context,phase:-90,type:"sine"}),this._sineMultiply=new sr({context:this.context}),this._cosineMultiply=new sr({context:this.context}),this._negate=new wr({context:this.context}),this._add=new ur({context:this.context}),this._phaseShifter=new Ia({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);const e=this.immediate();this._sine.start(e),this._cosine.start(e)}static getDefaults(){return Object.assign(ga.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}const Na=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],Pa=[225,556,441,341];class ja extends Oa{constructor(){super(bi(ja.getDefaults(),arguments,["roomSize","dampening"])),this.name="Freeverb",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];const t=bi(ja.getDefaults(),arguments,["roomSize","dampening"]);this.roomSize=new bo({context:this.context,value:t.roomSize,units:"normalRange"}),this._allpassFiltersL=Pa.map(t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e}),this._allpassFiltersR=Pa.map(t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e}),this._combFilters=Na.map((e,s)=>{const n=new Jr({context:this.context,dampening:t.dampening,delayTime:e});return s<Na.length/2?this.connectEffectLeft(n,...this._allpassFiltersL):this.connectEffectRight(n,...this._allpassFiltersR),this.roomSize.connect(n.resonance),n}),ji(this,["roomSize"])}static getDefaults(){return Object.assign(Oa.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(t){this._combFilters.forEach(e=>e.dampening=t)}dispose(){return super.dispose(),this._allpassFiltersL.forEach(t=>t.disconnect()),this._allpassFiltersR.forEach(t=>t.disconnect()),this._combFilters.forEach(t=>t.dispose()),this.roomSize.dispose(),this}}const La=[.06748,.06404,.08212,.09004],za=[.773,.802,.753,.733],Ba=[347,113,37];class Wa extends Oa{constructor(){super(bi(Wa.getDefaults(),arguments,["roomSize"])),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[];const t=bi(Wa.getDefaults(),arguments,["roomSize"]);this.roomSize=new bo({context:this.context,value:t.roomSize,units:"normalRange"}),this._scaleRoomSize=new lr({context:this.context,min:-.733,max:.197}),this._allpassFilters=Ba.map(t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e}),this._feedbackCombFilters=La.map((t,e)=>{const s=new Hr({context:this.context,delayTime:t});return this._scaleRoomSize.connect(s.resonance),s.resonance.value=za[e],e<La.length/2?this.connectEffectLeft(...this._allpassFilters,s):this.connectEffectRight(...this._allpassFilters,s),s}),this.roomSize.connect(this._scaleRoomSize),ji(this,["roomSize"])}static getDefaults(){return Object.assign(Oa.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach(t=>t.disconnect()),this._feedbackCombFilters.forEach(t=>t.dispose()),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}class Ua extends Ma{constructor(t){super(t),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),ji(this,["feedback"])}}class Ga extends Ua{constructor(){super(bi(Ga.getDefaults(),arguments,["delayTime","feedback"])),this.name="PingPongDelay";const t=bi(Ga.getDefaults(),arguments,["delayTime","feedback"]);this._leftDelay=new Do({context:this.context,maxDelay:t.maxDelay}),this._rightDelay=new Do({context:this.context,maxDelay:t.maxDelay}),this._rightPreDelay=new Do({context:this.context,maxDelay:t.maxDelay}),this.delayTime=new bo({context:this.context,units:"time",value:t.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),ji(this,["delayTime"])}static getDefaults(){return Object.assign(Ua.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}class Qa extends qa{constructor(){super(bi(Qa.getDefaults(),arguments,["pitch"])),this.name="PitchShift";const t=bi(Qa.getDefaults(),arguments,["pitch"]);this._frequency=new bo({context:this.context}),this._delayA=new Do({maxDelay:1,context:this.context}),this._lfoA=new dr({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new Do({maxDelay:1,context:this.context}),this._lfoB=new dr({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new ma({context:this.context}),this._crossFadeLFO=new dr({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new Do({delayTime:t.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,ji(this,"delayTime"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);const e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(qa.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(t){this._pitch=t;let e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=$i(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=$i(t)-1),this._frequency.value=e*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class Za extends Oa{constructor(){super(bi(Za.getDefaults(),arguments,["frequency","octaves","baseFrequency"])),this.name="Phaser";const t=bi(Za.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);this._lfoL=new dr({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new dr({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this.Q=new bo({context:this.context,value:t.Q,units:"positive"}),this._filtersL=this._makeFilters(t.stages,this._lfoL),this._filtersR=this._makeFilters(t.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=t.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=t.baseFrequency,this.octaves=t.octaves,this._lfoL.start(),this._lfoR.start(),ji(this,["frequency","Q"])}static getDefaults(){return Object.assign(Oa.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(t,e){const s=[];for(let n=0;n<t;n++){const t=this.context.createBiquadFilter();t.type="allpass",this.Q.connect(t.Q),e.connect(t.frequency),s.push(t)}return s}get octaves(){return this._octaves}set octaves(t){this._octaves=t;const e=this._baseFrequency*Math.pow(2,t);this._lfoL.max=e,this._lfoR.max=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(t=>t.disconnect()),this._filtersR.forEach(t=>t.disconnect()),this.frequency.dispose(),this}}class Xa extends ga{constructor(){super(bi(Xa.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=bi(Xa.getDefaults(),arguments,["decay"]);this._decay=t.decay,this._preDelay=t.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(ga.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){Yn(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){Yn(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return di(this,void 0,void 0,(function*(){const t=this.ready,e=new Wi(2,this._decay+this._preDelay,this.context.sampleRate),s=new Qo({context:e}),n=new Qo({context:e}),i=new Da({context:e});s.connect(i,0,0),n.connect(i,0,1);const o=new yo({context:e}).toDestination();i.connect(o),s.start(0),n.start(0),o.gain.setValueAtTime(0,0),o.gain.setValueAtTime(1,this._preDelay),o.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const r=e.render();return this.ready=r.then(zi),yield t,this._convolver.buffer=(yield r).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class Ya extends _o{constructor(){super(bi(Ya.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new Aa({channels:2,context:this.context}),this._midAdd=new ur({context:this.context}),this.mid=new sr({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new br({context:this.context}),this.side=new sr({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}class Ha extends _o{constructor(){super(bi(Ha.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new yo({context:this.context}),this.side=new yo({context:this.context}),this._left=new ur({context:this.context}),this._leftMult=new sr({context:this.context,value:Math.SQRT1_2}),this._right=new br({context:this.context}),this._rightMult=new sr({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new Da({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}class $a extends ga{constructor(t){super(t),this.name="MidSideEffect",this._midSideMerge=new Ha({context:this.context}),this._midSideSplit=new Ya({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(...t){this._midSend.chain(...t,this._midReturn)}connectEffectSide(...t){this._sideSend.chain(...t,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}class Ja extends $a{constructor(){super(bi(Ja.getDefaults(),arguments,["width"])),this.name="StereoWidener";const t=bi(Ja.getDefaults(),arguments,["width"]);this.width=new bo({context:this.context,value:t.width,units:"normalRange"}),ji(this,["width"]),this._twoTimesWidthMid=new sr({context:this.context,value:2}),this._twoTimesWidthSide=new sr({context:this.context,value:2}),this._midMult=new sr({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new br({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),go(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new sr({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign($a.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}class Ka extends Oa{constructor(){super(bi(Ka.getDefaults(),arguments,["frequency","depth"])),this.name="Tremolo";const t=bi(Ka.getDefaults(),arguments,["frequency","depth"]);this._lfoL=new dr({context:this.context,type:t.type,min:1,max:0}),this._lfoR=new dr({context:this.context,type:t.type,min:1,max:0}),this._amplitudeL=new yo({context:this.context}),this._amplitudeR=new yo({context:this.context}),this.frequency=new bo({context:this.context,value:t.frequency,units:"frequency"}),this.depth=new bo({context:this.context,value:t.depth,units:"normalRange"}),ji(this,["frequency","depth"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=t.spread}static getDefaults(){return Object.assign(Oa.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class tc extends ga{constructor(){super(bi(tc.getDefaults(),arguments,["frequency","depth"])),this.name="Vibrato";const t=bi(tc.getDefaults(),arguments,["frequency","depth"]);this._delayNode=new Do({context:this.context,delayTime:0,maxDelay:t.maxDelay}),this._lfo=new dr({context:this.context,type:t.type,min:0,max:t.maxDelay,frequency:t.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=t.depth,ji(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(ga.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class ec extends _o{constructor(){super(bi(ec.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];const t=bi(ec.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new yo({context:this.context}),this._split=new Aa({context:this.context,channels:t.channels}),this.input.connect(this._split),Yn(t.channels,1);for(let e=0;e<t.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type}static getDefaults(){return Object.assign(_o.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach((t,e)=>{const s=this._buffers[e];"fft"===this._type?t.getFloatFrequencyData(s):"waveform"===this._type&&t.getFloatTimeDomainData(s)}),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(t){this._analysers.forEach((e,s)=>{e.fftSize=2*t,this._buffers[s]=new Float32Array(t)})}get channels(){return this._analysers.length}get type(){return this._type}set type(t){Xn("waveform"===t||"fft"===t,"Analyser: invalid type: "+t),this._type=t}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(t){this._analysers.forEach(e=>e.smoothingTimeConstant=t)}dispose(){return super.dispose(),this._analysers.forEach(t=>t.disconnect()),this._split.dispose(),this._gain.dispose(),this}}class sc extends _o{constructor(){super(bi(sc.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new ec({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class nc extends sc{constructor(){super(bi(nc.getDefaults(),arguments,["smoothing"])),this.name="Meter",this._rms=0;const t=bi(nc.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new ec({context:this.context,size:256,type:"waveform",channels:t.channels}),this.smoothing=t.smoothing,this.normalRange=t.normalRange}static getDefaults(){return Object.assign(sc.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return ti("\'getLevel\' has been changed to \'getValue\'"),this.getValue()}getValue(){const t=this._analyser.getValue(),e=(1===this.channels?[t]:t).map(t=>{const e=t.reduce((t,e)=>t+e*e,0),s=Math.sqrt(e/t.length);return this._rms=Math.max(s,this._rms*this.smoothing),this.normalRange?this._rms:Hi(this._rms)});return 1===this.channels?e[0]:e}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}class ic extends sc{constructor(){super(bi(ic.getDefaults(),arguments,["size"])),this.name="FFT";const t=bi(ic.getDefaults(),arguments,["size"]);this.normalRange=t.normalRange,this._analyser.type="fft",this.size=t.size}static getDefaults(){return Object.assign(_o.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map(t=>this.normalRange?Yi(t):t)}get size(){return this._analyser.size}set size(t){this._analyser.size=t}get smoothing(){return this._analyser.smoothing}set smoothing(t){this._analyser.smoothing=t}getFrequencyOfIndex(t){return Xn(0<=t&&t<this.size,"index must be greater than or equal to 0 and less than "+this.size),t*this.context.sampleRate/(2*this.size)}}class oc extends sc{constructor(){super(bi(oc.getDefaults(),arguments)),this.name="DCMeter",this._analyser.type="waveform",this._analyser.size=256}getValue(){return this._analyser.getValue()[0]}}class rc extends sc{constructor(){super(bi(rc.getDefaults(),arguments,["size"])),this.name="Waveform";const t=bi(rc.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=t.size}static getDefaults(){return Object.assign(sc.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(t){this._analyser.size=t}}class ac extends _o{constructor(){super(bi(ac.getDefaults(),arguments,["solo"])),this.name="Solo";const t=bi(ac.getDefaults(),arguments,["solo"]);this.input=this.output=new yo({context:this.context}),ac._allSolos.has(this.context)||ac._allSolos.set(this.context,new Set),ac._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(_o.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),ac._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return 0===this.input.gain.value}_addSolo(){ac._soloed.has(this.context)||ac._soloed.set(this.context,new Set),ac._soloed.get(this.context).add(this)}_removeSolo(){ac._soloed.has(this.context)&&ac._soloed.get(this.context).delete(this)}_isSoloed(){return ac._soloed.has(this.context)&&ac._soloed.get(this.context).has(this)}_noSolos(){return!ac._soloed.has(this.context)||ac._soloed.has(this.context)&&0===ac._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),ac._allSolos.get(this.context).delete(this),this._removeSolo(),this}}ac._allSolos=new Map,ac._soloed=new Map;class cc extends _o{constructor(){super(bi(cc.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=bi(cc.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new xa({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Po({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,ji(this,["pan","volume"])}static getDefaults(){return Object.assign(_o.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class hc extends _o{constructor(){super(bi(hc.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=bi(hc.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new ac({solo:t.solo,context:this.context}),this._panVol=this.output=new cc({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),ji(this,["pan","volume"])}static getDefaults(){return Object.assign(_o.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return hc.buses.has(t)||hc.buses.set(t,new yo({context:this.context})),hc.buses.get(t)}send(t,e=0){const s=this._getBus(t),n=new yo({context:this.context,units:"decibels",gain:e});return this.connect(n),n.connect(s),n}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}hc.buses=new Map;class uc extends _o{constructor(){super(bi(uc.getDefaults(),arguments,["lowFrequency","highFrequency"])),this.name="MultibandSplit",this.input=new yo({context:this.context}),this.output=void 0,this.low=new Nr({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new Nr({context:this.context,frequency:0,type:"highpass"}),this.mid=new Nr({context:this.context,frequency:0,type:"lowpass"}),this.high=new Nr({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high];const t=bi(uc.getDefaults(),arguments,["lowFrequency","highFrequency"]);this.lowFrequency=new bo({context:this.context,units:"frequency",value:t.lowFrequency}),this.highFrequency=new bo({context:this.context,units:"frequency",value:t.highFrequency}),this.Q=new bo({context:this.context,units:"positive",value:t.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),ji(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(_o.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),Li(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class lc extends _o{constructor(){super(...arguments),this.name="Listener",this.positionX=new fo({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new fo({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new fo({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new fo({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new fo({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new fo({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new fo({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new fo({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new fo({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(_o.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}qi(t=>{t.listener=new lc({context:t})}),Ii(t=>{t.listener.dispose()});class pc extends _o{constructor(){super(bi(pc.getDefaults(),arguments,["positionX","positionY","positionZ"])),this.name="Panner3D";const t=bi(pc.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=t.panningModel,this.maxDistance=t.maxDistance,this.distanceModel=t.distanceModel,this.coneOuterGain=t.coneOuterGain,this.coneOuterAngle=t.coneOuterAngle,this.coneInnerAngle=t.coneInnerAngle,this.refDistance=t.refDistance,this.rolloffFactor=t.rolloffFactor,this.positionX=new fo({context:this.context,param:this._panner.positionX,value:t.positionX}),this.positionY=new fo({context:this.context,param:this._panner.positionY,value:t.positionY}),this.positionZ=new fo({context:this.context,param:this._panner.positionZ,value:t.positionZ}),this.orientationX=new fo({context:this.context,param:this._panner.orientationX,value:t.orientationX}),this.orientationY=new fo({context:this.context,param:this._panner.orientationY,value:t.orientationY}),this.orientationZ=new fo({context:this.context,param:this._panner.orientationZ,value:t.orientationZ})}static getDefaults(){return Object.assign(_o.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(t,e,s){return this.positionX.value=t,this.positionY.value=e,this.positionZ.value=s,this}setOrientation(t,e,s){return this.orientationX.value=t,this.orientationY.value=e,this.orientationZ.value=s,this}get panningModel(){return this._panner.panningModel}set panningModel(t){this._panner.panningModel=t}get refDistance(){return this._panner.refDistance}set refDistance(t){this._panner.refDistance=t}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(t){this._panner.rolloffFactor=t}get distanceModel(){return this._panner.distanceModel}set distanceModel(t){this._panner.distanceModel=t}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(t){this._panner.coneInnerAngle=t}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(t){this._panner.coneOuterAngle=t}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(t){this._panner.coneOuterGain=t}get maxDistance(){return this._panner.maxDistance}set maxDistance(t){this._panner.maxDistance=t}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}class dc extends _o{constructor(){super(bi(dc.getDefaults(),arguments)),this.name="Recorder";const t=bi(dc.getDefaults(),arguments);this.input=new yo({context:this.context}),Xn(dc.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:t.mimeType})}static getDefaults(){return _o.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return null!==ui&&Reflect.has(ui,"MediaRecorder")}get state(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}start(){return di(this,void 0,void 0,(function*(){Xn("started"!==this.state,"Recorder is already started");const t=new Promise(t=>{const e=()=>{this._recorder.removeEventListener("start",e,!1),t()};this._recorder.addEventListener("start",e,!1)});return this._recorder.start(),yield t}))}stop(){return di(this,void 0,void 0,(function*(){Xn("stopped"!==this.state,"Recorder is not started");const t=new Promise(t=>{const e=s=>{this._recorder.removeEventListener("dataavailable",e,!1),t(s.data)};this._recorder.addEventListener("dataavailable",e,!1)});return this._recorder.stop(),yield t}))}pause(){return Xn("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}}class fc extends _o{constructor(){super(bi(fc.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;const t=bi(fc.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new fo({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:t.threshold}),this.attack=new fo({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:t.attack}),this.release=new fo({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:t.release}),this.knee=new fo({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:t.knee}),this.ratio=new fo({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:t.ratio}),ji(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(_o.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class _c extends _o{constructor(){super(Object.assign(bi(_c.getDefaults(),arguments,["threshold","smoothing"]))),this.name="Gate";const t=bi(_c.getDefaults(),arguments,["threshold","smoothing"]);this._follower=new ba({context:this.context,smoothing:t.smoothing}),this._gt=new Sr({context:this.context,value:Yi(t.threshold)}),this.input=new yo({context:this.context}),this._gate=this.output=new yo({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(_o.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return Hi(this._gt.value)}set threshold(t){this._gt.value=Yi(t)}get smoothing(){return this._follower.smoothing}set smoothing(t){this._follower.smoothing=t}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}class mc extends _o{constructor(){super(Object.assign(bi(mc.getDefaults(),arguments,["threshold"]))),this.name="Limiter";const t=bi(mc.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new fc({context:this.context,ratio:20,attack:0,release:0,threshold:t.threshold}),this.threshold=this._compressor.threshold,ji(this,"threshold")}static getDefaults(){return Object.assign(_o.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}class gc extends _o{constructor(){super(Object.assign(bi(gc.getDefaults(),arguments))),this.name="MidSideCompressor";const t=bi(gc.getDefaults(),arguments);this._midSideSplit=this.input=new Ya({context:this.context}),this._midSideMerge=this.output=new Ha({context:this.context}),this.mid=new fc(Object.assign(t.mid,{context:this.context})),this.side=new fc(Object.assign(t.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),ji(this,["mid","side"])}static getDefaults(){return Object.assign(_o.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}class vc extends _o{constructor(){super(Object.assign(bi(vc.getDefaults(),arguments))),this.name="MultibandCompressor";const t=bi(vc.getDefaults(),arguments);this._splitter=this.input=new uc({context:this.context,lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new yo({context:this.context}),this.low=new fc(Object.assign(t.low,{context:this.context})),this.mid=new fc(Object.assign(t.mid,{context:this.context})),this.high=new fc(Object.assign(t.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),ji(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(_o.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}class yc extends _o{constructor(){super(bi(yc.getDefaults(),arguments,["low","mid","high"])),this.name="EQ3",this.output=new yo({context:this.context}),this._internalChannels=[];const t=bi(yc.getDefaults(),arguments,["low","mid","high"]);this.input=this._multibandSplit=new uc({context:this.context,highFrequency:t.highFrequency,lowFrequency:t.lowFrequency}),this._lowGain=new yo({context:this.context,gain:t.low,units:"decibels"}),this._midGain=new yo({context:this.context,gain:t.mid,units:"decibels"}),this._highGain=new yo({context:this.context,gain:t.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),ji(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(_o.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),Li(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}class xc extends _o{constructor(){super(bi(xc.getDefaults(),arguments,["url","onload"])),this.name="Convolver",this._convolver=this.context.createConvolver();const t=bi(xc.getDefaults(),arguments,["url","onload"]);this._buffer=new Bi(t.url,e=>{this.buffer=e,t.onload()}),this.input=new yo({context:this.context}),this.output=new yo({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=t.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(_o.getDefaults(),{normalize:!0,onload:zi})}load(t){return di(this,void 0,void 0,(function*(){this.buffer=yield this._buffer.load(t)}))}get buffer(){return this._buffer.length?this._buffer:null}set buffer(t){t&&this._buffer.set(t),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));const e=this._buffer.get();this._convolver.buffer=e||null}get normalize(){return this._convolver.normalize}set normalize(t){this._convolver.normalize=t}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}}function wc(){return Qi().now()}function bc(){return Qi().immediate()}const Tc=Qi().transport;function Sc(){return Qi().transport}const kc=Qi().destination,Cc=Qi().destination;function Ac(){return Qi().destination}const Dc=Qi().listener;function Oc(){return Qi().listener}const Mc=Qi().draw;function Ec(){return Qi().draw}const Rc=Qi();function qc(){return Bi.loaded()}const Fc=Bi,Ic=Mo,Vc=Go}])}));\n//# sourceMappingURL=Tone.js.map'];
ik.raw=[""];hk(ee(ik));/*

 MIT License

 Copyright (c) 2014-2020 Yotam Mann

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.
*/
var S=l.Tone;const jk=Fh.$(),kk=document.createElement("canvas").getContext("2d");function lk(a){return new Promise(b=>{setTimeout(b,a)})}function mk(){"suspended"===S.context.state&&S.start()}function T(a){return document.getElementsByClassName(a)[0]}function V(a,b,c=!1){nk([a],b,c)}function W(a,b,c){V(a,b);V(a+":hover",c,!0)}function nk(a,b,c=!1){a=a.reduce((d,e)=>`${d}.${e}`,"");X(a,b,c)}
function X(a,b,c=!1){const d=document.querySelector("#hplogo style");var e=vf(R.$(),b);R.$();var f=b[3];R.$();var h=b[4];d&&d.sheet&&e&&f&&h&&(e=tf(R.$(),b),c?d.sheet.insertRule(` ${a} { background-position: ${e};}`):(e=vf(R.$(),b),R.$(),c=b[3],R.$(),d.sheet.insertRule(` ${a} {background: ${e};
          width: ${c}px;
          height: ${b[4]}px }`,d.sheet.cssRules.length)))}function ok(a,b){const c=document.querySelector("#hplogo style");let d="";for(let e=0;e<b.length;e++){const f=tf(R.$(),b[e]);d+=`${Math.round(100*e/b.length).toString()}% { background-position:${f}; }\n`}c&&c.sheet&&c.sheet.insertRule(`@keyframes ${a} { ${d} }`,c.sheet.cssRules.length)}
function pk(a,b){a.title=b;a.textContent=b;if("BUTTON"===a.tagName){var c=getComputedStyle(a);kk.font=""===c.font?(c.fontStyle+" "+c.fontVariant+" "+c.fontWeight+" "+c.fontSize+" "+c.fontFamily).replace(/ +/g," ").trim():c.font;c=Number(getComputedStyle(a).paddingLeft.replace("px",""))+Number(getComputedStyle(a).paddingRight.replace("px",""));b=(a.clientWidth-c)/kk.measureText(b).width;1>b&&(c=Number(getComputedStyle(a).fontSize.replace("px","")),a.style.fontSize=`${Math.round(c*b)}px`)}}
function Y(a,b){b=O(jk,b);pk(a,b)}
function qk(){const a=se(),b=qe("share",""),c=T("searchButton"),d=T("facebookButton"),e=T("twitterButton"),f=T("emailButton"),h=T("nativeShareButton"),k=T("ddl-copyLink_"),q=T("ddl-copyToast_");x(c,["click"],()=>{let n=google.doodle?google.doodle.url:"";n&&pe(n,!0)});F()&&(navigator.share||Kh()||Nd()&&D()&&!Od())?(d.style.display="none",e.style.display="none",f.style.display="none",x(h,["click"],()=>m(this,function*(){if(navigator.share)try{yield navigator.share({text:b,url:a})}catch(w){console.error(w)}else if(Kh())!te()&&
Kh()&&(fh(15),window.agsa_ext.share(b+" "+a,null));else{var n=a;te()||(fh(9),n=Jh(n),window.location="http://www.google.com/doodles/_SHARE?description="+encodeURIComponent(b)+"&url="+encodeURIComponent(n))}}))):(h.style.display="none",x(d,["click"],()=>{var n=re(qe("facebook_link",null)||se());te()||(n=Jh(n),n=Lh("https://www.facebook.com/dialog/share",{app_id:"738026486351791",href:n,hashtag:"#GoogleDoodle"}),wb(n),fh(5))}),x(e,["click"],()=>{var n=re(qe("twitter_link",null)||se());te()||(n=Jh(n),
n="text="+encodeURIComponent(b+"\n"+n),wb("http://twitter.com/intent/tweet?"+n),fh(6))}),x(f,["click"],()=>{var n=re(qe("email_link",null)||se());if(!te()){fh(8);var w=window.top.location;var r=void 0;r=void 0===r?ue:r;n=Jh(n);r=Lh("mailto:",{subject:r,body:b+"\n"+n});w.href=r}}));k.textContent=a;k.readOnly=!0;x(k,["click"],()=>{Mh(a);q&&!q.classList.contains("ddl-show_")&&(q.textContent=O(jk,"Share2"),q.classList.add("ddl-show_"),setTimeout(()=>{q.classList.remove("ddl-show_")},3E3))});c.title=O(jk,
"Search");d.title=O(jk,"Share Facebook");e.title=O(jk,"Share Twitter");f.title=O(jk,"Email");h.title=O(jk,"Share1");k.title=O(jk,"Copy share link")};var rk=class extends Bf{constructor(a,b){super();this.ha=a;this.s=b;this.W=new Ye;K(this.W,this);this.ha.appendChild(this.s)}H(){this.s.parentElement&&this.s.parentElement.removeChild(this.s);K(this,null)}};var sk={};function tk(){throw Error("u");}tk.prototype.xc=null;tk.prototype.toString=function(){return this.jc};function uk(){tk.call(this)}ta(uk,tk);uk.prototype.yc=sk;var vk=function(a){function b(c){this.jc=c}b.prototype=a.prototype;return function(c,d){c=new b(String(c));void 0!==d&&(c.xc=d);return c}}(uk);function Z(a){return null!=a&&a.yc===sk?String(String(a.jc).replace(wk,"").replace(xk,"&lt;")).replace(yk,zk):String(a).replace(Ak,zk)}
const Bk={"\x00":"&#0;","\t":"&#9;","\n":"&#10;","\x0B":"&#11;","\f":"&#12;","\r":"&#13;"," ":"&#32;",'"':"&quot;","&":"&amp;","'":"&#39;","-":"&#45;","/":"&#47;","<":"&lt;","=":"&#61;",">":"&gt;","`":"&#96;","\u0085":"&#133;","\u00a0":"&#160;","\u2028":"&#8232;","\u2029":"&#8233;"};function zk(a){return Bk[a]}const Ak=/[\x00\x22\x26\x27\x3c\x3e]/g,yk=/[\x00\x22\x27\x3c\x3e]/g,Ck=/^[a-zA-Z0-9+\/_-]+={0,2}$/,wk=/<(?:!|\/?([a-zA-Z][a-zA-Z0-9:\-]*))(?:[^>'"]|"[^"]*"|'[^']*')*>/g,xk=/</g;function Dk(){var a=Ek,b=ya||(ya=new hd);a=a(Fk,void 0);a=Gk(a);var c=b.g;b=gd(c,"DIV");nc?(a=sb(tb,a),vb(b,a),b.removeChild(b.firstChild)):vb(b,a);if(1==b.childNodes.length)b=b.removeChild(b.firstChild);else{for(a=c.createDocumentFragment();b.firstChild;)a.appendChild(b.firstChild);b=a}return b}function Hk(a,b){b=a(b||Fk,void 0);a=ya||(ya=new hd);a=gd(a.g,"DIV");b=Gk(b);vb(a,b);1==a.childNodes.length&&(b=a.firstChild,1==b.nodeType&&(a=b));return a}
function Gk(a){if(na(a))if(a instanceof tk){if(a.yc!==sk)throw Error("v");a=pb(a.toString(),a.xc||null)}else a=ob("zSoyz");else a=ob(String(a));return a}var Fk={};function Ek(a,b){(a=b&&b.Qc)?(a=String(a),a=Ck.test(a)?a:"zSoyz",a=' nonce="'+Z(a)+'"'):a="";a=vk("<style"+a+">\n#hpcanvas{background:url(/logos/2021/doodles/savoy/cta.png) no-repeat center;-webkit-background-size:contain;-o-background-size:contain;background-size:contain;background-position:center}#playbtn{background:url(/logos/2021/doodles/savoy/playbutton.png) no-repeat center;-webkit-background-size:contain;-o-background-size:contain;background-size:contain}#playbtn.ddl-animated_{-webkit-animation:scaleplay 0.75s ease-in-out infinite alternate;-o-animation:scaleplay 0.75s ease-in-out infinite alternate;animation:scaleplay 0.75s ease-in-out infinite alternate;-webkit-animation:scaleplay 0.75s ease-in-out infinite alternate}@keyframes scaleplay{0%{-webkit-transform:translate(-50%,-50%) scale(1.0);-ms-transform:translate(-50%,-50%) scale(1.0);-o-transform:translate(-50%,-50%) scale(1.0);transform:translate(-50%,-50%) scale(1.0)}100%{-webkit-transform:translate(-50%,-50%) scale(1.3);-ms-transform:translate(-50%,-50%) scale(1.3);-o-transform:translate(-50%,-50%) scale(1.3);transform:translate(-50%,-50%) scale(1.3)}}.ddl-fillParent_,.ddl-relativeContainer_{left:0;top:0;width:100%;height:100%}.ddl-fillParent_{position:absolute}.ddl-relativeContainer_{position:relative;background:transparent}.ddl-domRoot_{pointer-events:none;position:absolute}.ddl-domRootLightboxed_{left:0;top:0}.ddl-closeLightboxBtn_,.ddl-closeFullscreenBtn_{z-index:3000}.ddl-gameCanvas_{pointer-events:auto;background:none;position:absolute;width:100%;height:100%;z-index:-1;top:0;left:0}.ddl-closeButton_{pointer-events:all;cursor:pointer;position:absolute;top:5px;right:5px;z-index:5}.ddl-expanderHide_{opacity:0}.ddl-font_{font-family:'Quicksand',sans-serif;font-weight:800;-webkit-transform:translate(-50%,0);-ms-transform:translate(-50%,0);-o-transform:translate(-50%,0);transform:translate(-50%,0);color:#f0e4d0;text-align:left}.ddl-scene_{position:absolute;-webkit-align-items:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;width:100%;height:100%}.ddl-levelBackground_{pointer-events:none;z-index:-2;position:absolute;display:-webkit-box;display:-moz-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;width:100%;height:100%}.ddl-decorativeBorder_{position:absolute;width:100%;height:100%}.ddl-borderNE_{position:absolute;top:0;right:0}.ddl-borderN_{z-index:-2;position:absolute;top:0;margin:auto}.ddl-borderNW_{z-index:1;position:absolute;top:0;left:0}.ddl-borderW_{z-index:-2;position:absolute;margin:auto;left:0}.ddl-borderSW_{z-index:-2;position:absolute;bottom:0;left:0}.ddl-borderS_{z-index:-2;position:absolute;bottom:0;margin:auto}.ddl-borderSE_{z-index:-2;position:absolute;bottom:0;right:0}.ddl-borderE_{z-index:-2;position:absolute;margin:auto;right:0}.ddl-gameplayScore_{position:absolute;color:#ffc38f;font-size:40pt;font-family:'Limelight',sans-serif;-webkit-transform:translate(-50%,0);-ms-transform:translate(-50%,0);-o-transform:translate(-50%,0);transform:translate(-50%,0);left:50%;top:8px}.ddl-pauseButton_{z-index:2;pointer-events:all;cursor:pointer;position:absolute;top:5px;left:5px}.ddl-blackScene_{background-color:black;display:-webkit-box;display:-moz-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-justify-content:center;justify-content:center;opacity:1;z-index:4;visibility:hidden}.ddl-blackScene_.ddl-fade_{-webkit-transition:opacity .3s;-o-transition:opacity .3s;transition:opacity .3s}.ddl-introText_{font-family:'Quicksand',sans-serif;font-weight:700;font-size:30px;color:#fffcf5;text-align:center;width:65%;position:absolute;bottom:50%;-webkit-animation:glow 1s ease-in-out infinite alternate;-o-animation:glow 1s ease-in-out infinite alternate;animation:glow 1s ease-in-out infinite alternate}.ddl-introDancers_{position:absolute;top:55%;-webkit-animation:dancerAnimation 0.6s infinite steps(1,end);-o-animation:dancerAnimation 0.6s infinite steps(1,end);animation:dancerAnimation 0.6s infinite steps(1,end)}.ddl-target_{display:block;position:absolute;z-index:2;pointer-events:all;width:140px;height:140px;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}@keyframes glow{from{text-shadow:0 0 1px #ffc38f,0 0 5px #ffc38f,0 0 15px #bb8449}to{text-shadow:0 0 10px #ffd5ba,0 0 15px #ffc38f,0 0 25px #ffc38f}}.ddl-modeSelectMenu_{z-index:1}.ddl-modeSelectBackground_{position:absolute;width:100%;height:100%}.ddl-modeSelectDoor_{cursor:pointer;pointer-events:all;position:absolute}.ddl-modeSelectLeftPlayerIcon_{position:absolute;left:28%;top:35%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.ddl-modeSelectRightPlayerIcon_{position:absolute;left:72%;top:35%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.ddl-modeSelectDevice_{position:absolute;left:50%;top:35%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.ddl-modeSelectDancer_{position:absolute;left:50%;top:18%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.ddl-modeSelectDoor_:hover .ddl-modeSelectDancer_{-webkit-animation:dancerAnimation 0.6s infinite steps(1,end);-o-animation:dancerAnimation 0.6s infinite steps(1,end);animation:dancerAnimation 0.6s infinite steps(1,end)}.ddl-onePlayerSelect_{left:486px;top:110px}.ddl-twoPlayerSelect_{left:78px;top:110px}.ddl-modeSelectText_{text-align:center;width:100%;position:absolute;font-size:50px;left:50%;top:55%}.ddl-modeSelectDoor_:hover .ddl-modeSelectText_{text-shadow:1px 1px 15px #ffcd59;color:white}@keyframes noteGlow{0%{opacity:0}47%{opacity:0}50%{opacity:1}97%{opacity:1}}@keyframes savoyGlow{0%{opacity:0.85}70%{opacity:1}100%{opacity:0.85}}@keyframes marqueeGlow{0%{opacity:0}70%{opacity:1}100%{opacity:0}}.ddl-modeSelectNoteOne_{position:absolute;left:60px;-webkit-animation:noteGlow 2s linear infinite;-o-animation:noteGlow 2s linear infinite;animation:noteGlow 2s linear infinite}.ddl-modeSelectNoteTwo_{position:absolute;left:156px;-webkit-animation:noteGlow 2s linear -1s infinite;-o-animation:noteGlow 2s linear -1s infinite;animation:noteGlow 2s linear -1s infinite}.ddl-modeSelectNoteThree_{position:absolute;left:701px;-webkit-animation:noteGlow 2s linear -1s infinite;-o-animation:noteGlow 2s linear -1s infinite;animation:noteGlow 2s linear -1s infinite}.ddl-modeSelectNoteFour_{position:absolute;left:795px;-webkit-animation:noteGlow 2s linear infinite;-o-animation:noteGlow 2s linear infinite;animation:noteGlow 2s linear infinite}.ddl-modeSelectSavoy_{position:absolute;left:258px;-webkit-animation:savoyGlow 3s infinite;-o-animation:savoyGlow 3s infinite;animation:savoyGlow 3s infinite}.ddl-modeSelectGlow_{position:absolute;-webkit-animation:marqueeGlow 3s infinite;-o-animation:marqueeGlow 3s infinite;animation:marqueeGlow 3s infinite}.ddl-tutorialBackground_{position:absolute;width:100%;height:100%}.ddl-dancerOneContainer_{overflow:hidden;position:absolute;bottom:0;left:0;width:250px;height:250px}.ddl-dancerTwoContainer_{overflow:hidden;position:absolute;bottom:0;right:0;width:250px;height:250px}.ddl-dancerOneSelect_{position:absolute;bottom:0;left:0;width:197px;height:248px;pointer-events:all;cursor:pointer}.ddl-dancerTwoSelect_{position:absolute;bottom:0;right:0;width:219px;height:246px;pointer-events:all;cursor:pointer}@keyframes dancerOneFadeOut{from{left:0}to{left:-197px}}@keyframes dancerOneFadeIn{from{left:-197px}to{left:0}}@keyframes dancerTwoFadeOut{from{right:0}to{right:-219px}}@keyframes dancerTwoFadeIn{from{right:-219px}to{right:0}}.ddl-dancerFadeOut_{-webkit-animation-duration:0.4s;-o-animation-duration:0.4s;animation-duration:0.4s}.ddl-dancerOneSelect_.ddl-dancerFadeOut_{-webkit-animation-name:dancerOneFadeOut;-o-animation-name:dancerOneFadeOut;animation-name:dancerOneFadeOut}.ddl-dancerTwoSelect_.ddl-dancerFadeOut_{-webkit-animation-name:dancerTwoFadeOut;-o-animation-name:dancerTwoFadeOut;animation-name:dancerTwoFadeOut}.ddl-dancerFadeIn_{-webkit-animation-duration:0.4s;-o-animation-duration:0.4s;animation-duration:0.4s}.ddl-dancerOneSelect_.ddl-dancerFadeIn_{-webkit-animation-name:dancerOneFadeIn;-o-animation-name:dancerOneFadeIn;animation-name:dancerOneFadeIn}.ddl-dancerTwoSelect_.ddl-dancerFadeIn_{-webkit-animation-name:dancerTwoFadeIn;-o-animation-name:dancerTwoFadeIn;animation-name:dancerTwoFadeIn}.ddl-dancerOneToggle_{width:83px;height:83px;position:absolute;left:134px;bottom:20px;pointer-events:all;cursor:pointer}.ddl-dancerTwoToggle_{width:83px;height:83px;position:absolute;right:134px;bottom:20px;pointer-events:all;cursor:pointer}.ddl-tutorialHeader_{position:absolute;width:100%;font-weight:bolder;top:3%;color:#564a36;text-align:center;font-size:50pt;left:50%}.ddl-tutorialDiagram_{position:absolute;width:357px;height:219px;-webkit-transform:translate(-50%,0);-ms-transform:translate(-50%,0);-o-transform:translate(-50%,0);transform:translate(-50%,0);top:120px}.ddl-diagramOne_{left:290px}.ddl-diagramTwo_{left:674px;-webkit-animation:tutorialAnimation 3s infinite steps(1,end);-o-animation:tutorialAnimation 3s infinite steps(1,end);animation:tutorialAnimation 3s infinite steps(1,end)}.ddl-diagramOneText_{color:#392c18;position:absolute;font-weight:bolder;left:290px;text-align:center;top:63%;width:338px;font-size:15pt}.ddl-diagramTwoText_{font-weight:bolder;color:#392c18;position:absolute;left:674px;text-align:center;top:63%;width:338px;font-size:15pt}.ddl-skipTutorialButton_{position:absolute;left:50%;-webkit-transform:translate(-50%,0);-ms-transform:translate(-50%,0);-o-transform:translate(-50%,0);transform:translate(-50%,0);pointer-events:all;cursor:pointer;font-weight:bolder;bottom:15px;padding:0 35px;font-family:'Quicksand',sans-serif;white-space:nowrap;width:195px;height:126px;border:none;color:#564a36;font-size:28pt}.ddl-photoScene_{overflow:hidden;display:-webkit-box;display:-moz-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-justify-content:center;justify-content:center;z-index:3}.ddl-photoBg_{width:100%;height:100%}.ddl-poster_{position:absolute;left:10px;top:5px}.ddl-posterText_{position:absolute;left:14%;top:30%;-webkit-transform:rotate(-10deg);-ms-transform:rotate(-10deg);-o-transform:rotate(-10deg);transform:rotate(-10deg);font-family:'Sigmar One',sans-serif;color:#564a36;font-size:25px;width:250px;font-size:20px;line-height:1.1;text-align:center}.ddl-rightSide_{left:70%;top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%);position:absolute;text-align:center}.ddl-rightSideCountIn_{left:72%;top:13%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%);position:absolute;text-align:center}.ddl-pauseBg_{width:100%;height:100%}.ddl-pausedLabel_{font-family:'Limelight',sans-serif;font-size:45px;color:#fdf2e5;height:55px}.ddl-postLevelText_{color:#fdf2e5}.ddl-song_{font-size:30px;font-weight:900;font-family:'Limelight',sans-serif;width:560px;height:40px;text-shadow:0px 0px 10px black}.ddl-artist_{font-size:20px;font-family:'Quicksand',sans-serif;font-weight:bold;text-shadow:0px 0px 10px black}.ddl-ratings_{display:inline-block;margin:15px}.ddl-note1_{position:absolute;-webkit-transform:translate(81px,-14px);-ms-transform:translate(81px,-14px);-o-transform:translate(81px,-14px);transform:translate(81px,-14px)}.ddl-note2_{position:absolute;-webkit-transform:translate(154px,-14px);-ms-transform:translate(154px,-14px);-o-transform:translate(154px,-14px);transform:translate(154px,-14px)}.ddl-note3_{position:absolute;-webkit-transform:translate(204px,-14px);-ms-transform:translate(204px,-14px);-o-transform:translate(204px,-14px);transform:translate(204px,-14px)}.ddl-score_{font-size:35px;font-family:'Quicksand',sans-serif;font-weight:bold;text-shadow:0px 0px 10px black}.ddl-accuracy_{font-size:25px;height:40px;margin-bottom:-29px;font-family:'Quicksand',sans-serif;font-weight:bold;text-shadow:0px 0px 10px black}.ddl-rowButton_{display:inline-block;pointer-events:all;cursor:pointer}.ddl-textButton_{color:#564a36;font-size:25px;border:none;display:inline;pointer-events:all;font-family:'Quicksand',sans-serif;font-weight:bold;padding:0 33px;cursor:pointer;position:relative}.ddl-share_{margin-top:40px;height:80px}.ddl-copyLink_{-webkit-user-select:all;-moz-user-select:all;-ms-user-select:all;-webkit-box-sizing:border-box;box-sizing:border-box;color:#564a36;overflow:hidden;margin:10px;padding:12px;font-size:18px;white-space:nowrap;resize:none;border:none;display:inline-block;pointer-events:all;cursor:pointer;outline:none;font-family:'Quicksand',sans-serif;font-weight:bold}.ddl-copyToast_{background-color:#564a36;color:#fffcf5;font-size:16px;font-family:'Quicksand',sans-serif;text-align:center;opacity:0;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;padding:16px;position:absolute;left:50%;bottom:30px;-webkit-transform:translate(-50%,0);-ms-transform:translate(-50%,0);-o-transform:translate(-50%,0);transform:translate(-50%,0)}.ddl-copyToast_.ddl-show_{-webkit-animation:toastAnim 3s;-o-animation:toastAnim 3s;animation:toastAnim 3s;-webkit-animation-iteration-count:1;-o-animation-iteration-count:1;animation-iteration-count:1}@keyframes toastAnim{0%{bottom:0;opacity:0}20%{bottom:30px;opacity:1}80%{bottom:30px;opacity:1}100%{bottom:0;opacity:0}}.ddl-level_{height:110px}.ddl-centeredDiv_{white-space:nowrap}.ddl-countInText_{color:#fdf2e5;text-align:center;position:absolute}.ddl-countdown_{top:52%;text-shadow:4px 4px 10px #000000;text-align:center;font-family:'Limelight',sans-serif;font-weight:bolder;text-shadow:0px 0px 10px black;font-size:40px;color:#fdf2e5}.ddl-song_.ddl-countInText_{top:15%;font-size:36px;font-family:'Limelight',sans-serif;width:100%;text-shadow:0px 0px 10px black;color:#fdf2e5}.ddl-artist_.ddl-countInText_{top:23%;font-size:22px;font-family:'Quicksand',sans-serif;text-shadow:0px 0px 10px black;font-weight:bold;color:#fdf2e5}.ddl-funFact_.ddl-countInText_{width:70%;font-size:26px;font-family:'Quicksand',sans-serif;bottom:10%;text-shadow:0px 0px 10px black;font-weight:bold;color:#fdf2e5}.ddl-lightbox_{display:-webkit-box;display:-moz-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden;opacity:0;z-index:1000;background-color:rgba(0,0,0,0.8);visibility:hidden}.ddl-lightboxContainer_{position:relative;height:90%;width:90%}.ddl-lightboxContent_{-webkit-transform-origin:0 0;-ms-transform-origin:0 0;-o-transform-origin:0 0;transform-origin:0 0}.ddl-lightboxEnabled_{opacity:1;visibility:visible}\n</style>");
return vk(a)}function Ik(){return vk('<div class="'+Z("ddl-domRoot_")+'"></div>')}
function Jk(){return vk("<div id='levelScene' class=\""+Z("levelScene")+" "+Z("ddl-scene_")+'"><div id="levelBackground" class="'+Z("ddl-levelBackground_")+'"></div><div id="decorativeBorder" class="'+Z("ddl-decorativeBorder_")+'"><div class="'+Z("ddl-borderN_")+'"><div id="gameplayScore" class="'+Z("ddl-gameplayScore_")+'"></div></div><div class="'+Z("ddl-borderW_")+'"></div><div class="'+Z("ddl-borderS_")+'"></div><div class="'+Z("ddl-borderE_")+'"></div><div class="'+Z("ddl-borderNE_")+'"></div><div class="'+
Z("ddl-borderNW_")+'"><div id="pauseButton" class="'+Z("ddl-pauseButton_")+'"></div></div><div class="'+Z("ddl-borderSW_")+'"></div><div class="'+Z("ddl-borderSE_")+'"></div></div></div>')}function Kk(){return vk('<div class="'+Z("ddl-blackScene_")+" "+Z("ddl-scene_")+'"><div class="'+Z("ddl-introText_")+'"></div><div class="'+Z("ddl-introDancers_")+'"></div></div>')}
function Lk(){return vk("<div id='modeSelectMenu' class=\""+Z("ddl-scene_")+'"><div class="'+Z("ddl-modeSelectBackground_")+'"></div><div class="'+Z("ddl-twoPlayerSelect_")+" "+Z("ddl-modeSelectDoor_")+'"><div class="'+Z("ddl-modeSelectLeftPlayerIcon_")+'"></div><div class="'+Z("ddl-modeSelectRightPlayerIcon_")+'"></div><div class="'+Z("ddl-modeSelectDevice_")+'"></div><div class="'+Z("ddl-modeSelectDancer_")+'"></div><div class="'+Z("twoPlayerText")+" "+Z("ddl-modeSelectText_")+" "+Z("ddl-font_")+
'"></div></div><div class="'+Z("ddl-onePlayerSelect_")+" "+Z("ddl-modeSelectDoor_")+'"><div class="'+Z("ddl-modeSelectRightPlayerIcon_")+'"></div><div class="'+Z("ddl-modeSelectDevice_")+'"></div><div class="'+Z("ddl-modeSelectDancer_")+'"></div><div class="'+Z("onePlayerText")+" "+Z("ddl-modeSelectText_")+" "+Z("ddl-font_")+'"></div></div><div class="'+Z("ddl-modeSelectNoteOne_")+'"></div><div class="'+Z("ddl-modeSelectNoteTwo_")+'"></div><div class="'+Z("ddl-modeSelectNoteThree_")+'"></div><div class="'+
Z("ddl-modeSelectNoteFour_")+'"></div><div class="'+Z("ddl-modeSelectSavoy_")+'"></div><div class="'+Z("ddl-modeSelectGlow_")+'"></div></div>')}
function Mk(){return vk("<div id='tutorialMenu' class=\""+Z("tutorial")+" "+Z("ddl-scene_")+'"><div class="'+Z("ddl-tutorialBackground_")+'"></div><div class="'+Z("ddl-tutorialHeader_")+" "+Z("ddl-font_")+'"></div><div class="'+Z("ddl-dancerOneContainer_")+'"><div class="'+Z("ddl-dancerOneSelect_")+'"></div></div><div class="'+Z("ddl-dancerOneToggle_")+'"></div><div class="'+Z("ddl-dancerTwoContainer_")+'"><div class="'+Z("ddl-dancerTwoSelect_")+'"></div></div><div class="'+Z("ddl-dancerTwoToggle_")+
'"></div><div class="'+Z("ddl-diagramOne_")+" "+Z("ddl-tutorialDiagram_")+'"></div><div class="'+Z("ddl-diagramOneText_")+" "+Z("ddl-font_")+'"></div><div class="'+Z("ddl-diagramTwo_")+" "+Z("ddl-tutorialDiagram_")+'"></div><div class="'+Z("ddl-diagramTwoText_")+" "+Z("ddl-font_")+'"></div><button class="'+Z("ddl-skipTutorialButton_")+'"></button></div>')}
function Nk(){return vk("<div id='countIn' class=\""+Z("ddl-photoScene_")+" "+Z("ddl-scene_")+'"><div class="'+Z("ddl-photoBg_")+'"></div><div class="'+Z("ddl-countdown_")+" "+Z("ddl-countInText_")+'"></div><div class="'+Z("ddl-song_")+" "+Z("ddl-countInText_")+'"></div><div class="'+Z("ddl-artist_")+" "+Z("ddl-countInText_")+'"></div><div class="'+Z("ddl-funFact_")+" "+Z("ddl-countInText_")+'"></div><div class="'+Z("countinBorder")+'"></div></div>')}
function Ok(a){a=a.Bc;return vk("<div id='levelEndMenu' class=\""+Z("ddl-photoScene_")+" "+Z("ddl-scene_")+'"><div class="'+Z("ddl-photoBg_")+'"></div><div class="'+Z("ddl-poster_")+'"><div class="'+Z("ddl-posterText_")+'"></div></div><div class="'+Z("ddl-rightSide_")+'"><div class="'+Z("ddl-song_")+" "+Z("ddl-postLevelText_")+'"></div><div class="'+Z("ddl-artist_")+" "+Z("ddl-postLevelText_")+'"></div><div class="'+Z("ddl-ratings_")+'"><div class="'+Z("ddl-note1_")+'"></div><div class="'+Z("ddl-note2_")+
'"></div><div class="'+Z("ddl-note3_")+'"></div></div><div class="'+Z("ddl-score_")+" "+Z("ddl-postLevelText_")+'"></div><div class="'+Z("ddl-accuracy_")+" "+Z("ddl-postLevelText_")+'"></div><div class="'+Z("ddl-share_")+" "+Z("ddl-centeredDiv_")+'"><div class="'+Z("searchButton")+" "+Z("ddl-rowButton_")+'"></div><div class="'+Z("facebookButton")+" "+Z("ddl-rowButton_")+'"></div><div class="'+Z("twitterButton")+" "+Z("ddl-rowButton_")+'"></div><div class="'+Z("emailButton")+" "+Z("ddl-rowButton_")+
'"></div><div class="'+Z("nativeShareButton")+" "+Z("ddl-rowButton_")+'"></div><textarea class="'+Z("ddl-copyLink_")+'"></textarea></div><div class="'+Z("ddl-level_")+" "+Z("ddl-centeredDiv_")+'">'+(a?'<button class="'+Z("retryLevelButton")+" "+Z("ddl-textButton_")+'"></button><button class="'+Z("nextLevelButton")+" "+Z("ddl-textButton_")+'"></button>':'<button class="'+Z("retryLevelButton")+" "+Z("ddl-textButton_")+'"></button>')+'</div></div><div class="'+Z("ddl-copyToast_")+'"></div></div>')}
function Pk(){return vk("<div id='pauseMenu' class=\""+Z("ddl-photoScene_")+" "+Z("ddl-scene_")+'"><img class="'+Z("ddl-photoBg_")+'"><div class="'+Z("ddl-poster_")+'"><div class="'+Z("ddl-posterText_")+'"></div></div><div class="'+Z("ddl-rightSide_")+'"><div class="'+Z("ddl-pausedLabel_")+" "+Z("ddl-postLevelText_")+'"></div><button class="'+Z("resumeButton")+" "+Z("ddl-textButton_")+'"></button><div class="'+Z("ddl-level_")+" "+Z("ddl-centeredDiv_")+'"><button class="'+Z("retryLevelButton")+" "+
Z("ddl-textButton_")+'"></button><button class="'+Z("startOverButton")+" "+Z("ddl-textButton_")+'"></button></div><div class="'+Z("ddl-share_")+" "+Z("ddl-centeredDiv_")+'"><div class="'+Z("searchButton")+" "+Z("ddl-rowButton_")+'"></div><div class="'+Z("facebookButton")+" "+Z("ddl-rowButton_")+'"></div><div class="'+Z("twitterButton")+" "+Z("ddl-rowButton_")+'"></div><div class="'+Z("emailButton")+" "+Z("ddl-rowButton_")+'"></div><div class="'+Z("nativeShareButton")+" "+Z("ddl-rowButton_")+'"></div><textarea class="'+
Z("ddl-copyLink_")+'"></textarea></div></div><div class="'+Z("ddl-copyToast_")+'"></div></div>')};const Qk=Fh.$();function Rk(a,b){a.N.style.visibility=b?"visible":"hidden"}var Sk=class extends rk{constructor(a){super(a,Hk(Kk));this.ha=a;this.v=T("ddl-blackScene_");this.text=T("ddl-introText_");this.N=T("ddl-introDancers_")}i(a){this.v.style.opacity=a.toString()}};const Wk=new Map([[1,Tk],[3,Uk],[2,Vk]]);function Tk(a){a=Xk(a%.5*2);return 1.4*(.5>a?a:1-a)}function Vk(a){a=Xk(a%.5*2);return.7*(.5>a?a:1-a)}function Uk(a){return-1*Tk(a)}const Xk=ig(.35,.85,.65,.15);const $k=new Map([[0,a=>a],[1,mg],[2,ng],[3,pg],[4,ig(.3,.6,.7,.4)],[5,Yk],[6,Zk]]);function Yk(a){return al(a,4)}function Zk(a){return al(a,2)}function al(a,b){b=1/b;const c=ng(a%b/b)*b;return Math.floor(a/b)*b+c}const ll=new Map([[0,bl],[1,cl],[2,dl],[3,el],[4,fl],[6,gl],[5,hl],[8,il],[7,jl],[9,kl]]);function bl(a,b,c){return J(a,b,c)}function cl(a,b,c,d){a=J(a,b,c);a.add(new I(0,(-(c*c)+c)*(d?d:8),0));return a}function dl(a,b,c,d){a=J(a,b,c);a.add(new I((-(c*c)+c)*(d?d:9),0,0));return a}
function el(a,b,c,d){a=J(a,b,c);d=[[1,1],[1,-1],[-1,1],[-1,-1]][d?d:0];c=7.2*(-(c*c)+c);a.add(new I(c*d[0],c*d[1],0));return a}function fl(a,b,c,d){a=J(a,b,c);d=[[1,1],[1,-1],[-1,1],[-1,-1]][d?d:0];c=3*(-(c*c)+c);a.add(new I(c*d[0],c*d[1],0));return a}function hl(a,b,c,d){a=J(a,b,c);a.add(new I(0,Math.sin(2*Math.PI*c)*(d?d:1.5),0));return a}function gl(a,b,c,d){a=J(a,b,c);a.add(new I(0,Math.sin(4*Math.PI*c)*(d?d:1.5),0));return a}
function jl(a,b,c,d){a=J(a,b,c);a.add(new I(Math.sin(2*Math.PI*c)*(d?d:1),0,0));return a}function il(a,b,c){const d=J(a,b,c);return.3<c&&.7>c?(a=(c-.3)/(.7-.3)+.75,d.add(new I(Math.cos(2*Math.PI*a),Math.sin(2*Math.PI*a)+1,0)),d):J(a,b,c)}function kl(a,b,c){const d=J(a,b,c);return.2<c&&.5>c?(a=(c-.2)/.3+.75,d.add(new I(.6*Math.cos(2*Math.PI*a),.6*(Math.sin(2*Math.PI*a)+1),0)),d):.5<=c&&.8>c?(a=(c-.5)/(.8-.5)+.75,d.add(new I(.6*Math.cos(2*Math.PI*a),-.6*(Math.sin(2*Math.PI*a)+1),0)),d):J(a,b,c)};const ml=Fh.$();function nl(a){return m(a,function*(){for(let b=3;0<b;b--)Xe(this.W,new qg(1E3,0,1,c=>{var d=b;this.v.style.fontSize="150px";this.v.innerText=d.toString();c=1+(1-og(c));this.v.style.transform=`translateY(-50%) scale(${c})`}));return new Promise(b=>{Xe(this.W,new Ve(0,void 0,()=>{b(0)}))})})}
var ol=class extends rk{constructor(a,b,c,d=0){super(c,Hk(Nk));this.T=a;this.N=b;this.ha=c;this.v=T("ddl-countdown_");this.v.innerText=O(ml,"Loading");T("ddl-song_").textContent=O(ml,this.T);T("ddl-artist_").textContent=O(ml,this.N);T("ddl-funFact_").innerText=O(ml,"Fact"+(d+1).toString())}};const pl=Rf.$();
var rl=class extends Bf{constructor(a,b){super();this.s=b;this.N=this.wa=!1;this.tc=0;this.va=!1;this.Dc=new Ye;b=fk.get(a.La);a=fk.get(a.Ma);this.H=new Of({Ia:b.tb,Oa:b.rb});this.T=new Of({Ia:b.mb,Oa:b.kb});this.Ja=new Of({Ia:b.Gb,Oa:b.Fb});this.Ba=new Of({Ia:b.wb,Oa:b.vb});this.W=new Of({Ia:b.Cb,Oa:b.Bb});this.v=new Of({Ia:a.tb,Oa:a.rb});this.ka=new Of({Ia:a.mb,Oa:a.kb});this.Xa=new Of({Ia:a.Gb,Oa:a.Fb});this.Ka=new Of({Ia:a.wb,Oa:a.vb});this.oa=new Of({Ia:a.Cb,Oa:a.Bb});this.wc=[this.H,this.T,
this.Ja,this.Ba,this.W,this.v,this.ka,this.Xa,this.Ka,this.oa];for(const c of this.wc)K(c,this),L(c,1.34),c.i(0);K(this.Dc,this);pl.addListener(this)}g(){if(!this.wa){var a=this.s.i;a=((S.Transport.seconds>a.startTime?ql(a):ql(this.s.s))+this.s.i.W.length)%2/2;this.tc>a&&(this.N?this.N=!1:this.va&&.25>Math.random()&&(this.N=!0));var b=S.Transport.seconds>this.s.i.startTime?this.N?[this.W,this.oa]:[this.H,this.v]:[this.T,this.ka];.5>a?(this.H.ta=2,this.v.ta=1):(this.H.ta=1,this.v.ta=2);this.tc=a;for(var c of b){b=
c.Lb;var d=Math.floor(a*b.o.frames.length);if(b.g!==d){var e=b;e.g=d;e=e.O;e.g=Date.now()-d*e.u;Lf(b)}}}for(var f of this.wc)f.i(0);this.wa?(c=this.qc?this.Ba:this.Ja,f=this.qc?this.Ka:this.Xa,c.s=!1,f.s=!1,c.i(1),f.i(1)):S.Transport.seconds>this.s.i.startTime?this.N?(this.W.i(1),this.oa.i(1)):(this.H.i(1),this.v.i(1)):(this.T.i(1),this.ka.i(1))}ac(a){9===a&&(this.va=!0);10===a&&(this.va=!1)}};const sl=Fh.$();function tl(a){Xe(a.W,new qg(500,0,1,b=>{a.oa.style.opacity=b.toString();a.va.style.transform=`translate(${-100*(1-b)}%, 0px) rotate(${-20*(1-b)}deg)`;a.wa.style.transform=`translate(${100*(1-b-.5)}%, -50%)`},{Xb:og}))}
function ul(a){Y(T("ddl-posterText_"),`Fact${a.v.N+1}`);Y(T("ddl-song_"),a.v.T.name);Y(T("ddl-artist_"),a.v.T.Sa);var b=a.v.v.o;vl(a,0);b=new qg(1E3,0,b,d=>{vl(a,d)});var c=wl(a.v.v);xl(a,0);c=new qg(1E3,0,c,d=>{xl(a,d)});Xe(a.W,new We([b,c]));Y(a.ka,"Retry");a.N&&(a.Ka?Y(a.N,"Bonus"):Y(a.N,"Next"))}function yl(a){y(a.ka,["click"],()=>{mk();a.H();zl(a.T);Al(a.T,a.v.N)});a.N&&y(a.N,["click"],()=>{mk();a.H();zl(a.T);Al(a.T,a.v.N+1)})}
function vl(a,b){pk(a.Ja,O(sl,"Score").replace("{{}}",Math.round(b).toString()))}function xl(a,b){pk(a.Ba,O(sl,"Accuracy").replace("{{}}",(100*b).toFixed(0).toString()+"%"))}
var Bl=class extends rk{constructor(a,b,c,d=!0,e=!1){super(c,Hk(Ok,{Bc:d}));this.T=a;this.v=b;this.ha=c;this.Bc=d;this.Ka=e;this.ka=T("retryLevelButton");this.N=T("nextLevelButton");this.Ja=T("ddl-score_");this.Ba=T("ddl-accuracy_");this.oa=T("ddl-photoBg_");this.va=T("ddl-poster_");this.wa=T("ddl-rightSide_");qk();tl(this);ul(this);yl(this);a=T("ddl-note2_");b=T("ddl-note3_");c=wl(this.v.v);c<this.v.T.Ra&&(b.style.visibility="hidden");c<this.v.T.Ua&&(a.style.visibility="hidden")}};var Gl=class extends Bf{constructor(a,b,c,d){var e;super();this.Ba=a;this.N=b;this.wa=c;this.va=d;this.oa=null;this.source=new I(0,0,0);this.Ja=null;this.ka=0;this.Ka=1;this.W=new Ye;this.s=new bg(Cl[this.va]);this.v=new bg(Dl[this.va]);L(this.s,1.34);L(this.v,1.34);Xf(this.s,0,-.3);Xf(this.v,0,-.3);Yf(this.s,!1);Yf(this.v,!1);K(this.s,this);K(this.v,this);this.Xa=new lf(this.s);K(this.Xa,this);this.T=this.Ba.shift();K(this.W,this);this.bounce=null!==(e=this.T.bounce)&&void 0!==e?e:0}g(){if(this.H&&
El(this.H,this.N).i.length){var a=El(this.H,this.N).o,b=Fl(El(this.H,this.N));if(a!==this.oa){var c,d;this.oa=a;this.source=this.wa.get(a.value.Ha);this.Ja=this.T;this.T=null!==(c=this.Ba.shift())&&void 0!==c?c:this.Ja;this.bounce=null!==(d=this.T.bounce)&&void 0!==d?d:this.bounce;this.Ka++;Wj&&console.debug(`choreo ${this.N+1} Motion: ${this.Ka}`)}a=this.wa.get(b.value.Ha);b=this.source;d=ql(El(this.H,this.N));c=this.T;$k.has(c.easing)?ll.has(c.path)?(d=$k.get(c.easing)(d),a=ll.get(c.path)(b,a,d,
c.j)):(console.error("Invalid path passed"),a=new I(0,0,0)):(console.error("Invalid easing passed"),a=new I(0,0,0));this.Eb(a);a=this.bounce;b=this.H;0===a?a=0:Wk.has(a)?(b=ql(b.i),a=Wk.get(a)(b)):(console.error("Invalid bounce type passed"),a=0);b=a;0!==b&&(a=this.U,this.Eb(a.x,a.y+b,a.z));a=this.H.i;S.Transport.seconds>a.startTime?(this.v.i(0),this.s.i(this.ka),a=ql(a)):(this.v.i(this.ka),this.s.i(0),a=ql(this.H.s));for(const e of[this.s,this.v])for(b=e.Ga?e.Ga.length:1,c=Math.floor(b/4),d=Math.floor(a*
b);Zf(e)!==(d+c)%b;)$f(e,Zf(e))}}fadeIn(){Xe(this.W,new qg(1E3,0,1,a=>{this.ka=a}))}fadeOut(){Xe(this.W,new qg(800,1,0,a=>{this.s.i(a)}))}};
const Cl=[[[9,1592,275,120,120],[9,1715,275,120,120],[9,0,342,120,120],[9,123,342,120,120],[9,246,342,120,120],[9,369,342,120,120],[9,492,342,120,120],[9,615,342,120,120],[9,738,342,120,120],[9,1838,369,120,120],[9,1961,369,120,120],[9,2084,369,120,120],[9,1346,398,120,120],[9,1469,398,120,120],[9,1592,398,120,120],[9,1715,398,120,120],[9,0,465,120,120],[9,123,465,120,120],[9,246,465,120,120],[9,369,465,120,120],[9,492,465,120,120],[9,615,465,120,120],[9,738,465,120,120],[9,1838,492,120,120],[9,1961,
492,120,120],[9,2084,492,120,120],[9,1346,521,120,120],[9,1469,521,120,120],[9,1592,521,120,120],[9,1715,521,120,120],[9,861,552,120,120],[9,984,552,120,120]],[[10,1592,275,120,120],[10,1715,275,120,120],[10,0,342,120,120],[10,123,342,120,120],[10,246,342,120,120],[10,369,342,120,120],[10,492,342,120,120],[10,615,342,120,120],[10,738,342,120,120],[10,1838,369,120,120],[10,1961,369,120,120],[10,2084,369,120,120],[10,1346,398,120,120],[10,1469,398,120,120],[10,1592,398,120,120],[10,1715,398,120,120],
[10,0,465,120,120],[10,123,465,120,120],[10,246,465,120,120],[10,369,465,120,120],[10,492,465,120,120],[10,615,465,120,120],[10,738,465,120,120],[10,1838,492,120,120],[10,1961,492,120,120],[10,2084,492,120,120],[10,1346,521,120,120],[10,1469,521,120,120],[10,1592,521,120,120],[10,1715,521,120,120],[10,861,552,120,120],[10,984,552,120,120]],[[11,1592,275,120,120],[11,1715,275,120,120],[11,0,342,120,120],[11,123,342,120,120],[11,246,342,120,120],[11,369,342,120,120],[11,492,342,120,120],[11,615,342,
120,120],[11,738,342,120,120],[11,1838,369,120,120],[11,1961,369,120,120],[11,2084,369,120,120],[11,1346,398,120,120],[11,1469,398,120,120],[11,1592,398,120,120],[11,1715,398,120,120],[11,0,465,120,120],[11,123,465,120,120],[11,246,465,120,120],[11,369,465,120,120],[11,492,465,120,120],[11,615,465,120,120],[11,738,465,120,120],[11,1838,492,120,120],[11,1961,492,120,120],[11,2084,492,120,120],[11,1346,521,120,120],[11,1469,521,120,120],[11,1592,521,120,120],[11,1715,521,120,120],[11,861,552,120,120],
[11,984,552,120,120]],[[12,1592,275,120,120],[12,1715,275,120,120],[12,0,342,120,120],[12,123,342,120,120],[12,246,342,120,120],[12,369,342,120,120],[12,492,342,120,120],[12,615,342,120,120],[12,738,342,120,120],[12,1838,369,120,120],[12,1961,369,120,120],[12,2084,369,120,120],[12,1346,398,120,120],[12,1469,398,120,120],[12,1592,398,120,120],[12,1715,398,120,120],[12,0,465,120,120],[12,123,465,120,120],[12,246,465,120,120],[12,369,465,120,120],[12,492,465,120,120],[12,615,465,120,120],[12,738,465,
120,120],[12,1838,492,120,120],[12,1961,492,120,120],[12,2084,492,120,120],[12,1346,521,120,120],[12,1469,521,120,120],[12,1592,521,120,120],[12,1715,521,120,120],[12,861,552,120,120],[12,984,552,120,120]]],Dl=[[[9,1926,0,120,120],[9,2049,0,120,120],[9,1346,29,120,120],[9,1469,29,120,120],[9,1592,29,120,120],[9,1715,29,120,120],[9,0,96,120,120],[9,123,96,120,120],[9,246,96,120,120],[9,369,96,120,120],[9,492,96,120,120],[9,615,96,120,120],[9,738,96,120,120],[9,1838,123,120,120],[9,1961,123,120,120],
[9,2084,123,120,120],[9,1346,152,120,120],[9,1469,152,120,120],[9,1592,152,120,120],[9,1715,152,120,120],[9,0,219,120,120],[9,123,219,120,120],[9,246,219,120,120],[9,369,219,120,120],[9,492,219,120,120],[9,615,219,120,120],[9,738,219,120,120],[9,1838,246,120,120],[9,1961,246,120,120],[9,2084,246,120,120],[9,1346,275,120,120],[9,1469,275,120,120]],[[10,1926,0,120,120],[10,2049,0,120,120],[10,1346,29,120,120],[10,1469,29,120,120],[10,1592,29,120,120],[10,1715,29,120,120],[10,0,96,120,120],[10,123,96,
120,120],[10,246,96,120,120],[10,369,96,120,120],[10,492,96,120,120],[10,615,96,120,120],[10,738,96,120,120],[10,1838,123,120,120],[10,1961,123,120,120],[10,2084,123,120,120],[10,1346,152,120,120],[10,1469,152,120,120],[10,1592,152,120,120],[10,1715,152,120,120],[10,0,219,120,120],[10,123,219,120,120],[10,246,219,120,120],[10,369,219,120,120],[10,492,219,120,120],[10,615,219,120,120],[10,738,219,120,120],[10,1838,246,120,120],[10,1961,246,120,120],[10,2084,246,120,120],[10,1346,275,120,120],[10,1469,
275,120,120]],[[11,1926,0,120,120],[11,2049,0,120,120],[11,1346,29,120,120],[11,1469,29,120,120],[11,1592,29,120,120],[11,1715,29,120,120],[11,0,96,120,120],[11,123,96,120,120],[11,246,96,120,120],[11,369,96,120,120],[11,492,96,120,120],[11,615,96,120,120],[11,738,96,120,120],[11,1838,123,120,120],[11,1961,123,120,120],[11,2084,123,120,120],[11,1346,152,120,120],[11,1469,152,120,120],[11,1592,152,120,120],[11,1715,152,120,120],[11,0,219,120,120],[11,123,219,120,120],[11,246,219,120,120],[11,369,219,
120,120],[11,492,219,120,120],[11,615,219,120,120],[11,738,219,120,120],[11,1838,246,120,120],[11,1961,246,120,120],[11,2084,246,120,120],[11,1346,275,120,120],[11,1469,275,120,120]],[[12,1926,0,120,120],[12,2049,0,120,120],[12,1346,29,120,120],[12,1469,29,120,120],[12,1592,29,120,120],[12,1715,29,120,120],[12,0,96,120,120],[12,123,96,120,120],[12,246,96,120,120],[12,369,96,120,120],[12,492,96,120,120],[12,615,96,120,120],[12,738,96,120,120],[12,1838,123,120,120],[12,1961,123,120,120],[12,2084,123,
120,120],[12,1346,152,120,120],[12,1469,152,120,120],[12,1592,152,120,120],[12,1715,152,120,120],[12,0,219,120,120],[12,123,219,120,120],[12,246,219,120,120],[12,369,219,120,120],[12,492,219,120,120],[12,615,219,120,120],[12,738,219,120,120],[12,1838,246,120,120],[12,1961,246,120,120],[12,2084,246,120,120],[12,1346,275,120,120],[12,1469,275,120,120]]];function Hl(a){y(a.T,["click"],()=>{mk();a.H();zl(a.v);Al(a.v,a.N.N)});y(a.oa,["click"],()=>{mk();a.H();zl(a.v);a.v.start(!1)});y(a.ka,["click"],()=>{mk();Il(a);a.N.resume()})}function Jl(a){Xe(a.W,new qg(500,0,1,b=>{Kl(a,b)},{Xb:og}))}function Il(a){Xe(a.W,new qg(200,1,0,b=>{Kl(a,b)},{Xb:mg}));Xe(a.W,new Ve(0,null,()=>{a.H()}))}
function Kl(a,b){a.va.style.opacity=b.toString();a.wa.style.transform=`translate(${-100*(1-b)}%, 0px) rotate(${-20*(1-b)}deg)`;a.Ba.style.transform=`translate(${100*(1-b-.5)}%, -50%)`}
var Ll=class extends rk{constructor(a,b,c){super(c,Hk(Pk));this.v=a;this.N=b;this.ha=c;this.ka=T("resumeButton");this.T=T("retryLevelButton");this.oa=T("startOverButton");this.va=T("ddl-photoBg_");this.wa=T("ddl-poster_");this.Ba=T("ddl-rightSide_");Y(T("ddl-pausedLabel_"),"Paused");Y(this.ka,"Resume");Y(this.T,"Retry");Y(this.oa,"New Game");qk();Hl(this);Y(T("ddl-posterText_"),"Fact"+(this.N.N+5).toString());Jl(this)}};const Ml=Rf.$();function wl(a){return a.H/(a.H+a.N)}function Nl(a){a.s=0;a.multiplier=1;a.N+=1;Pf(Ml,10)}function Ol(a,b,c,d){a.H+=1;a.o+=10*(Math.pow(a.multiplier,c)+c);a.s+=1;a.multiplier=Math.min(4,Math.floor((a.s+4)/4));Pf(Ml,d,b);4===a.multiplier&&Pf(Ml,9)}
var Pl=class extends M{constructor(a){super();this.ha=a;this.i=void 0;this.H=this.N=this.s=this.o=0;this.multiplier=1;this.v=[];Ml.addListener(this)}ac(a,b){if(this.i){var c=S.Transport.seconds;switch(a){case 1:a=[];for(var d=0;d<this.i.o.length;d++){var e=El(this.i,d).o;const f=Fl(El(this.i,d)),h=Math.abs(c-e.time),k=Math.abs(c-f.time);b!==e.value.Ha||e.value.Fa||.21>h&&a.push(e);b!==f.value.Ha||f.value.Fa||.21>k&&a.push(f)}if(0<a.length)for(d=0;d<a.length;d++)e=a[d],e.value.Fa=!0,0===d&&(e=Math.abs(c-
e.time),.07>=e?Ol(this,b,3,4):.14>=e?Ol(this,b,2,5):.21>=e&&Ol(this,b,1,6));else Pf(Ml,8,b),Nl(this);break;case 2:c=S.Transport.seconds,b.Fa||this.v.push({Wb:b,time:c})}}}g(){var a=S.Transport.seconds;for(var b=this.v.length-1;0<=b;b--){const c=this.v[b];c.Wb.Fa?this.v.splice(b,1):.21<a-c.time&&(Pf(Ml,7,c.Wb.Ha),Nl(this),c.Wb.Fa=!0)}a=document.getElementById("gameplayScore");a.textContent=`${this.o}`;b=Math.min(this.s/15,1);a.style.textShadow=`0px 0px ${p(3,7,b)}px rgba(255, 255, 255, ${b}),
         0px 0px ${p(7,14,b)}px rgba(255, 195, 143, ${b}),
         0px 0px 30px rgba(238, 238, 0, ${.5*b})`;a.style.color=`rgb(255, ${p(195,255,b)}, ${p(143,255,b)})`}};const Ql=Rf.$();function Rl(a){const b=self.performance.now();270>b-a.W||(a.W=b,Pf(Ql,1,a.id))}function Sl(a){var b=A.nc;Cd(b);b.i&&b.i.gain.setValueAtTime(.5,b.g.currentTime);Dd(A.nc);a.oa=S.Transport.seconds;a.ka=!0;a.v.u=!1;a.N.u=!0}function Tl(a){a.H||(a.wa=S.Transport.seconds,a.H=!0,a.v.u=!1,a.s.u=!0)}
var Xl=class extends Bf{constructor(a,b){super(a);this.id=b;this.Ba=new lf(this);this.T=new Ul;this.oa=this.wa=this.W=0;this.ka=this.H=!1;this.v=F()?new bg(Ji):new bg(ck.get(this.id));this.s=F()?new bg(Ki):new bg(dk.get(this.id));this.s.u=!1;this.N=F()?new bg(Li):new bg(ek.get(this.id));this.N.u=!1;L(this.v,1.3);L(this.s,1.3);L(this.N,1.3);Xf(this.v,0,0);Xf(this.s,0,0);Xf(this.N,0,0);this.ta=1;this.T.u=!1;K(this.v,this);K(this.s,this);K(this.N,this);K(this.T,this);K(this.Ba,this);this.setSize(2,2);
document.addEventListener("keypress",c=>{c.keyCode===Zj.get(this.id)&&Rl(this)});this.va=x(document,"keydown",c=>{c.keyCode===Zj.get(this.id)&&Rl(this)});Ql.addListener(this)}g(){if(this.H||this.ka){var a=1E3*(S.Transport.seconds-(this.H?this.wa:this.oa));const b=this.H?270:400;a>b?(this.ka=this.H=!1,this.s.u=!1,this.N.u=!1,this.v.u=!0):this.H&&(a/=b,Xf(this.s,.5*Math.sin(2*Math.PI*a)*(.5>a?a:1-a),0))}a=self.performance.now();270>a-this.W&&!this.H&&(a=(a-this.W)/270,a=1.3+.3*(.3>a?ng(a/.3):1-mg((a-
.3)/.7)),L(this.v,a),L(this.s,a),L(this.N,a))}ac(a,b){if(b===this.id)switch(a){case 3:a=new Vl;K(a,this);break;case 6:Wl(this.T);Sl(this);break;case 5:Wl(this.T);Sl(this);break;case 4:Wl(this.T);Sl(this);break;case 8:a=A.bc;Cd(a);a.i&&a.i.gain.setValueAtTime(.6,a.g.currentTime);Dd(A.bc);Tl(this);break;case 7:Tl(this)}}};
class Vl extends M{constructor(){super();this.i=new Cf;this.progress=0;this.i.i(0);this.i.s="#fff5e6";this.o=S.Transport.seconds;K(this.i,this);this.ta=2;this.g(0)}g(a){this.progress=1E3*(S.Transport.seconds-this.o)/700;const b=mg(this.progress);L(this.i,1.5*(1-b)+1.3);this.i.H=.15*this.progress;this.i.i(Math.min(1,.7+this.progress));1<this.progress&&(K(this.i,null),K(this,null));super.g(a)}}function Wl(a){Yf(a.i,!0);$f(a.i,0);a.u=!0}
class Ul extends M{constructor(){var a=new bg(Vj);super();this.i=a;Yf(this.i,!0);this.i.ka=1E3/30;this.i.setLoop(!1);L(this.i,1.3);this.ta=1;Xf(this.i,0,0);K(this.i,this)}g(){var a=this.i;this.i.s+2>=(a.Ga?a.Ga.length:1)&&(this.u=!1)}};const Yl=Rf.$();function Zl(a){for(const [b,c]of a.Ka){if([0,7,8].includes(b))continue;const d=new Xl(c,b);K(d,a);a.wa.set(b,d);const e=document.createElement("div");e.classList.add("ddl-target_");e.style.left=`${480+55*c.x}px`;e.style.top=`${270-55*c.y}px`;a.s.appendChild(e);F()?x(e,"touchstart",f=>{Rl(d);f.preventDefault()}):x(e,"mousedown",()=>{Rl(d)})}}
function $l(a){return m(a,function*(){var b=wl(this.v);b=3===this.N||2===this.N&&b<this.T.Ra?new Bl(this.ka,this,this.ha,!1):2===this.N&&b>this.T.Ra?new Bl(this.ka,this,this.ha,!0,!0):new Bl(this.ka,this,this.ha);K(b,this)})}
var am=class extends rk{constructor(a,b,c,d,e,f,h){super(c,Hk(Jk));this.ka=a;this.oa=b;this.ha=c;this.T=d;this.Xa=e;this.N=f;this.wa=new Map;this.v=new Pl(this.ha);this.notes=[];this.Ja=!1;this.Ka=1===this.Xa?Yj:Xj;this.Ba=new rl(h,b);K(this.Ba,this);K(this.v,this);K(b,this);for(a=0;a<this.T.Ta.length;a++)c=new Gl(Array.from(this.T.Ta[a]),a,this.Ka,this.N),c.H=b,K(c,this),this.notes.push(c);this.v.i=b;Zl(this);this.va=T("ddl-pauseButton_");x(this.va,["click"],()=>{"started"!==S.Transport.state||this.Ja?
this.resume():this.pause()})}start(){return m(this,function*(){this.oa.start();for(var a of this.notes)a.fadeIn();yield El(this.oa).Ca;this.Ja=!0;this.oa.fadeOut();for(var b of this.notes)b.fadeOut();Dd(A.Cc);a=this.Ba;b=wl(this.v)<this.T.Ua;a.wa=!0;a.qc=b;yield lk(3E3);return $l(this)})}H(){for(const b of this.wa.keys()){var a=this.wa.get(b);Ql.removeListener(a);a.va&&Xc(a.va)}Yl.removeListener(this.v);super.H()}resume(){S.Transport.start();this.va.style.pointerEvents="all"}pause(){S.Transport.pause();
const a=new Ll(this.ka,this,this.ha);K(a,this);this.va.style.pointerEvents="none"}};function bm(a){return new Promise(b=>{x(a.v,["click"],()=>{b(1)});x(a.N,["click"],()=>{b(2)})})}var cm=class extends rk{constructor(a){super(a,Hk(Lk));this.ha=a;this.v=T("ddl-onePlayerSelect_");this.N=T("ddl-twoPlayerSelect_");Y(T("onePlayerText"),"One Player");Y(T("twoPlayerText"),"Two Players")}};const dm=Rf.$();function ql(a){if(!a.i.length)return 1;const b=a.o.time;a=a.i[0].time-b;return 0===a?1:Math.min(Math.max((S.Transport.seconds-b)/a,0),1)}function Fl(a){a.i.length||console.error("No more signals.");return a.i[0]}
function em(a){return new S.Part((b,c)=>{a.v=S.Transport.seconds-b;const d=a.i.indexOf(c);a.o=a.i[d];Wj&&(console.debug("Tone.Transport.seconds: %f. Signal time: %f. Delta %f",S.Transport.seconds,b,a.v),console.debug("Progress at signal (expect 1): %f",ql(a)),0!==d&&console.warn("Received out of order signal."));a.i.shift();a.W.push(a.o);Pf(dm,a.eventId,c.value);if(void 0!==c.value&&a.T.has(c.value))for(const e of a.T.get(c.value))e(c,b);a.i.length?Wj&&console.debug("Progress after signal (expect 0):",
ql(a)):(a.s&&a.s(),a.H.stop())},a.i)}var fm=class extends M{constructor(a,b,c){super();this.N=b;this.eventId=c;this.W=[];this.s=null;this.T=new Map;this.v=0;Array.isArray(a)?this.i=a:this.i=this.parseMidi(a);this.startTime=this.i[0].time;this.o=this.i[0];this.H=em(this);this.Ca=new Promise(d=>{this.s=d})}parseMidi(a){const b=[];a.notes.forEach(c=>{const d={time:c.time};this.N.has(c.name)&&(d.value=this.N.get(c.name)(),b.push(d))});return b}start(a=0){this.H.start(a)}g(){}};const gm=['/**\n * @license\n * [The MIT License](http://opensource.org/licenses/MIT)\n *\n * Copyright \u00a9 2016 Yotam Mann\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE\n */\n\n!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}("undefined"!=typeof self?self:this,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=5)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),i=new WeakMap;e.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var a=function(){function t(t){var r=this;this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",i.set(this,480),t&&(i.set(this,t.header.ticksPerBeat),t.tracks.forEach((function(t){return t.forEach((function(t){t.meta&&("timeSignature"===t.type?r.timeSignatures.push({ticks:t.absoluteTime,timeSignature:[t.numerator,t.denominator]}):"setTempo"===t.type?r.tempos.push({bpm:6e7/t.microsecondsPerBeat,ticks:t.absoluteTime}):"keySignature"===t.type&&r.keySignatures.push({key:e.keySignatureKeys[t.key+7],scale:0===t.scale?"major":"minor",ticks:t.absoluteTime}))}))})),t.tracks[0].forEach((function(t){t.meta&&("trackName"===t.type?r.name=t.text:"text"!==t.type&&"cuePoint"!==t.type&&"marker"!==t.type&&"lyrics"!==t.type||r.meta.push({text:t.text,ticks:t.absoluteTime,type:t.type}))})),this.update())}return t.prototype.update=function(){var t=this,e=0,r=0;this.tempos.sort((function(t,e){return t.ticks-e.ticks})),this.tempos.forEach((function(n,i){var a=i>0?t.tempos[i-1].bpm:t.tempos[0].bpm,o=n.ticks/t.ppq-r,s=60/a*o;n.time=s+e,e=n.time,r+=o})),this.timeSignatures.sort((function(t,e){return t.ticks-e.ticks})),this.timeSignatures.forEach((function(e,r){var n=r>0?t.timeSignatures[r-1]:t.timeSignatures[0],i=(e.ticks-n.ticks)/t.ppq/n.timeSignature[0]/(n.timeSignature[1]/4);n.measures=n.measures||0,e.measures=i+n.measures}))},t.prototype.ticksToSeconds=function(t){var e=n.search(this.tempos,t);if(-1!==e){var r=this.tempos[e],i=r.time,a=(t-r.ticks)/this.ppq;return i+60/r.bpm*a}return.5*(t/this.ppq)},t.prototype.ticksToMeasures=function(t){var e=n.search(this.timeSignatures,t);if(-1!==e){var r=this.timeSignatures[e],i=(t-r.ticks)/this.ppq;return r.measures+i/(r.timeSignature[0]/r.timeSignature[1])/4}return t/this.ppq/4},Object.defineProperty(t.prototype,"ppq",{get:function(){return i.get(this)},enumerable:!0,configurable:!0}),t.prototype.secondsToTicks=function(t){var e=n.search(this.tempos,t,"time");if(-1!==e){var r=this.tempos[e],i=(t-r.time)/(60/r.bpm);return Math.round(r.ticks+i*this.ppq)}var a=t/.5;return Math.round(a*this.ppq)},t.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map((function(t){return{bpm:t.bpm,ticks:t.ticks}})),timeSignatures:this.timeSignatures}},t.prototype.fromJSON=function(t){this.name=t.name,this.tempos=t.tempos.map((function(t){return Object.assign({},t)})),this.timeSignatures=t.timeSignatures.map((function(t){return Object.assign({},t)})),this.keySignatures=t.keySignatures.map((function(t){return Object.assign({},t)})),this.meta=t.meta.map((function(t){return Object.assign({},t)})),i.set(this,t.ppq),this.update()},t.prototype.setTempo=function(t){this.tempos=[{bpm:t,ticks:0}],this.update()},t}();e.Header=a},function(t,e,r){e.parseMidi=r(6),e.writeMidi=r(7)},function(t,e,r){"use strict";function n(t,e,r){void 0===r&&(r="ticks");var n=0,i=t.length,a=i;if(i>0&&t[i-1][r]<=e)return i-1;for(;n<a;){var o=Math.floor(n+(a-n)/2),s=t[o],u=t[o+1];if(s[r]===e){for(var c=o;c<t.length;c++){t[c][r]===e&&(o=c)}return o}if(s[r]<e&&u[r]>e)return o;s[r]>e?a=o:s[r]<e&&(n=o+1)}return-1}Object.defineProperty(e,"__esModule",{value:!0}),e.search=n,e.insert=function(t,e,r){if(void 0===r&&(r="ticks"),t.length){var i=n(t,e[r],r);t.splice(i+1,0,e)}else t.push(e)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),i=r(4),a=r(10),o=r(11),s=r(12),u=r(14),c=new WeakMap,h=function(){function t(t,e){var r=this;if(this.name="",this.notes=[],this.controlChanges=a.createControlChanges(),this.pitchBends=[],c.set(this,e),t){var n=t.find((function(t){return"trackName"===t.type}));this.name=n?n.text:""}if(this.instrument=new s.Instrument(t,this),this.channel=0,t){for(var i=t.filter((function(t){return"noteOn"===t.type})),o=t.filter((function(t){return"noteOff"===t.type})),u=function(){var t=i.shift();h.channel=t.channel;var e=o.findIndex((function(e){return e.noteNumber===t.noteNumber&&e.absoluteTime>=t.absoluteTime}));if(-1!==e){var r=o.splice(e,1)[0];h.addNote({durationTicks:r.absoluteTime-t.absoluteTime,midi:t.noteNumber,noteOffVelocity:r.velocity/127,ticks:t.absoluteTime,velocity:t.velocity/127})}},h=this;i.length;)u();t.filter((function(t){return"controller"===t.type})).forEach((function(t){r.addCC({number:t.controllerType,ticks:t.absoluteTime,value:t.value/127})})),t.filter((function(t){return"pitchBend"===t.type})).forEach((function(t){r.addPitchBend({ticks:t.absoluteTime,value:t.value/Math.pow(2,13)})}))}}return t.prototype.addNote=function(t){var e=c.get(this),r=new u.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},e);return Object.assign(r,t),n.insert(this.notes,r,"ticks"),this},t.prototype.addCC=function(t){var e=c.get(this),r=new i.ControlChange({controllerType:t.number},e);return delete t.number,Object.assign(r,t),Array.isArray(this.controlChanges[r.number])||(this.controlChanges[r.number]=[]),n.insert(this.controlChanges[r.number],r,"ticks"),this},t.prototype.addPitchBend=function(t){var e=c.get(this),r=new o.PitchBend({},e);return Object.assign(r,t),n.insert(this.pitchBends,r,"ticks"),this},Object.defineProperty(t.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var t=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,e=0;e<this.notes.length-1;e++){var r=this.notes[e].time+this.notes[e].duration;t<r&&(t=r)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var t=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,e=0;e<this.notes.length-1;e++){var r=this.notes[e].ticks+this.notes[e].durationTicks;t<r&&(t=r)}return t},enumerable:!0,configurable:!0}),t.prototype.fromJSON=function(t){var e=this;for(var r in this.name=t.name,this.channel=t.channel,this.instrument=new s.Instrument(void 0,this),this.instrument.fromJSON(t.instrument),t.controlChanges)t.controlChanges[r]&&t.controlChanges[r].forEach((function(t){e.addCC({number:t.number,ticks:t.ticks,value:t.value})}));t.notes.forEach((function(t){e.addNote({durationTicks:t.durationTicks,midi:t.midi,ticks:t.ticks,velocity:t.velocity})}))},t.prototype.toJSON=function(){for(var t={},e=0;e<127;e++)this.controlChanges.hasOwnProperty(e)&&(t[e]=this.controlChanges[e].map((function(t){return t.toJSON()})));return{channel:this.channel,controlChanges:t,pitchBends:this.pitchBends.map((function(t){return t.toJSON()})),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map((function(t){return t.toJSON()}))}},t}();e.Track=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},e.controlChangeIds=Object.keys(e.controlChangeNames).reduce((function(t,r){return t[e.controlChangeNames[r]]=r,t}),{});var n=new WeakMap,i=new WeakMap,a=function(){function t(t,e){n.set(this,e),i.set(this,t.controllerType),this.ticks=t.absoluteTime,this.value=t.value}return Object.defineProperty(t.prototype,"number",{get:function(){return i.get(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return e.controlChangeNames[this.number]?e.controlChangeNames[this.number]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return n.get(this).ticksToSeconds(this.ticks)},set:function(t){var e=n.get(this);this.ticks=e.secondsToTicks(t)},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},t}();e.ControlChange=a},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,a){function o(t){try{u(n.next(t))}catch(t){a(t)}}function s(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,s)}u((n=n.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(1),o=r(8),s=r(0),u=r(3),c=function(){function t(t){var e=this,r=null;t&&(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(r=a.parseMidi(t)).tracks.forEach((function(t){var e=0;t.forEach((function(t){e+=t.deltaTime,t.absoluteTime=e}))})),r.tracks=function(t){for(var e=[],r=0;r<t.length;r++)for(var n=e.length,i=new Map,a=Array(16).fill(0),o=0,s=t[r];o<s.length;o++){var u=s[o],c=n,h=u.channel;if(void 0!==h){"programChange"===u.type&&(a[h]=u.programNumber);var f=a[h]+" "+h;i.has(f)?c=i.get(f):(c=n+i.size,i.set(f,c))}e[c]||e.push([]),e[c].push(u)}return e}(r.tracks)),this.header=new s.Header(r),this.tracks=[],t&&(this.tracks=r.tracks.map((function(t){return new u.Track(t,e.header)})),1===r.header.format&&0===this.tracks[0].duration&&this.tracks.shift())}return t.fromUrl=function(e){return n(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return[4,fetch(e)];case 1:return(r=n.sent()).ok?[4,r.arrayBuffer()]:[3,3];case 2:return[2,new t(n.sent())];case 3:throw new Error("could not load "+e)}}))}))},Object.defineProperty(t.prototype,"name",{get:function(){return this.header.name},set:function(t){this.header.name=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var t=this.tracks.map((function(t){return t.duration}));return Math.max.apply(Math,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationTicks",{get:function(){var t=this.tracks.map((function(t){return t.durationTicks}));return Math.max.apply(Math,t)},enumerable:!0,configurable:!0}),t.prototype.addTrack=function(){var t=new u.Track(void 0,this.header);return this.tracks.push(t),t},t.prototype.toArray=function(){return o.encode(this)},t.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map((function(t){return t.toJSON()}))}},t.prototype.fromJSON=function(t){var e=this;this.header=new s.Header,this.header.fromJSON(t.header),this.tracks=t.tracks.map((function(t){var r=new u.Track(void 0,e.header);return r.fromJSON(t),r}))},t.prototype.clone=function(){var e=new t;return e.fromJSON(this.toJSON()),e},t}();e.Midi=c;var h=r(3);e.Track=h.Track;var f=r(0);e.Header=f.Header},function(t,e){function r(t){for(var e,r=new n(t),i=[];!r.eof();){var a=o();i.push(a)}return i;function o(){var t={};t.deltaTime=r.readVarInt();var n=r.readUInt8();if(240==(240&n)){if(255!==n){if(240==n){t.type="sysEx";a=r.readVarInt();return t.data=r.readBytes(a),t}if(247==n){t.type="endSysEx";a=r.readVarInt();return t.data=r.readBytes(a),t}throw"Unrecognised MIDI event type byte: "+n}t.meta=!0;var i=r.readUInt8(),a=r.readVarInt();switch(i){case 0:if(t.type="sequenceNumber",2!==a)throw"Expected length for sequenceNumber event is 2, got "+a;return t.number=r.readUInt16(),t;case 1:return t.type="text",t.text=r.readString(a),t;case 2:return t.type="copyrightNotice",t.text=r.readString(a),t;case 3:return t.type="trackName",t.text=r.readString(a),t;case 4:return t.type="instrumentName",t.text=r.readString(a),t;case 5:return t.type="lyrics",t.text=r.readString(a),t;case 6:return t.type="marker",t.text=r.readString(a),t;case 7:return t.type="cuePoint",t.text=r.readString(a),t;case 32:if(t.type="channelPrefix",1!=a)throw"Expected length for channelPrefix event is 1, got "+a;return t.channel=r.readUInt8(),t;case 33:if(t.type="portPrefix",1!=a)throw"Expected length for portPrefix event is 1, got "+a;return t.port=r.readUInt8(),t;case 47:if(t.type="endOfTrack",0!=a)throw"Expected length for endOfTrack event is 0, got "+a;return t;case 81:if(t.type="setTempo",3!=a)throw"Expected length for setTempo event is 3, got "+a;return t.microsecondsPerBeat=r.readUInt24(),t;case 84:if(t.type="smpteOffset",5!=a)throw"Expected length for smpteOffset event is 5, got "+a;var o=r.readUInt8();return t.frameRate={0:24,32:25,64:29,96:30}[96&o],t.hour=31&o,t.min=r.readUInt8(),t.sec=r.readUInt8(),t.frame=r.readUInt8(),t.subFrame=r.readUInt8(),t;case 88:if(t.type="timeSignature",4!=a)throw"Expected length for timeSignature event is 4, got "+a;return t.numerator=r.readUInt8(),t.denominator=1<<r.readUInt8(),t.metronome=r.readUInt8(),t.thirtyseconds=r.readUInt8(),t;case 89:if(t.type="keySignature",2!=a)throw"Expected length for keySignature event is 2, got "+a;return t.key=r.readInt8(),t.scale=r.readUInt8(),t;case 127:return t.type="sequencerSpecific",t.data=r.readBytes(a),t;default:return t.type="unknownMeta",t.data=r.readBytes(a),t.metatypeByte=i,t}}else{var s;if(0==(128&n)){if(null===e)throw"Running status byte encountered before status byte";s=n,n=e,t.running=!0}else s=r.readUInt8(),e=n;var u=n>>4;switch(t.channel=15&n,u){case 8:return t.type="noteOff",t.noteNumber=s,t.velocity=r.readUInt8(),t;case 9:var c=r.readUInt8();return t.type=0===c?"noteOff":"noteOn",t.noteNumber=s,t.velocity=c,0===c&&(t.byte9=!0),t;case 10:return t.type="noteAftertouch",t.noteNumber=s,t.amount=r.readUInt8(),t;case 11:return t.type="controller",t.controllerType=s,t.value=r.readUInt8(),t;case 12:return t.type="programChange",t.programNumber=s,t;case 13:return t.type="channelAftertouch",t.amount=s,t;case 14:return t.type="pitchBend",t.value=s+(r.readUInt8()<<7)-8192,t;default:throw"Unrecognised MIDI event type: "+u}}}}function n(t){this.buffer=t,this.bufferLen=this.buffer.length,this.pos=0}n.prototype.eof=function(){return this.pos>=this.bufferLen},n.prototype.readUInt8=function(){var t=this.buffer[this.pos];return this.pos+=1,t},n.prototype.readInt8=function(){var t=this.readUInt8();return 128&t?t-256:t},n.prototype.readUInt16=function(){return(this.readUInt8()<<8)+this.readUInt8()},n.prototype.readInt16=function(){var t=this.readUInt16();return 32768&t?t-65536:t},n.prototype.readUInt24=function(){return(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},n.prototype.readInt24=function(){var t=this.readUInt24();return 8388608&t?t-16777216:t},n.prototype.readUInt32=function(){return(this.readUInt8()<<24)+(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},n.prototype.readBytes=function(t){var e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e},n.prototype.readString=function(t){var e=this.readBytes(t);return String.fromCharCode.apply(null,e)},n.prototype.readVarInt=function(){for(var t=0;!this.eof();){var e=this.readUInt8();if(!(128&e))return t+e;t+=127&e,t<<=7}return t},n.prototype.readChunk=function(){var t=this.readString(4),e=this.readUInt32();return{id:t,length:e,data:this.readBytes(e)}},t.exports=function(t){var e=new n(t),i=e.readChunk();if("MThd"!=i.id)throw"Bad MIDI file.  Expected \'MHdr\', got: \'"+i.id+"\'";for(var a=function(t){var e=new n(t),r=e.readUInt16(),i=e.readUInt16(),a={format:r,numTracks:i},o=e.readUInt16();32768&o?(a.framesPerSecond=256-(o>>8),a.ticksPerFrame=255&o):a.ticksPerBeat=o;return a}(i.data),o=[],s=0;!e.eof()&&s<a.numTracks;s++){var u=e.readChunk();if("MTrk"!=u.id)throw"Bad MIDI file.  Expected \'MTrk\', got: \'"+u.id+"\'";var c=r(u.data);o.push(c)}return{header:a,tracks:o}}},function(t,e){function r(t,e,r){var a,o=new i,s=e.length,u=null;for(a=0;a<s;a++)!1!==r.running&&(r.running||e[a].running)||(u=null),u=n(o,e[a],u,r.useByte9ForNoteOff);t.writeChunk("MTrk",o.buffer)}function n(t,e,r,n){var i=e.type,a=e.deltaTime,o=e.text||"",s=e.data||[],u=null;switch(t.writeVarInt(a),i){case"sequenceNumber":t.writeUInt8(255),t.writeUInt8(0),t.writeVarInt(2),t.writeUInt16(e.number);break;case"text":t.writeUInt8(255),t.writeUInt8(1),t.writeVarInt(o.length),t.writeString(o);break;case"copyrightNotice":t.writeUInt8(255),t.writeUInt8(2),t.writeVarInt(o.length),t.writeString(o);break;case"trackName":t.writeUInt8(255),t.writeUInt8(3),t.writeVarInt(o.length),t.writeString(o);break;case"instrumentName":t.writeUInt8(255),t.writeUInt8(4),t.writeVarInt(o.length),t.writeString(o);break;case"lyrics":t.writeUInt8(255),t.writeUInt8(5),t.writeVarInt(o.length),t.writeString(o);break;case"marker":t.writeUInt8(255),t.writeUInt8(6),t.writeVarInt(o.length),t.writeString(o);break;case"cuePoint":t.writeUInt8(255),t.writeUInt8(7),t.writeVarInt(o.length),t.writeString(o);break;case"channelPrefix":t.writeUInt8(255),t.writeUInt8(32),t.writeVarInt(1),t.writeUInt8(e.channel);break;case"portPrefix":t.writeUInt8(255),t.writeUInt8(33),t.writeVarInt(1),t.writeUInt8(e.port);break;case"endOfTrack":t.writeUInt8(255),t.writeUInt8(47),t.writeVarInt(0);break;case"setTempo":t.writeUInt8(255),t.writeUInt8(81),t.writeVarInt(3),t.writeUInt24(e.microsecondsPerBeat);break;case"smpteOffset":t.writeUInt8(255),t.writeUInt8(84),t.writeVarInt(5);var c=31&e.hour|{24:0,25:32,29:64,30:96}[e.frameRate];t.writeUInt8(c),t.writeUInt8(e.min),t.writeUInt8(e.sec),t.writeUInt8(e.frame),t.writeUInt8(e.subFrame);break;case"timeSignature":t.writeUInt8(255),t.writeUInt8(88),t.writeVarInt(4),t.writeUInt8(e.numerator);var h=255&Math.floor(Math.log(e.denominator)/Math.LN2);t.writeUInt8(h),t.writeUInt8(e.metronome),t.writeUInt8(e.thirtyseconds||8);break;case"keySignature":t.writeUInt8(255),t.writeUInt8(89),t.writeVarInt(2),t.writeInt8(e.key),t.writeUInt8(e.scale);break;case"sequencerSpecific":t.writeUInt8(255),t.writeUInt8(127),t.writeVarInt(s.length),t.writeBytes(s);break;case"unknownMeta":null!=e.metatypeByte&&(t.writeUInt8(255),t.writeUInt8(e.metatypeByte),t.writeVarInt(s.length),t.writeBytes(s));break;case"sysEx":t.writeUInt8(240),t.writeVarInt(s.length),t.writeBytes(s);break;case"endSysEx":t.writeUInt8(247),t.writeVarInt(s.length),t.writeBytes(s);break;case"noteOff":(u=(!1!==n&&e.byte9||n&&0==e.velocity?144:128)|e.channel)!==r&&t.writeUInt8(u),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteOn":(u=144|e.channel)!==r&&t.writeUInt8(u),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteAftertouch":(u=160|e.channel)!==r&&t.writeUInt8(u),t.writeUInt8(e.noteNumber),t.writeUInt8(e.amount);break;case"controller":(u=176|e.channel)!==r&&t.writeUInt8(u),t.writeUInt8(e.controllerType),t.writeUInt8(e.value);break;case"programChange":(u=192|e.channel)!==r&&t.writeUInt8(u),t.writeUInt8(e.programNumber);break;case"channelAftertouch":(u=208|e.channel)!==r&&t.writeUInt8(u),t.writeUInt8(e.amount);break;case"pitchBend":(u=224|e.channel)!==r&&t.writeUInt8(u);var f=8192+e.value,p=127&f,l=f>>7&127;t.writeUInt8(p),t.writeUInt8(l);break;default:throw"Unrecognized event type: "+i}return u}function i(){this.buffer=[]}i.prototype.writeUInt8=function(t){this.buffer.push(255&t)},i.prototype.writeInt8=i.prototype.writeUInt8,i.prototype.writeUInt16=function(t){var e=t>>8&255,r=255&t;this.writeUInt8(e),this.writeUInt8(r)},i.prototype.writeInt16=i.prototype.writeUInt16,i.prototype.writeUInt24=function(t){var e=t>>16&255,r=t>>8&255,n=255&t;this.writeUInt8(e),this.writeUInt8(r),this.writeUInt8(n)},i.prototype.writeInt24=i.prototype.writeUInt24,i.prototype.writeUInt32=function(t){var e=t>>24&255,r=t>>16&255,n=t>>8&255,i=255&t;this.writeUInt8(e),this.writeUInt8(r),this.writeUInt8(n),this.writeUInt8(i)},i.prototype.writeInt32=i.prototype.writeUInt32,i.prototype.writeBytes=function(t){this.buffer=this.buffer.concat(Array.prototype.slice.call(t,0))},i.prototype.writeString=function(t){var e,r=t.length,n=[];for(e=0;e<r;e++)n.push(t.codePointAt(e));this.writeBytes(n)},i.prototype.writeVarInt=function(t){if(t<0)throw"Cannot write negative variable-length integer";if(t<=127)this.writeUInt8(t);else{var e=t,r=[];for(r.push(127&e),e>>=7;e;){var n=127&e|128;r.push(n),e>>=7}this.writeBytes(r.reverse())}},i.prototype.writeChunk=function(t,e){this.writeString(t),this.writeUInt32(e.length),this.writeBytes(e)},t.exports=function(t,e){if("object"!=typeof t)throw"Invalid MIDI data";e=e||{};var n,a=t.header||{},o=t.tracks||[],s=o.length,u=new i;for(function(t,e,r){var n=null==e.format?1:e.format,a=128;e.timeDivision?a=e.timeDivision:e.ticksPerFrame&&e.framesPerSecond?a=-(255&e.framesPerSecond)<<8|255&e.ticksPerFrame:e.ticksPerBeat&&(a=32767&e.ticksPerBeat);var o=new i;o.writeUInt16(n),o.writeUInt16(r),o.writeUInt16(a),t.writeChunk("MThd",o.buffer)}(u,a,s),n=0;n<s;n++)r(u,o[n],e);return u.buffer}},function(t,e,r){"use strict";var n=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(1),o=r(0),s=i(r(9));function u(t){return s.default(t.notes.map((function(e){return function(t,e){return[{absoluteTime:t.ticks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOn",velocity:Math.floor(127*t.velocity)},{absoluteTime:t.ticks+t.durationTicks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOff",velocity:Math.floor(127*t.noteOffVelocity)}]}(e,t.channel)})))}function c(t,e){return{absoluteTime:t.ticks,channel:e,controllerType:t.number,deltaTime:0,type:"controller",value:t.value}}function h(t){return{absoluteTime:0,channel:t.channel,deltaTime:0,programNumber:t.instrument.number,type:"programChange"}}e.encode=function(t){var e={header:{format:1,numTracks:t.tracks.length+1,ticksPerBeat:t.header.ppq},tracks:n([n([{absoluteTime:0,deltaTime:0,meta:!0,text:t.header.name,type:"trackName"}],t.header.keySignatures.map((function(t){return function(t){var e=o.keySignatureKeys.indexOf(t.key);return{absoluteTime:t.ticks,deltaTime:0,key:e+7,meta:!0,scale:"major"===t.scale?0:1,type:"keySignature"}}(t)})),t.header.meta.map((function(t){return{absoluteTime:(e=t).ticks,deltaTime:0,meta:!0,text:e.text,type:e.type};var e})),t.header.tempos.map((function(t){return function(t){return{absoluteTime:t.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/t.bpm),type:"setTempo"}}(t)})),t.header.timeSignatures.map((function(t){return function(t){return{absoluteTime:t.ticks,deltaTime:0,denominator:t.timeSignature[1],meta:!0,metronome:24,numerator:t.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}(t)})))],t.tracks.map((function(t){return n([(e=t.name,{absoluteTime:0,deltaTime:0,meta:!0,text:e,type:"trackName"}),h(t)],u(t),function(t){for(var e=[],r=0;r<127;r++)t.controlChanges.hasOwnProperty(r)&&t.controlChanges[r].forEach((function(r){e.push(c(r,t.channel))}));return e}(t),function(t){var e=[];return t.pitchBends.forEach((function(r){e.push(function(t,e){return{absoluteTime:t.ticks,channel:e,deltaTime:0,type:"pitchBend",value:t.value}}(r,t.channel))})),e}(t));var e})))};return e.tracks=e.tracks.map((function(t){t=t.sort((function(t,e){return t.absoluteTime-e.absoluteTime}));var e=0;return t.forEach((function(t){t.deltaTime=t.absoluteTime-e,e=t.absoluteTime,delete t.absoluteTime})),t.push({deltaTime:0,meta:!0,type:"endOfTrack"}),t})),new Uint8Array(a.writeMidi(e))}},function(t,e,r){"use strict";function n(t){return function t(e,r){for(var n=0;n<e.length;n++){var i=e[n];Array.isArray(i)?t(i,r):r.push(i)}return r}(t,[])}function i(t,e){if("number"!=typeof e)throw new TypeError("Expected the depth to be a number");return function t(e,r,n){n--;for(var i=0;i<e.length;i++){var a=e[i];n>-1&&Array.isArray(a)?t(a,r,n):r.push(a)}return r}(t,[],e)}t.exports=function(t){if(!Array.isArray(t))throw new TypeError("Expected value to be an array");return n(t)},t.exports.from=n,t.exports.depth=function(t,e){if(!Array.isArray(t))throw new TypeError("Expected value to be an array");return i(t,e)},t.exports.fromDepth=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(4);e.createControlChanges=function(){return new Proxy({},{get:function(t,e){return t[e]?t[e]:n.controlChangeIds.hasOwnProperty(e)?t[n.controlChangeIds[e]]:void 0},set:function(t,e,r){return n.controlChangeIds.hasOwnProperty(e)?t[n.controlChangeIds[e]]=r:t[e]=r,!0}})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=new WeakMap,i=function(){function t(t,e){n.set(this,e),this.ticks=t.absoluteTime,this.value=t.value}return Object.defineProperty(t.prototype,"time",{get:function(){return n.get(this).ticksToSeconds(this.ticks)},set:function(t){var e=n.get(this);this.ticks=e.secondsToTicks(t)},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},t}();e.PitchBend=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(13),i=new WeakMap,a=function(){function t(t,e){if(this.number=0,i.set(this,e),this.number=0,t){var r=t.find((function(t){return"programChange"===t.type}));r&&(this.number=r.programNumber)}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.percussion?n.DrumKitByPatchID[this.number]:n.instrumentByPatchID[this.number]},set:function(t){var e=n.instrumentByPatchID.indexOf(t);-1!==e&&(this.number=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){return this.percussion?"drums":n.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"percussion",{get:function(){return 9===i.get(this).channel},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{family:this.family,name:this.name,number:this.number}},t.prototype.fromJSON=function(t){this.number=t.number},t}();e.Instrument=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],e.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],e.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}},function(t,e,r){"use strict";function n(t){return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][t%12]}Object.defineProperty(e,"__esModule",{value:!0});var i,a,o=(i=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,a={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},function(t){var e=i.exec(t),r=e[1],n=e[2];return a[r.toLowerCase()]+12*(parseInt(n,10)+1)}),s=new WeakMap,u=function(){function t(t,e,r){s.set(this,r),this.midi=t.midi,this.velocity=t.velocity,this.noteOffVelocity=e.velocity,this.ticks=t.ticks,this.durationTicks=e.ticks-t.ticks}return Object.defineProperty(t.prototype,"name",{get:function(){return t=this.midi,e=Math.floor(t/12)-1,n(t)+e.toString();var t,e},set:function(t){this.midi=o(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(t){var e=t-this.octave;this.midi+=12*e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return n(this.midi)},set:function(t){this.midi=12*(this.octave+1)+["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].indexOf(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var t=s.get(this);return t.ticksToSeconds(this.ticks+this.durationTicks)-t.ticksToSeconds(this.ticks)},set:function(t){var e=s.get(this).secondsToTicks(this.time+t);this.durationTicks=e-this.ticks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return s.get(this).ticksToSeconds(this.ticks)},set:function(t){var e=s.get(this);this.ticks=e.secondsToTicks(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bars",{get:function(){return s.get(this).ticksToMeasures(this.ticks)},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},t}();e.Note=u}])}));\n//# sourceMappingURL=Midi.js.map'];
gm.raw=[""];hk(ee(gm));var hm=l.Midi;function El(a,b=0){return a.o[b]}function im(a){const b=[];a.forEach(c=>{b.push({value:c.value.Ha,time:c.time-.7})});return b}
var km=class extends M{constructor(a,b){super();this.player=a;this.midi=b;this.o=[];this.H=[];this.gain=new S.Gain;Wj&&(console.debug("song loaded."),console.debug(this.midi.tracks));this.startTime=this.midi.tracks[0].notes.find(c=>"B1"===c.name).time;this.metronome=new fm(this.midi.tracks[0],bk,0);this.i=new fm(this.metronome.i.filter(c=>0===c.value),bk,0);this.s=new fm(this.metronome.i.filter(c=>2===c.value),bk,0);this.tracks=[this.metronome,this.i,this.s];for(a=1;a<this.midi.tracks.length;a++){b=
new fm(this.midi.tracks[a],jm,2);const c=new fm(im(b.i),ak,3);this.o.push(b);this.H.push(c);this.tracks.push(b);this.tracks.push(c)}Oe(this,this.tracks);this.gain.toDestination();this.player.connect(this.gain)}start(){S.Transport.start();for(const a of this.tracks)a.start();this.player.sync().start(this.startTime);return new Promise(a=>{S.Transport.scheduleOnce(()=>{a()},this.player.buffer.duration+1)})}pause(){S.Transport.pause()}fadeOut(){this.gain.gain.linearRampTo(.01,3)}static load(a){return m(this,
function*(){const b=new S.Player;var c=b.load(a.Va);const d=hm.fromUrl(a.midi);yield c;c=yield d;return new km(b,c)})}};const jm=new Map([["C2",()=>({Ha:0,Fa:!0})],["D2",()=>({Ha:3,Fa:!1})],["E2",()=>({Ha:2,Fa:!1})],["F2",()=>({Ha:1,Fa:!1})],["B2",()=>({Ha:4,Fa:!1})],["C3",()=>({Ha:5,Fa:!1})],["D3",()=>({Ha:6,Fa:!1})],["G2",()=>({Ha:7,Fa:!0})],["A2",()=>({Ha:8,Fa:!0})]]);const lm=Fh.$();
function mm(a){x(a.Ja,"click",()=>{nm(T("ddl-dancerOneSelect_"),()=>om(a))});x(a.v,["click","mouseenter","mouseleave"],b=>{"click"===b.type?nm(a.v,()=>om(a)):"mouseenter"===b.type?a.v.style.background=wf(R.$(),pm.get(a.La),a.v.clientHeight):"mouseleave"===b.type&&(a.v.style.background=wf(R.$(),qm.get(a.La),a.v.clientHeight))});x(a.Ka,"click",()=>{nm(T("ddl-dancerTwoSelect_"),()=>rm(a))});x(a.N,["click","mouseenter","mouseleave"],b=>{"click"===b.type?nm(a.N,()=>rm(a)):"mouseenter"===b.type?a.N.style.background=
wf(R.$(),pm.get(a.Ma),a.N.clientHeight):"mouseleave"===b.type&&(a.N.style.background=wf(R.$(),qm.get(a.Ma),a.N.clientHeight))})}function nm(a,b){a.classList.remove("ddl-dancerFadeIn_");a.classList.remove("ddl-dancerFadeOut_");a.classList.add("ddl-dancerFadeOut_");y(a,Cc,()=>{const c=b();a.classList.remove("ddl-dancerFadeOut_");a.classList.add("ddl-dancerFadeIn_");a.style.background=wf(R.$(),qm.get(c),a.clientHeight)})}function om(a){a.La=0===a.La?1:0;return a.La}
function rm(a){a.Ma=2===a.Ma?3:2;return a.Ma}function sm(a){return new Promise(b=>{y(a.Ba,"click",()=>{b({La:a.La,Ma:a.Ma})})})}
var tm=class extends rk{constructor(a,b){super(a,Hk(Mk));this.ha=a;this.T=b;this.La=0;this.Ma=2;F()?1===this.T?(this.ka=ii,this.oa=O(lm,"MobileTutorial2"),ok("tutorialAnimation",[ii,ji,ki,ji,ii,li,mi,li])):(this.va=Pi,this.ka=Ti,this.wa=O(lm,"MobileTutorial1"),this.oa=O(lm,"MobileTutorial2"),ok("tutorialAnimation",[Ti,Ui,Vi,Ui,Ti,Wi,Xi,Wi])):1===this.T?(this.ka=Zh,this.oa=O(lm,"DesktopTutorial2"),ok("tutorialAnimation",[Zh,$h,ai,$h,Zh,bi,ci,bi])):(this.va=Oi,this.ka=di,this.wa=O(lm,"DesktopTutorial1"),
this.oa=O(lm,"DesktopTutorial2"),ok("tutorialAnimation",[di,ei,fi,ei,di,gi,hi,gi]));this.Ba=T("ddl-skipTutorialButton_");this.Ja=T("ddl-dancerOneToggle_");this.Ka=T("ddl-dancerTwoToggle_");this.v=T("ddl-dancerOneSelect_");this.N=T("ddl-dancerTwoSelect_");a=T("ddl-diagramOne_");b=T("ddl-diagramTwo_");2===this.T?a.style.background=wf(R.$(),this.va,a.clientWidth):b.style.left="50%";b.style.background=wf(R.$(),this.ka,b.clientWidth);a=T("ddl-dancerOneSelect_");a.style.background=wf(R.$(),qm.get(this.La),
a.clientHeight);a=T("ddl-dancerTwoSelect_");a.style.background=wf(R.$(),qm.get(this.Ma),a.clientHeight);Y(T("ddl-tutorialHeader_"),"How to Play");a=T("ddl-diagramOneText_");b=T("ddl-diagramTwoText_");2===this.T?pk(a,this.wa):b.style.left="50%";pk(b,this.oa);Y(this.Ba,"Got It");mm(this)}};const qm=new Map([[0,[5,0,528,210,262]],[1,[5,236,264,210,262]],[2,[5,0,0,233,261]],[3,[5,472,0,233,261]]]),pm=new Map([[0,[5,213,529,210,262]],[1,[5,449,264,210,262]],[2,[5,236,0,233,261]],[3,[5,0,264,233,261]]]);const um=[0,8,2],vm=[1,4],wm=[5,F()?6:7],xm=[1],ym=[[9],[10],[11],[12]];function zl(a){a.H.H();var b=["level1","level2","level3","bonus"];for(const c of b)a.ha.classList.remove(c);b=a.N;b.player.unsync();b.player.stop();b.player.dispose();S.Transport.stop();for(const c of b.tracks)c.H.stop();K(b,null);a.H=void 0;a.N=void 0}
function Al(a,b){return m(a,function*(){fh(gk[b]);var c=(1===this.o?zm:Am)[b],d=["level1","level2","level3","bonus"];for(var e=0;e<d.length;e++){var f=d[e];e!==b?this.ha.classList.remove(f):this.ha.classList.add(f)}d=new ol(c.name,c.Sa,this.ha,b);yield Bm(this,d,xm,!1,!0);e=km.load(c);f=fk.get(this.s.La);const h=fk.get(this.s.Ma);yield this.load(um.concat([f.ub,f.Hb,f.nb,f.yb,f.Db,h.ub,h.Hb,h.nb,h.yb,h.Db]).concat(ym[b]));e=yield e;this.T.stop();c=new am(this,e,this.ha,c,3===b?2:this.o,b,this.s);
K(c,this);this.v=this.H=c;this.N=e;yield nl(d);d.H();this.Na.includes(d)&&K(d,null);yield c.start();N.d1=this.H.v.o;N.d2=wl(this.H.v);fh(gk[b]);delete N.d1;delete N.d2})}function Cm(a){return m(a,function*(){const b=new S.Player;b.fadeOut=3;const c=new S.Gain(.5);c.toDestination();b.connect(c);b.loop=!0;yield b.load("/logos/2021/doodles/savoy/intro_song.mp3");return b})}
function Bm(a,b,c,d=!0,e=!0){return m(a,function*(){d?this.i.s.classList.add("ddl-fade_"):this.i.s.classList.remove("ddl-fade_");this.i.i(1);K(b,this);b.s.style.opacity="0";const f=yield this.load(c);yield lk(Math.max(0,.5-f));this.v&&this.v.H();this.v=b;b.s.style.opacity="1";e?this.i.s.classList.add("ddl-fade_"):this.i.s.classList.remove("ddl-fade_");this.i.i(0)})}
var Dm=class extends M{constructor(a){super();this.ha=a;this.o=2;this.i=new Sk(this.ha);K(this.i,this)}load(a){return m(this,function*(){const b=Date.now();yield Promise.all(a.map(c=>sf(R.$(),c)));return Date.now()-b})}start(a=!0){return m(this,function*(){this.i.s.classList.remove("ddl-fade_");this.i.i(1);this.i.v.style.visibility="visible";a?(pk(this.i.text,O(Qk,"Intro")),Rk(this.i,!0)):(pk(this.i.text,O(Qk,"")),Rk(this.i,!1));this.T=yield Cm(this);this.T.start();var b=new cm(this.ha);this.v=b;
const c=yield this.load(vm);K(b,this);a&&(yield lk(Math.max(0,6E3-c)));this.i.s.classList.add("ddl-fade_");this.i.i(0);pk(this.i.text,O(Qk,""));Rk(this.i,!1);this.o=yield bm(b);N.d3=this.o;b=new tm(this.ha,this.o);yield Bm(this,b,wm);this.s=yield sm(b);N.d4=this.s.La;N.d5=this.s.Ma;yield Al(this,0)})}};
const Em={name:"SongBonus",Sa:"PostmodernJukebox",Va:"/logos/2021/doodles/savoy/careless_whisper.mp3",midi:"/logos/2021/doodles/savoy/careless_whisper.mid",Ta:[[{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:1,path:5,j:1},{easing:0,path:2,j:-9},{easing:0,path:2,j:9},{easing:0,path:2,j:-9},{easing:0,path:2,j:9},{easing:0,path:2,j:-9},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:2,path:0},{easing:0,path:0},{easing:0,path:2,j:-9},{easing:0,path:0},{easing:2,path:0},{easing:0,path:0},{easing:0,
path:2,j:5},{easing:0,path:2,j:-5},{easing:0,path:9},{easing:0,path:2},{easing:0,path:0},{easing:0,path:2,j:-8},{easing:0,path:2,j:8},{easing:0,path:2,j:-8},{easing:0,path:0},{easing:0,path:2},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-10},{easing:0,path:2,j:14},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:2,path:0},{easing:1,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-11},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:4,j:0},{easing:0,path:0},{easing:0,path:4,j:2},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-7},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:14},{easing:0,path:2,j:-14},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0}],[{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:1,path:5,j:1},{easing:0,path:2,j:9},{easing:0,path:2,j:-9},{easing:0,path:2,j:9},{easing:0,path:2,j:-9},{easing:0,path:2,j:9},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:2,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:2,path:0},{easing:0,path:0},{easing:0,path:2,j:5},{easing:0,path:2,j:-5},{easing:0,path:9},{easing:0,path:2},{easing:0,path:0},{easing:0,path:2,j:-8},{easing:0,path:2,j:8},{easing:0,path:2,j:-8},{easing:0,path:0},{easing:0,path:2},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-10},{easing:0,path:2,j:14},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:2,path:0},{easing:1,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:11},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:4,j:1},{easing:0,path:0},{easing:0,path:4,j:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:7},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-14},{easing:0,path:2,j:14},{easing:0,path:0},
{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},
{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},
{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},
{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0}],[{easing:0,path:0,
bounce:1},{easing:0,path:0},{easing:1,path:5,j:1},{easing:0,path:2,j:-9},{easing:0,path:2,j:9},{easing:0,path:2,j:-9},{easing:0,path:2,j:9},{easing:0,path:2,j:-9},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:2,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:2,path:0},{easing:0,path:0},{easing:0,path:2,j:5},{easing:0,path:2,j:-5},{easing:0,path:9},{easing:0,path:2},{easing:0,path:0},{easing:0,path:2,j:-8},{easing:0,path:2,j:8},{easing:0,path:2,j:-8},{easing:0,
path:0},{easing:0,path:2},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-10},{easing:0,path:2,j:14},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:2,path:0},{easing:1,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-11},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:4,j:2},{easing:0,path:0},{easing:0,
path:4,j:3},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-7},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:14},{easing:0,path:2,j:-14},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0}],[{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:1,path:5,j:1},{easing:0,path:2,j:9},{easing:0,path:2,j:-9},{easing:0,path:2,j:9},{easing:0,path:2,j:-9},{easing:0,path:2,j:9},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:2,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:2,path:0},{easing:0,path:0},{easing:0,
path:2,j:5},{easing:0,path:2,j:-5},{easing:0,path:9},{easing:0,path:2},{easing:0,path:0},{easing:0,path:2,j:-8},{easing:0,path:2,j:8},{easing:0,path:2,j:-8},{easing:0,path:0},{easing:0,path:2},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-10},{easing:0,path:2,j:14},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:2,path:0},{easing:1,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:11},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:4,j:3},{easing:0,path:0},{easing:0,path:4,j:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:7},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-14},{easing:0,path:2,j:14},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0}]],Ua:.5,Ra:.8},Am=[{name:"Song1",Sa:"Artist1",Va:"/logos/2021/doodles/savoy/call_the_whole_thing_off.mp3",midi:"/logos/2021/doodles/savoy/call_the_whole_thing_off.mid",Ta:[[{easing:0,path:0,bounce:1},
{easing:0,path:0},{easing:0,path:1,bounce:1},{easing:0,path:0},{easing:0,path:0},{easing:5,path:0,bounce:0},{easing:0,path:1,bounce:1,j:-8},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:4,path:8,bounce:0,j:3},{easing:0,path:0,bounce:1},{easing:0,path:5},{easing:0,path:2,j:-15},{easing:0,path:0},{easing:0,path:2,j:15},{easing:0,path:0},{easing:0,path:2,j:10},{easing:0,path:1,j:-4},{easing:0,path:2,j:-10},{easing:0,path:0},{easing:0,path:5},{easing:2,path:1,j:15},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:2,path:1,j:-10},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-9},{easing:0,path:0},{easing:0,path:2},{easing:0,path:0},{easing:0,path:2},{easing:0,path:0},{easing:0,path:2,j:-9},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:8},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0}]],Ua:.5,Ra:.8},{name:"Song2",Sa:"Artist2",Va:"/logos/2021/doodles/savoy/solid_as_a_rock.mp3",midi:"/logos/2021/doodles/savoy/solid_as_a_rock.mid",Ta:[[{easing:0,path:0,bounce:0},{easing:0,path:0},{easing:0,path:2,j:2},{easing:0,path:2,j:-3},{easing:0,path:2,j:4},{easing:0,path:0},{easing:4,path:1,j:9},{easing:0,path:0},{easing:0,path:2,j:-11},{easing:0,path:0,bounce:1},{easing:0,path:2,j:7},
{easing:0,path:0},{easing:0,path:2,j:-7},{easing:4,path:1,j:-14,bounce:0},{easing:3,path:0},{easing:0,path:2,j:-9,bounce:1},{easing:0,path:0},{easing:0,path:2,j:4},{easing:0,path:2,j:-4},{easing:0,path:1,j:4},{easing:0,path:1,j:-4},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:3,path:0},{easing:0,path:2,j:1E3},{easing:2,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:1E3},{easing:2,path:0},{easing:0,path:0},{easing:0,path:2,j:9},{easing:0,path:0},{easing:0,
path:2,j:-8},{easing:0,path:2,j:15},{easing:0,path:2,j:-8},{easing:0,path:1,j:-14},{easing:0,path:2,j:7},{easing:0,path:2,j:-7},{easing:0,path:2,j:7},{easing:0,path:0},{easing:0,path:5},{easing:0,path:5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:8},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-8},{easing:0,path:8},{easing:0,path:1,j:-8},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},
{easing:0,path:2,j:-10},{easing:0,path:2,j:10},{easing:0,path:1,j:-15},{easing:0,path:2,j:10},{easing:0,path:2,j:-10},{easing:0,path:5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:4},{easing:0,path:2,j:-6},{easing:0,path:2,j:7},{easing:3,path:5,bounce:0},{easing:0,path:0},{easing:0,path:2,j:6},{easing:0,path:2,j:-6},{easing:0,path:2,j:6},{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:4,path:1,bounce:0,j:-20},{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:1,path:5,j:1},{easing:1,
path:0},{easing:1,path:0},{easing:1,path:0},{easing:1,path:0},{easing:1,path:0},{easing:1,path:0},{easing:1,path:0},{easing:1,path:0},{easing:0,path:2},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:5},{easing:0,path:0}]],Ua:.5,Ra:.8},{name:"Song3",Sa:"Artist3",Va:"/logos/2021/doodles/savoy/bei_mir.mp3",midi:"/logos/2021/doodles/savoy/bei_mir.mid",Ta:[[{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2},{easing:0,path:0},{easing:0,path:0},{easing:0,path:9},
{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:3,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:1,path:1,j:5},{easing:6,path:0,bounce:0},{easing:6,path:0},{easing:0,path:8},{easing:0,
path:0,bounce:3},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:3},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:9,Nb:0},{easing:0,path:0,Nb:1},{easing:0,path:0},{easing:0,path:0},{easing:3,path:0},{easing:0,path:0},{easing:0,path:5,j:1.5},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-11,Nb:3},{easing:0,path:0,Nb:1},{easing:0,path:0},{easing:0,path:0},{easing:4,path:1,j:-8,bounce:0},{easing:4,path:3,j:1},{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-9},{easing:0,path:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},
{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1},{easing:0,path:0},{easing:0,path:5,j:1},{easing:0,path:2},{easing:0,path:0},{easing:0,path:2,j:-9},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-5},{easing:0,path:2},{easing:0,path:2,j:-12},{easing:0,path:2},{easing:0,path:0},
{easing:0,path:2,j:-12},{easing:0,path:1,j:-4},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:10},{easing:0,path:0},{easing:0,path:1,j:-4,bounce:0},{easing:0,path:1,j:4},{easing:0,path:0},{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2},{easing:0,path:2,j:-12},{easing:0,path:2,j:9},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-10},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-5},{easing:0,path:0},{easing:0,path:3,j:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-9},{easing:0,path:1,j:-9},{easing:0,path:0},{easing:0,path:0}],[{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-9},{easing:0,path:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},
{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-8},{easing:0,path:0},{easing:0,path:5,j:1},{easing:0,path:2,j:-9},{easing:0,path:0},{easing:0,path:2,j:9},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-5},{easing:0,path:2,j:-9},{easing:0,path:2,j:12},{easing:0,path:2,j:-9},{easing:0,path:0},{easing:0,path:2,j:12},{easing:0,
path:1,j:-4},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-10},{easing:0,path:0},{easing:0,path:1,j:4,bounce:0},{easing:0,path:1,j:-4},{easing:0,path:0},{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-9},{easing:0,path:2,j:12},{easing:0,path:2,j:-9},{easing:0,path:0},{easing:0,path:0},
{easing:0,path:0},{easing:0,path:1,j:5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:5},{easing:0,path:0},{easing:0,path:3,j:3},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:9},{easing:0,path:1,j:8},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0}]],Ua:.5,Ra:.8},Em],zm=[{name:"Song1",Sa:"Artist1",Va:"/logos/2021/doodles/savoy/call_the_whole_thing_off.mp3",midi:"/logos/2021/doodles/savoy/call_the_whole_thing_off_1p.mid",Ta:[[{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:1,path:1,j:4},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},
{easing:0,path:0},{easing:0,path:6,j:1},{easing:0,path:5,j:1},{easing:0,path:1},{easing:0,path:2,j:13},{easing:0,path:0},{easing:0,path:2,j:-13},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:7},{easing:0,path:6},{easing:0,path:8},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:5},{easing:0,path:2,j:-15},{easing:0,path:2,j:7},{easing:0,path:0},{easing:0,path:2,j:-7},{easing:0,path:2,j:9},{easing:0,path:0},{easing:0,path:2,j:-12},{easing:0,path:0},{easing:0,path:2,j:12},
{easing:0,path:0},{easing:0,path:3,j:0},{easing:0,path:0},{easing:0,path:2,j:-10},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:5},{easing:0,path:0},{easing:0,path:8},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0}]],Ua:.5,Ra:.8},{name:"Song2",Sa:"Artist2",Va:"/logos/2021/doodles/savoy/solid_as_a_rock.mp3",midi:"/logos/2021/doodles/savoy/solid_as_a_rock_1p.mid",
Ta:[[{easing:0,path:0,bounce:0},{easing:0,path:0},{easing:0,path:2,j:2},{easing:0,path:2,j:-3},{easing:0,path:2,j:4},{easing:0,path:0},{easing:4,path:1,j:9},{easing:0,path:0},{easing:0,path:3,j:2},{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:4,path:1,j:-6,bounce:0},{easing:0,path:3,j:0},{easing:0,path:1,j:-6},{easing:0,path:9,bounce:1},{easing:0,path:0},{easing:0,path:2,j:-15,bounce:0},{easing:0,path:2,j:2E4,bounce:1},{easing:0,path:0},{easing:0,path:0},
{easing:0,path:2,bounce:0},{easing:0,path:2,j:2E4,bounce:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-9},{easing:0,path:0},{easing:0,path:2,j:5},{easing:0,path:5,j:.8},{easing:0,path:5,j:1},{easing:0,path:0},{easing:5,path:0,bounce:0},{easing:4,path:1,j:-5},{easing:0,path:0,bounce:1},{easing:0,path:1,j:-8},{easing:0,path:0},{easing:0,path:6},{easing:0,path:2,j:-7},{easing:0,path:0},{easing:0,path:2},{easing:0,path:5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,
j:-12},{easing:0,path:2,j:11},{easing:0,path:0},{easing:0,path:2,j:-5},{easing:0,path:0},{easing:0,path:2,j:5},{easing:0,path:2,j:-14},{easing:0,path:2,j:4},{easing:0,path:0},{easing:3,path:5,bounce:0},{easing:0,path:0},{easing:0,path:2,j:6},{easing:0,path:2,j:-6},{easing:0,path:0},{easing:0,path:0,bounce:1},{easing:5,path:0},{easing:0,path:0},{easing:4,path:6,j:.5},{easing:0,path:2,j:9},{easing:0,path:0},{easing:0,path:2,j:-9},{easing:0,path:0},{easing:0,path:2,j:9},{easing:0,path:0},{easing:0,path:2,
j:-9},{easing:0,path:0},{easing:4,path:2,j:10},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0}]],Ua:.5,Ra:.8},{name:"Song3",Sa:"Artist3",Va:"/logos/2021/doodles/savoy/bei_mir.mp3",midi:"/logos/2021/doodles/savoy/bei_mir_1p.mid",Ta:[[{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:0,path:2,j:12},{easing:0,path:2,j:-5},{easing:0,path:5,j:1.5},{easing:0,path:2,bounce:0},{easing:0,path:1,j:-10},{easing:0,path:2,j:-3},{easing:0,path:1,j:-7},{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},
{easing:0,path:3,bounce:2},{easing:0,path:1,j:-12},{easing:0,path:3,j:2},{easing:0,path:1,j:-8},{easing:0,path:2},{easing:0,path:2},{easing:0,path:6,j:1},{easing:4,path:2,j:12},{easing:4,path:2,j:12},{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-7},{easing:0,path:2,j:-9},{easing:0,path:0},{easing:0,path:2,j:9},{easing:0,path:0},{easing:0,path:8},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:9},{easing:0,path:2},{easing:0,path:2,j:-12},{easing:0,path:2},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:10},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-10},{easing:0,path:1,j:10},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:-10},{easing:0,path:2,j:10},{easing:0,path:2,j:-10},{easing:0,path:1,j:-10},{easing:0,path:3,j:0},{easing:0,path:1,j:-12},{easing:0,path:3,j:2},{easing:0,path:0},{easing:0,path:2,j:7},{easing:0,path:2,j:-7},{easing:0,path:2,j:7},{easing:0,path:2,j:-7},{easing:0,path:5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-8},{easing:0,path:2,j:-9},{easing:0,path:2,j:10},{easing:0,path:2,j:-9,bounce:2},{easing:4,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:3},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},
{easing:0,path:2,j:-6},{easing:0,path:0},{easing:0,path:2,j:6},{easing:0,path:0},{easing:0,path:2,j:-6},{easing:0,path:0},{easing:0,path:2,j:6},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:9},{easing:0,path:0}],[{easing:0,path:0,bounce:1},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-10},{easing:0,path:1,j:10},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:10},{easing:0,path:2,j:-10},{easing:0,path:2,j:10},{easing:0,path:1,j:-10},{easing:0,path:3,j:2},{easing:0,path:1,j:-12},{easing:0,path:3,j:0},{easing:0,path:0},{easing:0,path:2,j:-7},{easing:0,path:2,j:7},{easing:0,path:2,j:-7},{easing:0,path:2,
j:7},{easing:0,path:5},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1},{easing:0,path:2,j:9},{easing:0,path:2,j:-10},{easing:0,path:2,j:9,bounce:2},{easing:4,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:3,j:3},{easing:0,
path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:2,j:6},{easing:0,path:0},{easing:0,path:2,j:-6},{easing:0,path:0},{easing:0,path:2,j:6},{easing:0,path:0},{easing:0,path:2,j:-6},{easing:0,path:0},{easing:0,path:2,j:-10},{easing:0,path:0},{easing:0,path:0},{easing:0,path:0},{easing:0,path:1,j:-9},{easing:0,path:0},{easing:0,path:0}]],Ua:.5,Ra:.8},Em];const Fm=Nh.$();class Gm extends zf{g(){return R.$()}}function Hm(a,b){a.ta?(a.ab=Im(a),Bh(a.ab).then(b),a.ha.addEventListener("click",()=>m(a,function*(){yield Bh(this.ab);this.resume()}))):mf()?(a.T=Jm(a),Hg(a.T,()=>{b()})):b()}
function Km(a){sh([document,a.ha,a.u,a.g]);Og(a.H,a.g,["mousedown","mouseout","touchstart"],b=>{a.V.handleEvent(b)},!0);Og(a.H,document,["mouseup","mousemove","touchend","touchmove","contextmenu"],b=>{a.V.handleEvent(b)},!0);Og(a.H,a.ha,"touchend",()=>{Ug(a.o);lh(a.Ca)})}function Im(a){return new Ch(a.U,()=>{rg(a.V)},()=>{a.pause()})}function Jm(a){const b=new Ig(a.ha,()=>{rg(a.V)});Ac(a,ra(zc,b));return b}
var Lm=class extends v{constructor(a,b){super();this.ha=a;this.W=b;this.g=document.createElement("canvas");this.Da=eg.$();this.v=new Vf;this.u=Hk(Ik);this.ha.appendChild(Dk());this.N=document.getElementById("playbtn");this.g.width=960;this.g.height=540;this.g.classList.add("ddl-fillParent_");this.Na=this.g.getContext("2d");this.Ca=new ph(()=>{this.pause()},()=>{this.resume()});Ac(this,ra(zc,this.Ca));this.V=new sg(this.g);this.H=new Lg(this);Ac(this,ra(zc,this.H));const c=!F()&&Rd()&&600>=window.innerHeight;
this.ta=pf()||c;this.o=$g.$();Wg(this.o,this.ha,this.H,d=>{rg(this.V,d)});Sg(this.o);this.U=Zg(this.g.width,this.g.height);this.U.appendChild(this.g);this.ta?this.u.classList.add("ddl-domRootLightboxed_"):(b.dataset.width="384",b.dataset.height="216",Yg(this.o,b),Yg(this.o,this.U));this.u.style.width="960px";this.u.style.height="540px";this.U.appendChild(this.u);this.ya=document.createElement("div");this.ya.classList.add("ddl-closeButton_");this.u.appendChild(this.ya);x(this.ya,"click",()=>{this.o.close()});
this.ta||a.appendChild(this.U);Sg(this.o);this.Aa=!1;Sd?x(this.W,"click",()=>{const d=new Nb("/");d.g.set("fpdoodle","1");d.g.set("doodle","174786811");ve&&d.g.set("hl",ve);we&&d.g.set("gl",we);pe(d.toString(),!1)}):y(this.W,"click",()=>{Hm(this,()=>{this.ha.title="";this.Aa=!0;this.i.start();this.g.classList.add("ddl-gameCanvas_");this.u.appendChild(this.g);fh(0);W("ddl-closeButton_",Gi,Hi);X("#levelEndMenu .ddl-photoBg_",Dj);X("#pauseMenu .ddl-photoBg_",Dj);V("ddl-levelBackground_",Ii);X(".ddl-photoBg_",
Ph);V("ddl-poster_",Ej);X(".level1 .ddl-poster_",Ej);X(".level2 .ddl-poster_",Fj);X(".level3 .ddl-poster_",Gj);X(".bonus .ddl-poster_",Hj);V("ddl-introDancers_",Sj);ok("dancerAnimation",[Qj,Rj,Sj]);W("retryLevelButton",Kj,Lj);W("nextLevelButton",Kj,Lj);W("startOverButton",Kj,Lj);V("ddl-ratings_",Cj);V("ddl-note1_",zj);V("ddl-note2_",Aj);V("ddl-note3_",Bj);W("searchButton",Mj,Nj);W("facebookButton",ni,oi);W("twitterButton",Tj,Uj);W("emailButton",xj,yj);W("nativeShareButton",Oj,Pj);V("ddl-copyLink_",
Yh);V("ddl-borderNE_",bj);V("ddl-borderN_",gj);V("ddl-borderNW_",cj);V("ddl-borderW_",aj);V("ddl-borderSW_",fj);V("ddl-borderS_",$i);V("ddl-borderSE_",ej);V("ddl-borderE_",dj);X(".level2 .ddl-borderNE_",jj);X(".level2 .ddl-borderN_",oj);X(".level2 .ddl-borderNW_",kj);X(".level2 .ddl-borderW_",ij);X(".level2 .ddl-borderSW_",nj);X(".level2 .ddl-borderS_",hj);X(".level2 .ddl-borderSE_",mj);X(".level2 .ddl-borderE_",lj);X(".level3 .ddl-borderNE_",rj);X(".level3 .ddl-borderN_",wj);X(".level3 .ddl-borderNW_",
sj);X(".level3 .ddl-borderW_",qj);X(".level3 .ddl-borderSW_",vj);X(".level3 .ddl-borderS_",pj);X(".level3 .ddl-borderSE_",uj);X(".level3 .ddl-borderE_",tj);X(".bonus .ddl-borderNE_",Sh);X(".bonus .ddl-borderN_",Xh);X(".bonus .ddl-borderNW_",Th);X(".bonus .ddl-borderW_",Rh);X(".bonus .ddl-borderSW_",Wh);X(".bonus .ddl-borderS_",Qh);X(".bonus .ddl-borderSE_",Vh);X(".bonus .ddl-borderE_",Uh);W("ddl-pauseButton_",Mi,Ni);W("resumeButton",Ij,Jj);W("ddl-skipTutorialButton_",Yi,Zi);W("ddl-dancerOneToggle_",
Ri,Si);W("ddl-dancerTwoToggle_",Ri,Si);V("ddl-tutorialBackground_",Qi);V("ddl-modeSelectBackground_",pi);W("ddl-modeSelectDoor_",qi,Bi);V("ddl-modeSelectLeftPlayerIcon_",ti);X(".ddl-modeSelectDoor_:hover .ddl-modeSelectLeftPlayerIcon_",ui);V("ddl-modeSelectRightPlayerIcon_",Ei);X(".ddl-modeSelectDoor_:hover .ddl-modeSelectRightPlayerIcon_",Fi);V("ddl-modeSelectDevice_",F()?Ci:ri);X(".ddl-modeSelectDoor_:hover .ddl-modeSelectDevice_",F()?Di:si);V("ddl-modeSelectDancer_",Sj);V("ddl-modeSelectNoteOne_",
wi);V("ddl-modeSelectNoteTwo_",xi);V("ddl-modeSelectNoteThree_",yi);V("ddl-modeSelectNoteFour_",zi);V("ddl-modeSelectSavoy_",Ai);V("ddl-modeSelectGlow_",vi);const d=new Dm(this.u);var e=eg.$().u;K(d,e);d.start(!0)})});K(this.v,this.Da.u);Sf(this.v,this.g);this.v.Eb(0,0,-10);this.i=new Ih(d=>{this.T&&this.T.u(d);var e=this.o;if(e.s||e.O||e.H){var f=!!document[Tg],h=window.innerWidth,k=window.innerHeight;0==window.scrollX&&0==window.scrollY||window.scrollTo(0,0);if(h!=e.W||k!=e.ta||f!=e.Aa||e.i){e.T=
h<k;var q=!1;for(var n=0;n<e.o.length;++n){var w=e.o[n],r=w.width||parseInt(w.dataset.width,10),E=w.height||parseInt(w.dataset.height,10);if(e.O){if(Qd())throw"";!nf()||!F()||Rd()||Nd()&&D()||0!=n||(q=r<E!=e.T);var U=q?Math.min(h/E,k/r):Math.min(h/r,k/E);const P=U*r,Q=U*E;let aa,Mg=e.U?`scale(${U}) `:"";q?(U=(h-Q)/2+Q,aa=(k-P)/2,Mg+="rotate(90deg)"):(U=(h-P)/2,aa=(k-Q)/2);r=e.U?r:P;E=e.U?E:Q;me(w,"TransformOrigin","0 0");me(w,"Transform",Mg);H(w,"position","absolute","width",r+"px","height",E+"px",
"left",U+"px","top",aa+"px")}else D()&&H(w,"height",k+"px")}Qg&&(n=document.documentElement,w=n.getBoundingClientRect(),w.width==h&&w.height==k||H(n,"width",`${h}px`,"height",`${k}px`));!e.H&&!B.includes("CriOS")&&0<h&&document.body.clientWidth!==h&&(document.body.clientWidth<document.body.scrollWidth&&H(document.body,"width",Math.min(document.body.scrollWidth,h)+"px"),document.body.clientWidth>h&&H(document.body,"width",h+"px"));H(e.g,"height","100%","width","100%");e.N(q);e.W=h;e.ta=k;e.Aa=f;e.i=
!1}}this.ya.style.display=document[Tg]?"block":"none";f=this.Da;e=this.Na;h=this.v;cg(f,d);dg(f,h);e.setTransform(1,0,0,1,0,0);e.clearRect(0,0,e.canvas.width,e.canvas.height);for(let P of f.g)d=P,f=e,d.o&&0!==d.Sb&&(f.globalAlpha=d.Sb,f.setTransform(d.o.g,d.o.i,d.o.o,d.o.u,d.o.O,d.o.s),f.globalCompositeOperation=d.Ec,d.Ca(f),f.globalCompositeOperation="source-over")});Km(this)}start(){this.N&&(this.N.style.opacity="1");(Qd()?"1"==C.g.get("scta"):document.getElementById("fkbx")||G())?(this.i.o(50),
vh(this.i)):(this.i.start(),this.N&&this.N.classList.add("ddl-animated_"))}resume(){if(!this.ab||this.ab.g.classList.contains(xh()))S.Destination.mute=!1,Fm.o&&Fm.o.gain.setValueAtTime(1,Fm.g.currentTime),Fm.s=!1;!this.Aa&&(Qd()?"1"==C.g.get("scta"):document.getElementById("fkbx")||G())?(vh(this.i),this.i.o(50),vh(this.i)):((document.getElementById("fkbx")||G())&&uh&&(Xc(uh),uh=null),this.i.start(),"paused"!==S.Transport.state||document.getElementById("pauseMenu")||S.Transport.start())}pause(){Fm.o&&
Fm.o.gain.setValueAtTime(0,Fm.g.currentTime);Fm.s=!0;S.Destination.mute=!0;S.Transport.pause();this.i.pause()}},Mm=null;
function Nm(){if(Mm)return Promise.resolve(Mm);const a=document.getElementById("hplogo");wd(Fm,a);const b=document.getElementById("hpcanvas");if(!a||!b)return console.error("Unable to render the Doodle. This is expected during unit tests but may be a cause for concern elsewhere."),Promise.resolve(void 0);wd(Nh.$(),a);Nh.$().V.push(()=>{S.start()});ch=Date.now();N.d="174786811";!dh&&of()&&(dh=!0,fh(10));const c=[rh(),Fh.$().load(ve,we,Oh,"/logos/2021/doodles/savoy/"),Kg(),Ad.kc.u()];return Promise.all(c).then(()=>
{Af=new Gm;const d=new Lm(a,b);Mm=d;d.start();return d}).catch(d=>{console.error("Failed to initialize Doodle. Error: ",d)})}((a,b)=>{window.google&&google.doodle&&(b&&sa("google.doodle.cpDestroy",b),sa("google.doodle.cpInit",function(){b&&b();a()}))})(Nm,function(){if(Mm){var a=R.$();for(const b of a.g)b.o=[];zc(Mm);Mm=null}});Nm();/*

 MIT License

 Copyright (c) 2014-2020 Yotam Mann

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in all
 copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.
*/
/*

 [The MIT License](http://opensource.org/licenses/MIT)

 Copyright ? 2016 Yotam Mann

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE
*/
}).call(this);
